[2021-06-09 07:17:20,955] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-09 07:17:24,597] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-09 07:17:25,569] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-09 07:17:25,569] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-09 07:17:25,569] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-09 07:17:25,569] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-09 07:17:25,569] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623223051.1483796
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20395.00390625, 'VmHWM': 1164.8203125, 'VmRSS': 1164.8203125}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6302
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2823
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0012
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1189
-------------------------------------------------end of load ogb****************** step Time(s): 0.0116
finish constructing ogbn-products
load ogb-products time total: 2.044614315032959
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0458
after inductive else step Time(s): 0.0001
after label step Time(s): 3.8151
after train_g.create_formats_() step Time(s): 1.8908
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-09 07:17:38,930] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-09 07:17:38,930] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-09 07:17:38,935] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-09 07:17:41,311] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-09 07:17:41,313] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-09 07:17:41,313] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-09 07:17:41,313] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-09 07:17:41,313] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-09 07:17:41,313] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f0996da8940>
[2021-06-09 07:17:41,313] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:17:41,314] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-09 07:17:41,314] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-09 07:17:41,315] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-09 07:17:41,316] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68603515625GB

Max Memory Allocated 1.2875103950500488  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.74072265625GB

Max Memory Allocated 1.2875103950500488  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3844871520996094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3844871520996094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4103126525878906  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4103126525878906  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6121 | Train Acc 0.0204 | Speed (samples/sec) nan | GPU 1444.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4103126525878906  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.639747142791748  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639747142791748  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.639747142791748  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.639747142791748  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.640507698059082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56689453125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56689453125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:17:45,470] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-09 07:17:45,470] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=68692.82904739417
-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

avg iteration(step) data from cpu to GPU time:18.55755338 ms
avg iteration GPU training time:21.21389701 ms
avg iteration (step) total cpu time:194.94605064 ms
Epoch Time(s): 5.6850
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.1210 | Train Acc 0.7165 | Speed (samples/sec) 147170.5087 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:17:49,601] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:17:49,601] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=70422.3667682358
-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56494140625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.59033203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.52001953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54345703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:17:52,359] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:17:52,360] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=68293.37022978743
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

avg iteration(step) data from cpu to GPU time:15.43238111 ms
avg iteration GPU training time:22.40299051 ms
avg iteration (step) total cpu time:201.41126893 ms
Epoch Time(s): 5.7422
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.7150 | Train Acc 0.8237 | Speed (samples/sec) 144779.2509 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:17:55,712] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:17:55,712] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=68389.36242579304
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

avg iteration(step) data from cpu to GPU time:17.65880723 ms
avg iteration GPU training time:22.11897607 ms
avg iteration (step) total cpu time:195.15707276 ms
Epoch Time(s): 5.2472
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.6144 | Train Acc 0.8458 | Speed (samples/sec) 156845.8117 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:00,109] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:00,109] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=68778.31233322978
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:02,008] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:02,009] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=67783.54557305839
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

avg iteration(step) data from cpu to GPU time:15.25282608 ms
avg iteration GPU training time:21.78421246 ms
avg iteration (step) total cpu time:177.58863622 ms
Epoch Time(s): 5.2693
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5672 | Train Acc 0.8550 | Speed (samples/sec) 166372.5575 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:06,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:06,107] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=68381.78420895316
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:07,849] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:07,849] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=68882.95933628712
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

avg iteration(step) data from cpu to GPU time:15.84907055 ms
avg iteration GPU training time:21.01832442 ms
avg iteration (step) total cpu time:162.58361123 ms
Epoch Time(s): 4.8602
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.5547 | Train Acc 0.8540 | Speed (samples/sec) 171807.0376 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:11,894] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:11,895] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=68860.78246710119
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09234931 ms
avg iteration GPU training time:22.04735444 ms
avg iteration (step) total cpu time:192.94717095 ms
Epoch Time(s): 5.2078
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.5462 | Train Acc 0.8563 | Speed (samples/sec) 173578.9490 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:15,456] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:15,456] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=68974.35086241056
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:18,082] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:18,082] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=68050.65141025801
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

avg iteration(step) data from cpu to GPU time:17.73415574 ms
avg iteration GPU training time:24.91070210 ms
avg iteration (step) total cpu time:182.28142912 ms
Epoch Time(s): 5.1087
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.5358 | Train Acc 0.8597 | Speed (samples/sec) 174316.6050 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

[2021-06-09 07:18:21,414] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:21,414] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=68269.60464620983
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6425318717956543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.87675355 ms
avg iteration GPU training time:20.51851359 ms
avg iteration (step) total cpu time:203.89229601 ms
Epoch Time(s): 5.3101
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.5122 | Train Acc 0.8651 | Speed (samples/sec) 176513.9296 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:25,757] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:25,757] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=68558.54587903654
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:27,600] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:27,600] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=68774.47956392867
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.11402772 ms
avg iteration GPU training time:21.32623135 ms
avg iteration (step) total cpu time:198.13578779 ms
Epoch Time(s): 5.3336
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.4964 | Train Acc 0.8671 | Speed (samples/sec) 178820.9806 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:31,978] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:31,978] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=68627.16901421946
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:33,808] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:33,809] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=68751.31136177872
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.48975719 ms
avg iteration GPU training time:21.55798132 ms
avg iteration (step) total cpu time:171.13577236 ms
Epoch Time(s): 4.9639
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.5058 | Train Acc 0.8634 | Speed (samples/sec) 180220.2416 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:37,812] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:37,812] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=68888.71213161065
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:14.88237372 ms
avg iteration GPU training time:20.82275183 ms
avg iteration (step) total cpu time:187.96946786 ms
Epoch Time(s): 5.1108
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.5050 | Train Acc 0.8690 | Speed (samples/sec) 181349.6657 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:41,242] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:41,242] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=69106.12736349944
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:43,951] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:43,952] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=69074.21248235104
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.71511277 ms
avg iteration GPU training time:22.13997667 ms
avg iteration (step) total cpu time:189.79933045 ms
Epoch Time(s): 5.2064
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.4926 | Train Acc 0.8684 | Speed (samples/sec) 180386.7986 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:47,410] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:47,410] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=69080.37798144564
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.63471144 ms
avg iteration GPU training time:20.73870832 ms
avg iteration (step) total cpu time:160.92874787 ms
Epoch Time(s): 4.9412
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.4690 | Train Acc 0.8716 | Speed (samples/sec) 181167.4173 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:51,351] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:51,351] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=69274.46183269308
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:53,123] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:53,123] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=69531.66884685468
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.63258752 ms
avg iteration GPU training time:20.17762618 ms
avg iteration (step) total cpu time:184.14995887 ms
Epoch Time(s): 5.1320
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.5045 | Train Acc 0.8644 | Speed (samples/sec) 182404.7295 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:57,256] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:57,256] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=69679.04103273577
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:18:59,309] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:18:59,310] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=69810.32408398126
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.09639272 ms
avg iteration GPU training time:20.95517939 ms
avg iteration (step) total cpu time:191.67644327 ms
Epoch Time(s): 5.1389
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.4845 | Train Acc 0.8685 | Speed (samples/sec) 181097.1320 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:03,637] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:03,637] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=69966.76092391324
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.53926997 ms
avg iteration GPU training time:21.45691039 ms
avg iteration (step) total cpu time:195.70805810 ms
Epoch Time(s): 5.2990
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.4944 | Train Acc 0.8695 | Speed (samples/sec) 181326.7191 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:06,994] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:06,995] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=69915.806963111
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:09,506] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:09,507] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=70065.76476396112
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.74615869 ms
avg iteration GPU training time:20.43931649 ms
avg iteration (step) total cpu time:170.88118466 ms
Epoch Time(s): 4.9824
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.4954 | Train Acc 0.8689 | Speed (samples/sec) 181669.8150 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:12,833] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:12,833] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=70177.92190507609
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.04504724 ms
avg iteration GPU training time:20.94152451 ms
avg iteration (step) total cpu time:191.41749902 ms
Epoch Time(s): 5.2174
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.4814 | Train Acc 0.8685 | Speed (samples/sec) 180975.9750 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:17,100] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:17,100] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=70194.86965244007
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:19,001] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:19,002] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=70012.7667680294
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.40781073 ms
avg iteration GPU training time:23.15473747 ms
avg iteration (step) total cpu time:171.68875174 ms
Epoch Time(s): 5.0245
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.4761 | Train Acc 0.8692 | Speed (samples/sec) 181169.5065 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:23,000] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:23,001] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=70081.55487672564
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:24,828] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:24,828] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=70196.55405568272
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.60312150 ms
avg iteration GPU training time:20.64363046 ms
avg iteration (step) total cpu time:170.58040879 ms
Epoch Time(s): 4.9880
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.4711 | Train Acc 0.8725 | Speed (samples/sec) 182122.1718 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:28,838] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:28,839] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=70236.21662827031
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.00526550 ms
avg iteration GPU training time:21.46246095 ms
avg iteration (step) total cpu time:189.80288506 ms
Epoch Time(s): 5.1429
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.4939 | Train Acc 0.8674 | Speed (samples/sec) 181351.9442 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:32,376] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:32,376] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=70248.47362813342
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:34,922] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:34,922] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=70303.2406977783
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.64492781 ms
avg iteration GPU training time:21.12291527 ms
avg iteration (step) total cpu time:167.55994883 ms
Epoch Time(s): 5.0835
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.5017 | Train Acc 0.8693 | Speed (samples/sec) 182000.2531 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:38,362] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:38,362] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=70301.71935323477
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.82274055 ms
avg iteration GPU training time:20.97857163 ms
avg iteration (step) total cpu time:166.36048664 ms
Epoch Time(s): 5.0365
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.4947 | Train Acc 0.8679 | Speed (samples/sec) 182749.3140 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:42,377] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:42,377] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=70338.32911182895
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:44,202] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:44,203] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=70406.73222510576
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.85660796 ms
avg iteration GPU training time:20.62449438 ms
avg iteration (step) total cpu time:189.82510133 ms
Epoch Time(s): 5.2092
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.4828 | Train Acc 0.8700 | Speed (samples/sec) 183151.1500 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:48,523] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:48,524] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=70314.34366738675
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:50,308] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:50,308] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=70299.37906320106
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.21517086 ms
avg iteration GPU training time:21.84338032 ms
avg iteration (step) total cpu time:166.74908725 ms
Epoch Time(s): 5.0256
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.4701 | Train Acc 0.8692 | Speed (samples/sec) 183562.4904 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:54,339] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:54,340] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=70369.38772662505
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.12653689 ms
avg iteration GPU training time:20.34166700 ms
avg iteration (step) total cpu time:165.72200168 ms
Epoch Time(s): 5.0083
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.4870 | Train Acc 0.8670 | Speed (samples/sec) 184375.7558 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:19:57,693] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:19:57,693] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=70459.81503280695
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:00,380] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:00,380] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=70499.53219242883
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.46923351 ms
avg iteration GPU training time:20.90525402 ms
avg iteration (step) total cpu time:186.58900261 ms
Epoch Time(s): 5.1994
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.4852 | Train Acc 0.8727 | Speed (samples/sec) 184622.2532 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:05,089] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:05,089] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=70349.92195320134
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.46558285 ms
avg iteration GPU training time:24.21543277 ms
avg iteration (step) total cpu time:269.44563606 ms
Epoch Time(s): 6.3345
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.4819 | Train Acc 0.8714 | Speed (samples/sec) 182691.3122 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:09,098] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:09,098] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=70137.00584850735
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:10,890] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:10,890] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=70216.06831695203
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.68019485 ms
avg iteration GPU training time:20.66790373 ms
avg iteration (step) total cpu time:187.28384105 ms
Epoch Time(s): 5.1067
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.4805 | Train Acc 0.8692 | Speed (samples/sec) 182536.4735 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:14,984] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:14,985] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=70265.81288478801
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:17,277] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:17,278] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=70304.06264993128
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.63646239 ms
avg iteration GPU training time:21.15150573 ms
avg iteration (step) total cpu time:212.88847923 ms
Epoch Time(s): 5.3106
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.4839 | Train Acc 0.8696 | Speed (samples/sec) 182110.4600 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:21,537] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:21,538] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=70319.2070897693
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.54918688 ms
avg iteration GPU training time:20.43817902 ms
avg iteration (step) total cpu time:190.48992070 ms
Epoch Time(s): 5.1976
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.4785 | Train Acc 0.8723 | Speed (samples/sec) 182009.9822 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:24,891] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:24,891] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=70346.33058379407
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:27,492] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:27,493] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=70357.97226032412
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.64823549 ms
avg iteration GPU training time:21.08909659 ms
avg iteration (step) total cpu time:185.71779945 ms
Epoch Time(s): 5.1392
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.4713 | Train Acc 0.8750 | Speed (samples/sec) 181640.8151 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:30,930] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:30,930] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=70384.04047932882
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.72324649 ms
avg iteration GPU training time:21.00713591 ms
avg iteration (step) total cpu time:208.69827271 ms
Epoch Time(s): 5.4114
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.4749 | Train Acc 0.8719 | Speed (samples/sec) 181376.0573 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:35,429] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:35,429] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=70420.2294712169
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:37,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:37,175] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=70216.90396864523
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.57505165 ms
avg iteration GPU training time:22.80865756 ms
avg iteration (step) total cpu time:161.59475933 ms
Epoch Time(s): 4.9273
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.4597 | Train Acc 0.8752 | Speed (samples/sec) 181038.7741 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:41,128] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:41,129] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=70236.26368891605
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:43,175] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:43,175] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=70276.15330317088
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44378177 ms
avg iteration GPU training time:21.19376859 ms
avg iteration (step) total cpu time:190.65690041 ms
Epoch Time(s): 5.2567
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.4790 | Train Acc 0.8668 | Speed (samples/sec) 181387.7128 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90087890625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:47,267] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:47,267] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=70262.59082281377
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.84971939 ms
avg iteration GPU training time:21.10174561 ms
avg iteration (step) total cpu time:195.18943266 ms
Epoch Time(s): 5.2740
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4757 | Train Acc 0.8731 | Speed (samples/sec) 181407.8001 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:50,980] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:50,981] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=70295.08683472869
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:53,734] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:53,734] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=70308.95921979929
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.90835779 ms
avg iteration GPU training time:21.24738919 ms
avg iteration (step) total cpu time:194.23731891 ms
Epoch Time(s): 5.3639
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.4840 | Train Acc 0.8700 | Speed (samples/sec) 180798.4878 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:20:57,062] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:20:57,063] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=70342.36036661954
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.94317367 ms
avg iteration GPU training time:20.77745438 ms
avg iteration (step) total cpu time:167.27642580 ms
Epoch Time(s): 4.8808
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4669 | Train Acc 0.8718 | Speed (samples/sec) 180717.5176 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:01,326] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:01,326] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=70346.65131493917
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:03,488] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:03,488] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=70319.155718672
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:18.08542252 ms
avg iteration GPU training time:21.73993891 ms
avg iteration (step) total cpu time:292.24547473 ms
Epoch Time(s): 6.3556
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.4785 | Train Acc 0.8680 | Speed (samples/sec) 179499.5523 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:08,577] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:08,577] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=70318.81425890834
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:10,539] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:10,539] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=70364.31945793472
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.93842923 ms
avg iteration GPU training time:20.85263408 ms
avg iteration (step) total cpu time:182.72735856 ms
Epoch Time(s): 5.4909
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4792 | Train Acc 0.8718 | Speed (samples/sec) 179734.6049 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:14,537] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:14,537] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=70358.9033087188
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.75599991 ms
avg iteration GPU training time:20.76182123 ms
avg iteration (step) total cpu time:173.17917130 ms
Epoch Time(s): 5.0560
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4742 | Train Acc 0.8724 | Speed (samples/sec) 180026.6135 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:17,985] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:17,985] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=70371.26979338449
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:20,743] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:20,743] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=70403.16319102333
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.85658169 ms
avg iteration GPU training time:20.92709195 ms
avg iteration (step) total cpu time:200.47939907 ms
Epoch Time(s): 5.2319
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4645 | Train Acc 0.8766 | Speed (samples/sec) 179369.2187 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:24,163] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:24,163] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=70327.6758361232
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.39014990 ms
avg iteration GPU training time:23.01450487 ms
avg iteration (step) total cpu time:171.04634372 ms
Epoch Time(s): 5.0087
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4713 | Train Acc 0.8718 | Speed (samples/sec) 179496.3068 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:28,165] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:28,166] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=70323.12355339555
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:29,975] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:29,975] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=70317.2813002348
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.90511712 ms
avg iteration GPU training time:21.23405370 ms
avg iteration (step) total cpu time:183.53902210 ms
Epoch Time(s): 5.1542
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4599 | Train Acc 0.8758 | Speed (samples/sec) 179525.8573 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:34,131] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:34,131] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=70332.15459147847
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:36,580] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:36,580] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=70354.71517024397
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12527136 ms
avg iteration GPU training time:21.23562466 ms
avg iteration (step) total cpu time:227.29414160 ms
Epoch Time(s): 5.5424
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4724 | Train Acc 0.8712 | Speed (samples/sec) 179040.0390 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:40,774] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:40,774] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=70368.47183690938
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.80902394 ms
avg iteration GPU training time:20.90685671 ms
avg iteration (step) total cpu time:180.44859713 ms
Epoch Time(s): 5.2069
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4626 | Train Acc 0.8722 | Speed (samples/sec) 179451.7668 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:44,237] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:44,237] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=70401.61534377655
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:46,903] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:46,904] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=70415.69657111981
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.70698201 ms
avg iteration GPU training time:21.18341255 ms
avg iteration (step) total cpu time:189.57664750 ms
Epoch Time(s): 5.2163
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4865 | Train Acc 0.8722 | Speed (samples/sec) 179775.0143 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:50,239] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:50,239] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=70450.1860829124
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:16.30313891 ms
avg iteration GPU training time:20.50691778 ms
avg iteration (step) total cpu time:214.19999816 ms
Epoch Time(s): 5.4417
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4766 | Train Acc 0.8729 | Speed (samples/sec) 179763.0380 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:55,507] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:55,507] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=70473.30561339113
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:21:57,379] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:21:57,379] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=70446.45197629333
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.43515639 ms
avg iteration GPU training time:22.31923190 ms
avg iteration (step) total cpu time:221.81250832 ms
Epoch Time(s): 5.9034
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4619 | Train Acc 0.8774 | Speed (samples/sec) 178568.9872 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:22:01,388] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:01,388] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=70440.32073326048
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:22:03,827] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:03,827] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=70470.43837540336
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:15.70241443 ms
avg iteration GPU training time:20.92958797 ms
avg iteration (step) total cpu time:226.86795755 ms
Epoch Time(s): 5.5486
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4780 | Train Acc 0.8703 | Speed (samples/sec) 178944.8678 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

[2021-06-09 07:22:07,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:07,884] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=70462.42229532122
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87353515625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89892578125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94580078125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.87158203125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6437549591064453  GigaBytes

avg iteration(step) data from cpu to GPU time:17.77109822 ms
avg iteration GPU training time:22.05835655 ms
avg iteration (step) total cpu time:220.24516626 ms
Epoch Time(s): 5.4357
Eval Acc 0.8782
Test Acc: 0.6988
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4768 | Train Acc 0.8746 | Speed (samples/sec) 178821.4168 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:22:44,918] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:44,918] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=70463.60704327867
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:22:47,381] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:47,381] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=70486.62673927973
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.86235931 ms
avg iteration GPU training time:20.94078549 ms
avg iteration (step) total cpu time:169.82691938 ms
Epoch Time(s): 4.9493
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.4796 | Train Acc 0.8735 | Speed (samples/sec) 178891.0811 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:22:50,760] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:50,761] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=70515.68556802659
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.23113598 ms
avg iteration GPU training time:21.63392570 ms
avg iteration (step) total cpu time:201.08053901 ms
Epoch Time(s): 5.3187
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4528 | Train Acc 0.8755 | Speed (samples/sec) 179053.7375 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:22:55,141] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:55,141] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=70492.89259997112
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:22:56,979] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:22:56,979] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=70504.4678596615
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.01822532 ms
avg iteration GPU training time:20.64153030 ms
avg iteration (step) total cpu time:169.74624720 ms
Epoch Time(s): 4.9934
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4592 | Train Acc 0.8759 | Speed (samples/sec) 179334.1529 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:01,041] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:01,041] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=70490.01923036933
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:02,920] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:02,920] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=70523.81632073698
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.14786902 ms
avg iteration GPU training time:21.04822679 ms
avg iteration (step) total cpu time:175.61951551 ms
Epoch Time(s): 5.1041
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4604 | Train Acc 0.8779 | Speed (samples/sec) 179578.9488 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:07,039] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:07,040] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=70523.99413410576
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.63585741 ms
avg iteration GPU training time:20.93711402 ms
avg iteration (step) total cpu time:201.93362236 ms
Epoch Time(s): 5.3305
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4767 | Train Acc 0.8697 | Speed (samples/sec) 179702.1228 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:10,748] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:10,748] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=70537.54635008522
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:13,331] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:13,331] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=70563.85346211749
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.73152299 ms
avg iteration GPU training time:20.73488287 ms
avg iteration (step) total cpu time:185.47756022 ms
Epoch Time(s): 5.1929
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.4851 | Train Acc 0.8693 | Speed (samples/sec) 179567.7795 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:16,692] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:16,692] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=70599.96964066036
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.79532224 ms
avg iteration GPU training time:20.24168448 ms
avg iteration (step) total cpu time:174.66137626 ms
Epoch Time(s): 5.0467
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.4595 | Train Acc 0.8775 | Speed (samples/sec) 179934.8578 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:20,785] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:20,786] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=70638.81979534907
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:22,694] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:22,694] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=70666.38183226562
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.81353344 ms
avg iteration GPU training time:21.14454686 ms
avg iteration (step) total cpu time:190.98628651 ms
Epoch Time(s): 5.2174
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4653 | Train Acc 0.8727 | Speed (samples/sec) 180039.9823 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:26,842] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:26,842] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=70665.54537956322
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:28,930] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:28,930] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=70699.9905631135
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.52797950 ms
avg iteration GPU training time:20.86977751 ms
avg iteration (step) total cpu time:194.42270019 ms
Epoch Time(s): 5.2626
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.4572 | Train Acc 0.8768 | Speed (samples/sec) 180191.5713 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:33,122] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:33,123] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=70700.65188330809
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.04695875 ms
avg iteration GPU training time:20.91780923 ms
avg iteration (step) total cpu time:186.80631031 ms
Epoch Time(s): 5.2003
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4540 | Train Acc 0.8780 | Speed (samples/sec) 180489.6214 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:36,546] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:36,547] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=70722.47936505667
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:39,334] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:39,335] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=70724.38383785494
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.58178043 ms
avg iteration GPU training time:21.72388632 ms
avg iteration (step) total cpu time:201.24238188 ms
Epoch Time(s): 5.3024
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.4966 | Train Acc 0.8683 | Speed (samples/sec) 180322.4861 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:42,741] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:42,742] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=70665.07179537466
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.51960156 ms
avg iteration GPU training time:21.25855134 ms
avg iteration (step) total cpu time:173.69645292 ms
Epoch Time(s): 5.0281
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.4681 | Train Acc 0.8766 | Speed (samples/sec) 180305.2987 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:46,844] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:46,844] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=70670.34108284496
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:48,850] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:48,850] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=70679.84490101493
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.17174990 ms
avg iteration GPU training time:21.09235798 ms
avg iteration (step) total cpu time:203.85098457 ms
Epoch Time(s): 5.4380
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.4554 | Train Acc 0.8800 | Speed (samples/sec) 180591.2619 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:53,057] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:53,057] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=70690.13517108846
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:55,356] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:55,356] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=70703.42121176259
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.48805549 ms
avg iteration GPU training time:21.20696761 ms
avg iteration (step) total cpu time:216.95936810 ms
Epoch Time(s): 5.4530
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.4691 | Train Acc 0.8758 | Speed (samples/sec) 180377.5073 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:23:59,622] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:23:59,622] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=70579.1657948344
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:14.93593866 ms
avg iteration GPU training time:23.21269243 ms
avg iteration (step) total cpu time:202.98275081 ms
Epoch Time(s): 5.3364
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.4709 | Train Acc 0.8740 | Speed (samples/sec) 180447.4874 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:03,302] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:03,302] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=70568.6438871277
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:06,873] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:06,874] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=70589.30038802145
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.04951564 ms
avg iteration GPU training time:21.03693962 ms
avg iteration (step) total cpu time:248.97670746 ms
Epoch Time(s): 6.2762
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.4597 | Train Acc 0.8779 | Speed (samples/sec) 180747.8211 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:10,533] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:10,533] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=70578.05041941672
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.70573651 ms
avg iteration GPU training time:21.09401876 ms
avg iteration (step) total cpu time:200.18215613 ms
Epoch Time(s): 5.6110
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.4629 | Train Acc 0.8740 | Speed (samples/sec) 180833.2782 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:14,974] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:14,974] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=70581.51320007857
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:16,961] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:16,962] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=70534.45930857834
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.93043206 ms
avg iteration GPU training time:22.75936300 ms
avg iteration (step) total cpu time:185.08945812 ms
Epoch Time(s): 5.1899
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.4842 | Train Acc 0.8709 | Speed (samples/sec) 180714.1549 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:20,950] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:20,951] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=70537.18509919824
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:22,993] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:22,994] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=70557.44322701298
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.49349230 ms
avg iteration GPU training time:21.11516190 ms
avg iteration (step) total cpu time:190.43595141 ms
Epoch Time(s): 5.2530
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.4732 | Train Acc 0.8703 | Speed (samples/sec) 180731.0955 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:27,512] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:27,513] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=70557.34331224082
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:14.84620510 ms
avg iteration GPU training time:21.02034343 ms
avg iteration (step) total cpu time:193.42684746 ms
Epoch Time(s): 5.5227
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.4805 | Train Acc 0.8714 | Speed (samples/sec) 180964.6840 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:31,000] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:31,000] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=70569.56643364418
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:33,606] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:33,606] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=70587.63171218915
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.97354481 ms
avg iteration GPU training time:20.85332975 ms
avg iteration (step) total cpu time:182.19700727 ms
Epoch Time(s): 5.1503
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.4692 | Train Acc 0.8744 | Speed (samples/sec) 180832.1840 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:36,977] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:36,977] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=70599.62690713075
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.81835911 ms
avg iteration GPU training time:21.33548511 ms
avg iteration (step) total cpu time:208.36914669 ms
Epoch Time(s): 5.3853
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.4694 | Train Acc 0.8713 | Speed (samples/sec) 180986.9135 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:41,751] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:41,751] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=70604.47817379999
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:44,796] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:44,796] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=70601.91462285383
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.67041475 ms
avg iteration GPU training time:21.85916519 ms
avg iteration (step) total cpu time:295.45614936 ms
Epoch Time(s): 6.6145
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.4642 | Train Acc 0.8714 | Speed (samples/sec) 180790.4467 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:50,025] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:50,026] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=70596.21496786969
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:52,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:52,106] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=70610.46799245822
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.43531071 ms
avg iteration GPU training time:21.13101959 ms
avg iteration (step) total cpu time:194.87747279 ms
Epoch Time(s): 6.4100
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.4625 | Train Acc 0.8704 | Speed (samples/sec) 180878.9274 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:24:56,296] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:24:56,296] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=70625.07278372574
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.06857022 ms
avg iteration GPU training time:21.61257310 ms
avg iteration (step) total cpu time:224.95581887 ms
Epoch Time(s): 5.6211
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.4642 | Train Acc 0.8723 | Speed (samples/sec) 180650.5141 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:00,157] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:00,157] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=70608.0600160365
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:03,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:03,365] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=70593.84723159632
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.15096716 ms
avg iteration GPU training time:21.86446242 ms
avg iteration (step) total cpu time:247.39469181 ms
Epoch Time(s): 5.8759
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.4693 | Train Acc 0.8720 | Speed (samples/sec) 179796.2383 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:07,088] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:07,088] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=70549.42760321159
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.80724343 ms
avg iteration GPU training time:21.28759870 ms
avg iteration (step) total cpu time:165.75397145 ms
Epoch Time(s): 5.1711
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.4754 | Train Acc 0.8743 | Speed (samples/sec) 179804.1009 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:11,069] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:11,069] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=70536.30948912133
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:13,059] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:13,059] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=70543.63548075888
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.19346324 ms
avg iteration GPU training time:21.47977326 ms
avg iteration (step) total cpu time:207.95137232 ms
Epoch Time(s): 5.4787
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.4729 | Train Acc 0.8714 | Speed (samples/sec) 179365.9200 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:17,648] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:17,648] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=70533.52270259193
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:20,059] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:20,060] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=70541.49916182584
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.64246100 ms
avg iteration GPU training time:21.34309248 ms
avg iteration (step) total cpu time:223.61907092 ms
Epoch Time(s): 5.8089
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.4452 | Train Acc 0.8761 | Speed (samples/sec) 179550.8658 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:24,260] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:24,261] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=70554.59990937272
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.90679559 ms
avg iteration GPU training time:20.93382090 ms
avg iteration (step) total cpu time:168.16592216 ms
Epoch Time(s): 5.0546
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.4575 | Train Acc 0.8760 | Speed (samples/sec) 179543.3323 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:27,538] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:27,538] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=70559.71367425947
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:30,518] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:30,518] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=70578.55043330266
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.44288887 ms
avg iteration GPU training time:21.07081604 ms
avg iteration (step) total cpu time:203.94223387 ms
Epoch Time(s): 5.4906
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.4711 | Train Acc 0.8731 | Speed (samples/sec) 179668.0008 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:35,557] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:35,558] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=70581.83531673165
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.25931939 ms
avg iteration GPU training time:20.93729158 ms
avg iteration (step) total cpu time:287.44530678 ms
Epoch Time(s): 6.5669
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.4714 | Train Acc 0.8723 | Speed (samples/sec) 179473.9586 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:39,641] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:39,641] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=70597.59350020954
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:41,653] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:41,653] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=70562.60561379373
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.02205953 ms
avg iteration GPU training time:21.45523158 ms
avg iteration (step) total cpu time:165.84290158 ms
Epoch Time(s): 5.2239
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.4740 | Train Acc 0.8737 | Speed (samples/sec) 179641.2748 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:45,636] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:45,637] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=70566.16260850425
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:47,996] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:47,997] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=70586.2861239716
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.92397109 ms
avg iteration GPU training time:20.74626350 ms
avg iteration (step) total cpu time:222.78033603 ms
Epoch Time(s): 5.6013
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.4540 | Train Acc 0.8765 | Speed (samples/sec) 179634.7632 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:52,182] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:52,182] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=70591.63105444184
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.33685251 ms
avg iteration GPU training time:21.38774386 ms
avg iteration (step) total cpu time:202.61138136 ms
Epoch Time(s): 5.4700
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.4504 | Train Acc 0.8782 | Speed (samples/sec) 179779.7815 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:55,950] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:55,951] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=70594.13015371269
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:25:58,625] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:25:58,625] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=70608.0000554997
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:18.19471151 ms
avg iteration GPU training time:21.03581689 ms
avg iteration (step) total cpu time:184.54699083 ms
Epoch Time(s): 5.2582
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.4512 | Train Acc 0.8770 | Speed (samples/sec) 179771.6999 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:02,160] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:02,160] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=70602.95629571806
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.23519143 ms
avg iteration GPU training time:21.34392114 ms
avg iteration (step) total cpu time:229.04922745 ms
Epoch Time(s): 5.7320
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.4668 | Train Acc 0.8741 | Speed (samples/sec) 179618.0358 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:06,763] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:06,763] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=70609.57098658031
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:08,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:08,790] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=70617.34344936788
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.46074191 ms
avg iteration GPU training time:21.00872421 ms
avg iteration (step) total cpu time:205.19239252 ms
Epoch Time(s): 5.5226
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.4753 | Train Acc 0.8694 | Speed (samples/sec) 179291.1079 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:13,323] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:13,323] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=70635.72875657503
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:15,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:15,382] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=70648.22849431746
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44142532 ms
avg iteration GPU training time:20.99611057 ms
avg iteration (step) total cpu time:191.35581363 ms
Epoch Time(s): 5.3503
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4803 | Train Acc 0.8737 | Speed (samples/sec) 179377.7692 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:19,462] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:19,463] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=70634.57132686328
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06484075 ms
avg iteration GPU training time:21.35473147 ms
avg iteration (step) total cpu time:187.49609861 ms
Epoch Time(s): 5.2628
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4800 | Train Acc 0.8704 | Speed (samples/sec) 179184.7351 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:23,120] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:23,120] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=70644.3880208274
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:25,985] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:25,986] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=70651.36583529931
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.25853669 ms
avg iteration GPU training time:21.18724060 ms
avg iteration (step) total cpu time:202.65308293 ms
Epoch Time(s): 5.4788
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4516 | Train Acc 0.8763 | Speed (samples/sec) 179064.0780 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:29,526] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:29,526] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=70664.40193572166
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.98809294 ms
avg iteration GPU training time:21.69204105 ms
avg iteration (step) total cpu time:172.23960703 ms
Epoch Time(s): 5.1464
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4524 | Train Acc 0.8768 | Speed (samples/sec) 179080.0343 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:33,942] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:33,942] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=70656.35017209836
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:36,030] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:36,030] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=70655.18184358605
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.32916953 ms
avg iteration GPU training time:21.68480873 ms
avg iteration (step) total cpu time:204.03911851 ms
Epoch Time(s): 5.8553
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.4795 | Train Acc 0.8671 | Speed (samples/sec) 179212.7500 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:40,344] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:40,344] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=70651.07686361297
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:42,472] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:42,473] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=70655.79979602183
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:16.37218614 ms
avg iteration GPU training time:21.57406824 ms
avg iteration (step) total cpu time:198.30688563 ms
Epoch Time(s): 5.3974
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4595 | Train Acc 0.8741 | Speed (samples/sec) 179185.0757 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:46,740] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:46,741] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=70612.78162741441
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.23516542 ms
avg iteration GPU training time:23.82788103 ms
avg iteration (step) total cpu time:175.62124946 ms
Epoch Time(s): 5.1809
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.4608 | Train Acc 0.8744 | Speed (samples/sec) 179079.0642 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:50,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:50,174] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=70585.69594551338
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:52,638] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:52,639] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=70595.87558409089
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:14.48587634 ms
avg iteration GPU training time:21.09321872 ms
avg iteration (step) total cpu time:167.32311249 ms
Epoch Time(s): 5.0392
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.4599 | Train Acc 0.8773 | Speed (samples/sec) 179204.9891 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:26:56,078] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:26:56,078] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=70602.19460929665
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.27130170 ms
avg iteration GPU training time:21.07057745 ms
avg iteration (step) total cpu time:186.05048006 ms
Epoch Time(s): 5.2303
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.4739 | Train Acc 0.8757 | Speed (samples/sec) 179159.4984 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:27:00,400] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:27:00,400] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=70607.77513830352
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:27:02,349] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:27:02,349] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=70626.53848934299
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:17.41706753 ms
avg iteration GPU training time:20.71527550 ms
avg iteration (step) total cpu time:168.33962094 ms
Epoch Time(s): 5.2228
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.4539 | Train Acc 0.8766 | Speed (samples/sec) 179306.8619 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:27:06,462] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:27:06,462] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=70628.3869411397
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25244140625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:27:08,260] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:27:08,261] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=70618.0298708447
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.83423103 ms
avg iteration GPU training time:21.98745311 ms
avg iteration (step) total cpu time:167.94412786 ms
Epoch Time(s): 5.0743
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.4740 | Train Acc 0.8748 | Speed (samples/sec) 179246.9225 | GPU 2038.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

[2021-06-09 07:27:12,600] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:27:12,600] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=70601.90089125026
-----------------------------------------after batch engine step
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25439453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29931640625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22705078125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22509765625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.990196704864502  GigaBytes

avg iteration(step) data from cpu to GPU time:15.31149942 ms
avg iteration GPU training time:21.82143732 ms
avg iteration (step) total cpu time:184.64190310 ms
Epoch Time(s): 5.3054
Eval Acc 0.8803
Test Acc: 0.6999
Avg epoch time(time.time()): 5338.246427476406 ms
total avg iteration(step) data from cpu to GPU time:16.47320852 ms
total avg iteration GPU training time:21.35978346 ms
total avg iteration (step) total cpu time:194.73460062 ms
