[2021-06-09 07:07:29,259] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-09 07:07:32,896] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 24577 --deepspeed_config ds_config.json
[2021-06-09 07:07:33,772] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-09 07:07:33,772] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-09 07:07:33,772] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-09 07:07:33,772] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-09 07:07:33,772] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623222459.229286
before load_ogb step Time(s): 0.0017
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20394.9921875, 'VmHWM': 1164.9453125, 'VmRSS': 1164.9453125}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6482
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2831
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0011
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1287
-------------------------------------------------end of load ogb****************** step Time(s): 0.0019
finish constructing ogbn-products
load ogb-products time total: 2.0631210803985596
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0640
after inductive else step Time(s): 0.0000
after label step Time(s): 3.7955
after train_g.create_formats_() step Time(s): 1.7756
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 24577
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-09 07:07:46,894] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-09 07:07:46,895] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-09 07:07:46,899] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-09 07:07:49,281] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-09 07:07:49,283] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-09 07:07:49,283] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-09 07:07:49,283] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-09 07:07:49,283] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-09 07:07:49,283] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f417bbdd940>
[2021-06-09 07:07:49,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:07:49,284] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-09 07:07:49,284] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-09 07:07:49,285] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-09 07:07:49,287] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.78564453125GB

Max Memory Allocated 1.3907814025878906  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.85791015625GB

Max Memory Allocated 1.3907814025878906  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.25048828125GB

Max Memory Allocated 1.5343103408813477  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.25048828125GB

Max Memory Allocated 1.5343103408813477  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45166015625GB

Max Memory Allocated 1.5627985000610352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45166015625GB

Max Memory Allocated 1.5627985000610352  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6071 | Train Acc 0.0205 | Speed (samples/sec) nan | GPU 1600.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45166015625GB

Max Memory Allocated 1.5627985000610352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.98291015625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.85791015625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.98291015625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.85986328125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.98291015625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.85791015625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

avg iteration(step) data from cpu to GPU time:27.07708867 ms
avg iteration GPU training time:27.53451729 ms
avg iteration (step) total cpu time:70.86157799 ms
Epoch Time(s): 4.9340
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

Epoch 00001 | Step 00000 | Loss 2.0380 | Train Acc 0.4651 | Speed (samples/sec) 231203.3995 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

[2021-06-09 07:07:57,686] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-09 07:07:57,687] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=51639.999015045185
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

avg iteration(step) data from cpu to GPU time:27.61139234 ms
avg iteration GPU training time:28.59894435 ms
avg iteration (step) total cpu time:70.01916567 ms
Epoch Time(s): 5.5811
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

Epoch 00002 | Step 00000 | Loss 1.1285 | Train Acc 0.7186 | Speed (samples/sec) 247769.8168 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464832305908203  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

[2021-06-09 07:08:02,728] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:02,729] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=51581.50218562584
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

avg iteration(step) data from cpu to GPU time:24.63430405 ms
avg iteration GPU training time:28.81482633 ms
avg iteration (step) total cpu time:77.39726702 ms
Epoch Time(s): 4.5873
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.8279 | Train Acc 0.7942 | Speed (samples/sec) 247143.1680 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

[2021-06-09 07:08:09,286] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:09,287] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=52149.597882053495
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

avg iteration(step) data from cpu to GPU time:26.47955195 ms
avg iteration GPU training time:28.21851730 ms
avg iteration (step) total cpu time:360.19118627 ms
Epoch Time(s): 5.6035
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.6969 | Train Acc 0.8261 | Speed (samples/sec) 214736.2026 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

[2021-06-09 07:08:15,288] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:15,289] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=52164.55677697558
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

avg iteration(step) data from cpu to GPU time:25.26017125 ms
avg iteration GPU training time:28.59604263 ms
avg iteration (step) total cpu time:248.86147181 ms
Epoch Time(s): 5.6013
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.6488 | Train Acc 0.8359 | Speed (samples/sec) 201942.1747 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464860916137695  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

avg iteration(step) data from cpu to GPU time:24.43445333 ms
avg iteration GPU training time:26.78363800 ms
avg iteration (step) total cpu time:65.96485774 ms
Epoch Time(s): 4.9063
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.6041 | Train Acc 0.8452 | Speed (samples/sec) 215684.8395 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

[2021-06-09 07:08:23,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:23,159] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=52523.96320834067
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

avg iteration(step) data from cpu to GPU time:25.71561623 ms
avg iteration GPU training time:64.73349444 ms
avg iteration (step) total cpu time:107.63947169 ms
Epoch Time(s): 4.5627
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.5987 | Train Acc 0.8490 | Speed (samples/sec) 218369.8543 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

[2021-06-09 07:08:27,803] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:27,804] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=49525.86558254887
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.846491813659668  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:25.18893878 ms
avg iteration GPU training time:27.30193011 ms
avg iteration (step) total cpu time:94.11374728 ms
Epoch Time(s): 4.5920
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.5701 | Train Acc 0.8539 | Speed (samples/sec) 220792.2608 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:08:33,825] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:33,825] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=49898.48221113002
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:23.26438332 ms
avg iteration GPU training time:27.86324247 ms
avg iteration (step) total cpu time:77.79550552 ms
Epoch Time(s): 4.5921
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.5459 | Train Acc 0.8582 | Speed (samples/sec) 224396.7878 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:08:38,589] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:38,590] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=50485.43440017284
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:23.30952517 ms
avg iteration GPU training time:27.76751010 ms
avg iteration (step) total cpu time:64.49921926 ms
Epoch Time(s): 4.6089
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.5306 | Train Acc 0.8606 | Speed (samples/sec) 230839.4271 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:22.09285355 ms
avg iteration GPU training time:27.05931727 ms
avg iteration (step) total cpu time:115.66615105 ms
Epoch Time(s): 4.7789
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.5442 | Train Acc 0.8582 | Speed (samples/sec) 229704.9081 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:08:46,389] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:46,390] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=50864.7475468345
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:25.28569667 ms
avg iteration GPU training time:26.26071485 ms
avg iteration (step) total cpu time:67.00142225 ms
Epoch Time(s): 4.5648
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.5232 | Train Acc 0.8620 | Speed (samples/sec) 231232.7034 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:08:51,120] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:51,120] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=51265.14229972749
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:24.36935488 ms
avg iteration GPU training time:26.06214396 ms
avg iteration (step) total cpu time:63.60085805 ms
Epoch Time(s): 4.6710
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.5192 | Train Acc 0.8632 | Speed (samples/sec) 235684.7023 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:08:56,922] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:08:56,923] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=51688.11646989152
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:27.69028346 ms
avg iteration GPU training time:26.44670931 ms
avg iteration (step) total cpu time:89.32240804 ms
Epoch Time(s): 4.4938
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.5174 | Train Acc 0.8600 | Speed (samples/sec) 236279.5756 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:01,855] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:01,855] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=52110.52100847886
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:33.77189382 ms
avg iteration GPU training time:26.35805829 ms
avg iteration (step) total cpu time:76.70887311 ms
Epoch Time(s): 4.7907
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.5116 | Train Acc 0.8631 | Speed (samples/sec) 238514.0118 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:22.87784513 ms
avg iteration GPU training time:26.27458127 ms
avg iteration (step) total cpu time:86.18998528 ms
Epoch Time(s): 4.5871
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.5226 | Train Acc 0.8650 | Speed (samples/sec) 240249.9907 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:09,416] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:09,417] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=52300.16067251253
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:28.93496577 ms
avg iteration GPU training time:27.37630971 ms
avg iteration (step) total cpu time:103.56410344 ms
Epoch Time(s): 4.5247
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.5089 | Train Acc 0.8648 | Speed (samples/sec) 240552.0547 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:14,141] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:14,142] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=52567.90814436609
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:23.97578684 ms
avg iteration GPU training time:26.73696009 ms
avg iteration (step) total cpu time:64.55127398 ms
Epoch Time(s): 4.8028
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.4966 | Train Acc 0.8656 | Speed (samples/sec) 242671.0248 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:20,253] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:20,254] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=52650.57572745468
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:25.01303482 ms
avg iteration GPU training time:28.99691772 ms
avg iteration (step) total cpu time:71.41987483 ms
Epoch Time(s): 4.5863
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.5087 | Train Acc 0.8654 | Speed (samples/sec) 243402.8164 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:25,050] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:25,050] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=52662.26381448644
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:26.68173854 ms
avg iteration GPU training time:28.13493284 ms
avg iteration (step) total cpu time:67.90288289 ms
Epoch Time(s): 4.6552
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.5008 | Train Acc 0.8654 | Speed (samples/sec) 245188.8261 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:23.50051181 ms
avg iteration GPU training time:33.67602094 ms
avg iteration (step) total cpu time:70.74030240 ms
Epoch Time(s): 4.7929
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.4869 | Train Acc 0.8705 | Speed (samples/sec) 246559.6645 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:32,909] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:32,910] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=52555.56161624951
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:26.82586734 ms
avg iteration GPU training time:27.05799484 ms
avg iteration (step) total cpu time:71.83925311 ms
Epoch Time(s): 4.5654
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.5073 | Train Acc 0.8672 | Speed (samples/sec) 247040.1670 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:37,553] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:37,554] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=52727.9223437303
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:24.35539246 ms
avg iteration GPU training time:26.17008018 ms
avg iteration (step) total cpu time:65.32979012 ms
Epoch Time(s): 4.6425
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.4953 | Train Acc 0.8666 | Speed (samples/sec) 248593.3404 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:43,899] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:43,900] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=52882.24414691989
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:28.96910922 ms
avg iteration GPU training time:27.24748802 ms
avg iteration (step) total cpu time:170.81824938 ms
Epoch Time(s): 5.0106
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.4972 | Train Acc 0.8682 | Speed (samples/sec) 246854.3326 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:48,907] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:48,907] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=52879.98018107017
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:27.34545072 ms
avg iteration GPU training time:27.34218725 ms
avg iteration (step) total cpu time:69.68768438 ms
Epoch Time(s): 4.8406
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.4858 | Train Acc 0.8698 | Speed (samples/sec) 247611.8761 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:26.32676252 ms
avg iteration GPU training time:25.91937065 ms
avg iteration (step) total cpu time:65.91439247 ms
Epoch Time(s): 4.5720
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.5005 | Train Acc 0.8658 | Speed (samples/sec) 248733.3989 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:09:57,660] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:09:57,661] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=53019.88462157262
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:24.22390429 ms
avg iteration GPU training time:27.21714147 ms
avg iteration (step) total cpu time:433.94597371 ms
Epoch Time(s): 5.7605
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.4928 | Train Acc 0.8698 | Speed (samples/sec) 247103.8415 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:10:03,376] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:03,377] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=53065.64658562347
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:21.99477259 ms
avg iteration GPU training time:27.94035212 ms
avg iteration (step) total cpu time:339.65428670 ms
Epoch Time(s): 5.8174
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.4876 | Train Acc 0.8689 | Speed (samples/sec) 242927.7587 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:10:09,459] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:09,460] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=53106.735821887116
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:22.84922663 ms
avg iteration GPU training time:28.28280576 ms
avg iteration (step) total cpu time:67.13612874 ms
Epoch Time(s): 4.5609
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.4866 | Train Acc 0.8691 | Speed (samples/sec) 244295.1632 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:10:13,919] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:13,920] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=53078.62660893088
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:26.04542923 ms
avg iteration GPU training time:28.24183464 ms
avg iteration (step) total cpu time:75.82704226 ms
Epoch Time(s): 4.3325
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.4828 | Train Acc 0.8694 | Speed (samples/sec) 244465.2315 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

avg iteration(step) data from cpu to GPU time:26.59570058 ms
avg iteration GPU training time:27.18091774 ms
avg iteration (step) total cpu time:72.77631760 ms
Epoch Time(s): 5.2541
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.4865 | Train Acc 0.8703 | Speed (samples/sec) 244867.9104 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

[2021-06-09 07:10:22,355] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:22,356] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=53040.23665553441
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484735488891602  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:25.38562139 ms
avg iteration GPU training time:27.85759926 ms
avg iteration (step) total cpu time:66.92258517 ms
Epoch Time(s): 4.8360
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.4760 | Train Acc 0.8719 | Speed (samples/sec) 245875.3446 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:10:27,151] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:27,152] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=53073.06344840931
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:24.59621302 ms
avg iteration GPU training time:27.84800021 ms
avg iteration (step) total cpu time:67.50019391 ms
Epoch Time(s): 4.4998
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.4830 | Train Acc 0.8696 | Speed (samples/sec) 246647.7801 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:10:33,793] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:33,794] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=53120.9313790477
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:23.79683177 ms
avg iteration GPU training time:28.15594673 ms
avg iteration (step) total cpu time:66.51703517 ms
Epoch Time(s): 5.4198
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.4739 | Train Acc 0.8727 | Speed (samples/sec) 247618.6305 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:10:39,325] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:39,326] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=53120.72934670082
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:30.36958885 ms
avg iteration GPU training time:27.60180219 ms
avg iteration (step) total cpu time:276.14029249 ms
Epoch Time(s): 5.3789
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.4759 | Train Acc 0.8725 | Speed (samples/sec) 244042.8395 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:24.59705544 ms
avg iteration GPU training time:27.27242661 ms
avg iteration (step) total cpu time:69.48153178 ms
Epoch Time(s): 4.6061
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4963 | Train Acc 0.8670 | Speed (samples/sec) 244911.3972 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:10:46,814] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:46,814] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=53190.56554472794
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:26.35836792 ms
avg iteration GPU training time:26.32194138 ms
avg iteration (step) total cpu time:68.74457995 ms
Epoch Time(s): 4.3670
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.4958 | Train Acc 0.8667 | Speed (samples/sec) 245344.0416 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:10:51,411] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:51,412] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=53154.44437822854
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:27.49001567 ms
avg iteration GPU training time:29.49602127 ms
avg iteration (step) total cpu time:215.29547373 ms
Epoch Time(s): 4.8926
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4758 | Train Acc 0.8729 | Speed (samples/sec) 243204.8698 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:10:58,042] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:10:58,043] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=53086.977983476194
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:25.68495941 ms
avg iteration GPU training time:29.50603739 ms
avg iteration (step) total cpu time:70.27045886 ms
Epoch Time(s): 4.9981
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.4772 | Train Acc 0.8696 | Speed (samples/sec) 243679.7563 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:02,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:02,680] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=53148.96711156912
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:28.61283239 ms
avg iteration GPU training time:27.72558912 ms
avg iteration (step) total cpu time:80.76612155 ms
Epoch Time(s): 4.4865
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4757 | Train Acc 0.8731 | Speed (samples/sec) 243758.8021 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:41.97415479 ms
avg iteration GPU training time:27.05222448 ms
avg iteration (step) total cpu time:83.43935013 ms
Epoch Time(s): 4.8072
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4758 | Train Acc 0.8699 | Speed (samples/sec) 244010.5400 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:10,639] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:10,640] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=53176.38211341889
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:22.07277870 ms
avg iteration GPU training time:25.94823456 ms
avg iteration (step) total cpu time:64.90540504 ms
Epoch Time(s): 4.7266
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4753 | Train Acc 0.8722 | Speed (samples/sec) 244903.3388 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:15,674] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:15,675] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=53260.224138983824
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:23.28909938 ms
avg iteration GPU training time:26.76485380 ms
avg iteration (step) total cpu time:179.59101995 ms
Epoch Time(s): 4.9549
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4743 | Train Acc 0.8732 | Speed (samples/sec) 244095.3322 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:21,717] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:21,718] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=53343.1236206339
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:24.33724785 ms
avg iteration GPU training time:26.45020803 ms
avg iteration (step) total cpu time:65.02747536 ms
Epoch Time(s): 4.6710
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4617 | Train Acc 0.8744 | Speed (samples/sec) 244931.5700 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:26,703] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:26,704] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=53431.07797093818
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:24.22144000 ms
avg iteration GPU training time:26.88537598 ms
avg iteration (step) total cpu time:75.19467672 ms
Epoch Time(s): 4.8961
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4851 | Train Acc 0.8704 | Speed (samples/sec) 245476.9425 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:24.12191963 ms
avg iteration GPU training time:26.41034635 ms
avg iteration (step) total cpu time:68.92148654 ms
Epoch Time(s): 4.5634
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4652 | Train Acc 0.8722 | Speed (samples/sec) 245486.3117 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:34,389] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:34,390] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=53346.59457646044
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:24.60760498 ms
avg iteration GPU training time:26.57641602 ms
avg iteration (step) total cpu time:65.88649750 ms
Epoch Time(s): 4.6056
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4841 | Train Acc 0.8708 | Speed (samples/sec) 246255.6592 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:39,045] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:39,046] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=53403.343919147825
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:23.86178144 ms
avg iteration GPU training time:27.42666626 ms
avg iteration (step) total cpu time:64.40560023 ms
Epoch Time(s): 4.6658
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4708 | Train Acc 0.8735 | Speed (samples/sec) 247033.1688 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:45,233] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:45,234] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=53398.91585815843
-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:31.34733899 ms
avg iteration GPU training time:27.89543470 ms
avg iteration (step) total cpu time:144.67914899 ms
Epoch Time(s): 4.8059
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4815 | Train Acc 0.8707 | Speed (samples/sec) 246276.8824 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

[2021-06-09 07:11:49,932] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:11:49,932] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=53411.68573265863
-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:26.53564835 ms
avg iteration GPU training time:27.90548261 ms
avg iteration (step) total cpu time:97.87567457 ms
Epoch Time(s): 4.5703
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4709 | Train Acc 0.8728 | Speed (samples/sec) 245609.7970 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484787940979004  GigaBytes

avg iteration(step) data from cpu to GPU time:26.42686971 ms
avg iteration GPU training time:27.14164225 ms
avg iteration (step) total cpu time:68.67027283 ms
Epoch Time(s): 4.5091
Eval Acc 0.8775
Test Acc: 0.7001
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4764 | Train Acc 0.8725 | Speed (samples/sec) 246026.5199 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:12:32,488] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:12:32,489] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=53420.991256665904
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.48373413 ms
avg iteration GPU training time:26.03208478 ms
avg iteration (step) total cpu time:66.73947970 ms
Epoch Time(s): 4.6905
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.4738 | Train Acc 0.8748 | Speed (samples/sec) 246665.7350 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:12:38,266] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:12:38,267] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=53454.6486307736
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.09876251 ms
avg iteration GPU training time:27.72254944 ms
avg iteration (step) total cpu time:304.52950795 ms
Epoch Time(s): 6.0876
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4675 | Train Acc 0.8720 | Speed (samples/sec) 245587.7609 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:12:44,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:12:44,591] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=53465.8904524162
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.86724281 ms
avg iteration GPU training time:27.68459765 ms
avg iteration (step) total cpu time:215.02534548 ms
Epoch Time(s): 5.1399
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4734 | Train Acc 0.8702 | Speed (samples/sec) 244665.9337 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:12:50,890] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:12:50,891] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=53493.1010176133
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:31.57179769 ms
avg iteration GPU training time:26.70872498 ms
avg iteration (step) total cpu time:335.46304703 ms
Epoch Time(s): 5.6981
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4572 | Train Acc 0.8783 | Speed (samples/sec) 242984.7845 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.35335477 ms
avg iteration GPU training time:26.54738108 ms
avg iteration (step) total cpu time:103.51872444 ms
Epoch Time(s): 5.4164
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4808 | Train Acc 0.8670 | Speed (samples/sec) 242934.6437 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:12:59,406] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:12:59,407] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=53548.25027671586
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:23.73619207 ms
avg iteration GPU training time:25.88043722 ms
avg iteration (step) total cpu time:64.02031581 ms
Epoch Time(s): 4.8289
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.4727 | Train Acc 0.8719 | Speed (samples/sec) 243697.5635 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:04,369] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:04,369] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=53627.01345788282
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.36800067 ms
avg iteration GPU training time:26.70090675 ms
avg iteration (step) total cpu time:66.07961655 ms
Epoch Time(s): 4.7679
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.4686 | Train Acc 0.8726 | Speed (samples/sec) 244291.6861 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:10,358] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:10,359] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=53598.559938958395
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:23.05728022 ms
avg iteration GPU training time:26.80356280 ms
avg iteration (step) total cpu time:64.85335032 ms
Epoch Time(s): 4.5777
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4729 | Train Acc 0.8718 | Speed (samples/sec) 244864.2814 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:15,145] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:15,146] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=53664.44920337009
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:22.32796796 ms
avg iteration GPU training time:26.33404795 ms
avg iteration (step) total cpu time:63.06473414 ms
Epoch Time(s): 4.6381
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.4598 | Train Acc 0.8753 | Speed (samples/sec) 245610.8732 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.83964793 ms
avg iteration GPU training time:27.22025617 ms
avg iteration (step) total cpu time:560.81589063 ms
Epoch Time(s): 6.8241
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4712 | Train Acc 0.8726 | Speed (samples/sec) 245209.4272 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:24,978] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:24,978] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=53607.84018129055
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:27.81149864 ms
avg iteration GPU training time:26.90410614 ms
avg iteration (step) total cpu time:166.88688596 ms
Epoch Time(s): 5.4763
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.4741 | Train Acc 0.8710 | Speed (samples/sec) 244379.6809 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:30,618] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:30,618] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=53619.65338150813
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.37202136 ms
avg iteration GPU training time:26.76090622 ms
avg iteration (step) total cpu time:70.20362218 ms
Epoch Time(s): 4.5511
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.4699 | Train Acc 0.8748 | Speed (samples/sec) 244446.2000 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:36,286] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:36,287] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=53660.206675917005
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:24.93927447 ms
avg iteration GPU training time:26.35501862 ms
avg iteration (step) total cpu time:92.54479408 ms
Epoch Time(s): 4.4069
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.4629 | Train Acc 0.8776 | Speed (samples/sec) 244615.1980 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:41,058] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:41,059] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=53706.485586541756
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.29980787 ms
avg iteration GPU training time:27.44898160 ms
avg iteration (step) total cpu time:107.09373156 ms
Epoch Time(s): 4.6954
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.4699 | Train Acc 0.8728 | Speed (samples/sec) 244648.0292 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:31.66508802 ms
avg iteration GPU training time:26.08289019 ms
avg iteration (step) total cpu time:72.05684980 ms
Epoch Time(s): 4.9724
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.4792 | Train Acc 0.8738 | Speed (samples/sec) 244962.5717 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:49,235] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:49,235] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=53747.78297937755
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.38216591 ms
avg iteration GPU training time:25.89811198 ms
avg iteration (step) total cpu time:65.08676211 ms
Epoch Time(s): 4.7652
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.4714 | Train Acc 0.8744 | Speed (samples/sec) 245476.3876 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:13:54,050] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:13:54,051] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=53800.35488044858
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:28.46909841 ms
avg iteration GPU training time:27.47258695 ms
avg iteration (step) total cpu time:89.69585101 ms
Epoch Time(s): 4.5897
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.4684 | Train Acc 0.8768 | Speed (samples/sec) 245437.2225 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:00,156] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:00,157] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=53814.75582740683
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:24.30874697 ms
avg iteration GPU training time:33.44286982 ms
avg iteration (step) total cpu time:75.18132528 ms
Epoch Time(s): 4.8865
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.4713 | Train Acc 0.8734 | Speed (samples/sec) 245619.9425 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:05,775] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:05,776] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=53756.346535264296
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.79133860 ms
avg iteration GPU training time:26.92050171 ms
avg iteration (step) total cpu time:248.73789152 ms
Epoch Time(s): 5.4732
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.4711 | Train Acc 0.8735 | Speed (samples/sec) 245331.9560 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:27.54266675 ms
avg iteration GPU training time:26.01443227 ms
avg iteration (step) total cpu time:169.78828112 ms
Epoch Time(s): 4.7916
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.4757 | Train Acc 0.8735 | Speed (samples/sec) 245013.0486 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:13,911] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:13,912] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=53787.22331307929
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:32.21482658 ms
avg iteration GPU training time:26.98333804 ms
avg iteration (step) total cpu time:77.22894351 ms
Epoch Time(s): 4.9811
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.4643 | Train Acc 0.8731 | Speed (samples/sec) 245156.5384 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:19,010] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:19,011] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=53825.28602635959
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.12581380 ms
avg iteration GPU training time:26.47216034 ms
avg iteration (step) total cpu time:86.64115270 ms
Epoch Time(s): 4.9354
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.4751 | Train Acc 0.8693 | Speed (samples/sec) 245270.6306 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:24,946] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:24,947] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=53861.26303802517
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.63608551 ms
avg iteration GPU training time:26.91256587 ms
avg iteration (step) total cpu time:68.15163294 ms
Epoch Time(s): 4.6422
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.4729 | Train Acc 0.8708 | Speed (samples/sec) 245656.1439 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:30,375] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:30,376] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=53906.173967917304
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.51935959 ms
avg iteration GPU training time:25.88612239 ms
avg iteration (step) total cpu time:188.51582209 ms
Epoch Time(s): 5.2974
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.4725 | Train Acc 0.8706 | Speed (samples/sec) 245006.8679 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.34852282 ms
avg iteration GPU training time:26.14842669 ms
avg iteration (step) total cpu time:349.10758336 ms
Epoch Time(s): 5.4670
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.4616 | Train Acc 0.8739 | Speed (samples/sec) 244446.6581 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:38,913] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:38,914] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=53922.22160150385
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.47035726 ms
avg iteration GPU training time:25.74420230 ms
avg iteration (step) total cpu time:65.20446142 ms
Epoch Time(s): 4.6257
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.4807 | Train Acc 0.8701 | Speed (samples/sec) 244901.2166 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:43,835] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:43,836] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=53967.728043233925
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:28.06138674 ms
avg iteration GPU training time:26.67125384 ms
avg iteration (step) total cpu time:127.77725856 ms
Epoch Time(s): 4.7082
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.4680 | Train Acc 0.8713 | Speed (samples/sec) 244451.6312 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:50,614] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:50,615] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=53979.72650591778
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:31.74842580 ms
avg iteration GPU training time:28.23856036 ms
avg iteration (step) total cpu time:214.93856112 ms
Epoch Time(s): 5.5543
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.4700 | Train Acc 0.8749 | Speed (samples/sec) 243300.5388 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:14:56,415] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:14:56,416] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=53964.6265035672
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:29.86289024 ms
avg iteration GPU training time:27.90141869 ms
avg iteration (step) total cpu time:71.67720795 ms
Epoch Time(s): 5.6754
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.4679 | Train Acc 0.8731 | Speed (samples/sec) 243444.3560 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:31.05244764 ms
avg iteration GPU training time:27.94744555 ms
avg iteration (step) total cpu time:93.14417839 ms
Epoch Time(s): 4.8804
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.4633 | Train Acc 0.8739 | Speed (samples/sec) 242934.1371 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:05,078] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:05,079] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=53904.961300045565
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.33670362 ms
avg iteration GPU training time:35.03559494 ms
avg iteration (step) total cpu time:106.14649455 ms
Epoch Time(s): 5.4101
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.4575 | Train Acc 0.8746 | Speed (samples/sec) 242477.4973 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:10,235] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:10,236] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=53827.62215263755
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:28.01184018 ms
avg iteration GPU training time:28.04478900 ms
avg iteration (step) total cpu time:70.27157148 ms
Epoch Time(s): 4.8938
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.4709 | Train Acc 0.8713 | Speed (samples/sec) 242735.7334 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:16,316] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:16,317] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=53811.89802658758
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:30.06076813 ms
avg iteration GPU training time:29.34258143 ms
avg iteration (step) total cpu time:72.81891505 ms
Epoch Time(s): 4.8167
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.4835 | Train Acc 0.8693 | Speed (samples/sec) 242957.8249 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:21,391] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:21,392] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=53794.099671385644
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:30.82180341 ms
avg iteration GPU training time:27.60076777 ms
avg iteration (step) total cpu time:210.01784007 ms
Epoch Time(s): 4.9323
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.4680 | Train Acc 0.8746 | Speed (samples/sec) 242552.6200 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:27.04555702 ms
avg iteration GPU training time:28.56789335 ms
avg iteration (step) total cpu time:72.69263268 ms
Epoch Time(s): 4.8895
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.4637 | Train Acc 0.8757 | Speed (samples/sec) 242377.4447 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:29,507] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:29,508] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=53740.174828196185
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.62403170 ms
avg iteration GPU training time:26.40805372 ms
avg iteration (step) total cpu time:66.83595975 ms
Epoch Time(s): 4.7608
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.4659 | Train Acc 0.8724 | Speed (samples/sec) 242754.6782 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:34,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:34,435] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=53777.224087549585
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.59235191 ms
avg iteration GPU training time:26.44255956 ms
avg iteration (step) total cpu time:65.96612930 ms
Epoch Time(s): 5.2080
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.4495 | Train Acc 0.8770 | Speed (samples/sec) 243222.6359 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:41,021] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:41,022] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=53773.25868493162
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:27.22773298 ms
avg iteration GPU training time:28.05583000 ms
avg iteration (step) total cpu time:229.90242640 ms
Epoch Time(s): 5.1807
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.4702 | Train Acc 0.8732 | Speed (samples/sec) 242008.1424 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:46,418] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:46,419] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=53775.50183987837
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:28.30347761 ms
avg iteration GPU training time:28.06956800 ms
avg iteration (step) total cpu time:71.18344307 ms
Epoch Time(s): 5.0065
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4658 | Train Acc 0.8721 | Speed (samples/sec) 242096.8539 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.91992505 ms
avg iteration GPU training time:29.52530162 ms
avg iteration (step) total cpu time:70.33626239 ms
Epoch Time(s): 4.9970
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4633 | Train Acc 0.8743 | Speed (samples/sec) 242316.7195 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:15:55,128] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:15:55,128] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=53754.68994762011
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:33.39271482 ms
avg iteration GPU training time:28.17841021 ms
avg iteration (step) total cpu time:452.41681735 ms
Epoch Time(s): 6.5110
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4632 | Train Acc 0.8733 | Speed (samples/sec) 240234.1130 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:16:01,952] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:16:01,953] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=53736.20440155481
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:38.10690117 ms
avg iteration GPU training time:27.69634120 ms
avg iteration (step) total cpu time:212.94617653 ms
Epoch Time(s): 5.4804
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4604 | Train Acc 0.8755 | Speed (samples/sec) 238957.8558 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:16:08,555] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:16:08,555] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=53746.46807525921
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.04876773 ms
avg iteration GPU training time:28.42965317 ms
avg iteration (step) total cpu time:67.13517507 ms
Epoch Time(s): 5.2618
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.4658 | Train Acc 0.8746 | Speed (samples/sec) 239432.6760 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:16:13,549] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:16:13,550] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=53752.671085013855
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.12178103 ms
avg iteration GPU training time:27.60312525 ms
avg iteration (step) total cpu time:178.94951502 ms
Epoch Time(s): 4.8478
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4595 | Train Acc 0.8758 | Speed (samples/sec) 239122.9774 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:35.78344409 ms
avg iteration GPU training time:26.84427706 ms
avg iteration (step) total cpu time:134.59205627 ms
Epoch Time(s): 5.6946
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.4727 | Train Acc 0.8730 | Speed (samples/sec) 239034.5497 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:16:22,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:16:22,426] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=53774.247305048746
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.11450704 ms
avg iteration GPU training time:25.99720573 ms
avg iteration (step) total cpu time:65.89595477 ms
Epoch Time(s): 4.7687
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.4623 | Train Acc 0.8726 | Speed (samples/sec) 239441.5547 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:16:27,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:16:27,175] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=53790.638261621185
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.38046964 ms
avg iteration GPU training time:28.26542981 ms
avg iteration (step) total cpu time:66.57958031 ms
Epoch Time(s): 4.7459
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.4619 | Train Acc 0.8724 | Speed (samples/sec) 239774.4524 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:16:33,457] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:16:33,458] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=53767.78443523819
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.32007472 ms
avg iteration GPU training time:28.32767995 ms
avg iteration (step) total cpu time:118.27452977 ms
Epoch Time(s): 4.8458
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.4639 | Train Acc 0.8745 | Speed (samples/sec) 239510.8664 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

[2021-06-09 07:16:38,269] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:16:38,270] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=53767.567512457426
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:23.26922671 ms
avg iteration GPU training time:28.33301290 ms
avg iteration (step) total cpu time:68.37280591 ms
Epoch Time(s): 4.6731
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.4664 | Train Acc 0.8736 | Speed (samples/sec) 239829.6216 | GPU 2354.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.2997360229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:23.56132253 ms
avg iteration GPU training time:27.92821312 ms
avg iteration (step) total cpu time:64.97208277 ms
Epoch Time(s): 4.7144
Eval Acc 0.8801
Test Acc: 0.7028
Avg epoch time(time.time()): 4925.116462012132 ms
total avg iteration(step) data from cpu to GPU time:26.58175822 ms
total avg iteration GPU training time:27.87103453 ms
total avg iteration (step) total cpu time:121.95301764 ms
