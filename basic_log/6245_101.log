[2021-06-09 07:27:51,737] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-09 07:27:55,517] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 6245 --deepspeed_config ds_config.json
[2021-06-09 07:27:56,513] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-09 07:27:56,513] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-09 07:27:56,513] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-09 07:27:56,513] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-09 07:27:56,513] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623223682.124194
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20395.0, 'VmHWM': 1164.71484375, 'VmRSS': 1164.71484375}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6395
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2827
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0000
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0784
-------------------------------------------------end of load ogb****************** step Time(s): 0.0020
finish constructing ogbn-products
load ogb-products time total: 2.0041728019714355
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0051
after inductive else step Time(s): 0.0001
after label step Time(s): 3.6201
after train_g.create_formats_() step Time(s): 1.4752
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 6245
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-09 07:28:09,259] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-09 07:28:09,259] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-09 07:28:09,263] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-09 07:28:11,678] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-09 07:28:11,681] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-09 07:28:11,681] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-09 07:28:11,681] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-09 07:28:11,681] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-09 07:28:11,681] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f931cfa9940>
[2021-06-09 07:28:11,681] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:11,681] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-09 07:28:11,682] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-09 07:28:11,683] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-09 07:28:11,685] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.58642578125GB

Max Memory Allocated 1.1875829696655273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.63134765625GB

Max Memory Allocated 1.1875829696655273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 2.88134765625GB

Max Memory Allocated 1.2502727508544922  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 2.88134765625GB

Max Memory Allocated 1.2502727508544922  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 2.96142578125GB

Max Memory Allocated 1.274118423461914  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 2.96142578125GB

Max Memory Allocated 1.274118423461914  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6505 | Train Acc 0.0210 | Speed (samples/sec) nan | GPU 1304.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.96142578125GB

Max Memory Allocated 1.274118423461914  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21533203125GB

Max Memory Allocated 1.4411711692810059  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22705078125GB

Max Memory Allocated 1.4411711692810059  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24072265625GB

Max Memory Allocated 1.4411711692810059  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.19970703125GB

Max Memory Allocated 1.4411711692810059  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4411711692810059  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4411711692810059  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4411711692810059  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.19970703125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.20166015625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.19970703125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.20166015625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4414548873901367  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4414548873901367  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes

[2021-06-09 07:28:14,615] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-09 07:28:14,615] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=94556.1062119806
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.442091464996338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4422616958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4422616958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4422616958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4422616958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4422616958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4422616958618164  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4422616958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

[2021-06-09 07:28:16,775] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:16,775] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=94035.27208864938
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

Epoch 00000 | Step 00020 | Loss 0.9876 | Train Acc 0.7616 | Speed (samples/sec) 115288.8494 | GPU 1478.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

[2021-06-09 07:28:18,007] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:18,007] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=94114.0850495705
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

avg iteration(step) data from cpu to GPU time:9.64835559 ms
avg iteration GPU training time:16.11375879 ms
avg iteration (step) total cpu time:141.19885586 ms
Epoch Time(s): 6.8054
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

Epoch 00001 | Step 00000 | Loss 0.7236 | Train Acc 0.8171 | Speed (samples/sec) 116385.0694 | GPU 1478.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

[2021-06-09 07:28:20,816] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:20,816] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=92829.64642660227
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

[2021-06-09 07:28:22,201] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:22,202] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=93067.81450038939
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

Epoch 00001 | Step 00020 | Loss 0.6165 | Train Acc 0.8418 | Speed (samples/sec) 127635.4203 | GPU 1478.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

[2021-06-09 07:28:23,133] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:23,133] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=94075.54259064232
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44970703125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

avg iteration(step) data from cpu to GPU time:10.11030644 ms
avg iteration GPU training time:19.66686574 ms
avg iteration (step) total cpu time:108.59466482 ms
Epoch Time(s): 5.4385
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.5868 | Train Acc 0.8477 | Speed (samples/sec) 126918.0005 | GPU 1478.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

[2021-06-09 07:28:25,915] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:25,915] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=86073.73684657384
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

[2021-06-09 07:28:26,916] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:26,916] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=87855.15042666001
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4435667991638184  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

Epoch 00002 | Step 00020 | Loss 0.5776 | Train Acc 0.8524 | Speed (samples/sec) 125766.3989 | GPU 1478.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

[2021-06-09 07:28:28,495] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:28,495] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=88632.99460628022
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

avg iteration(step) data from cpu to GPU time:10.05961369 ms
avg iteration GPU training time:15.40889118 ms
avg iteration (step) total cpu time:118.09722582 ms
Epoch Time(s): 5.4050
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.5381 | Train Acc 0.8607 | Speed (samples/sec) 121961.4845 | GPU 1478.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

[2021-06-09 07:28:30,978] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:30,978] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=89765.78796375549
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

[2021-06-09 07:28:32,408] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:32,408] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=90043.08139199737
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

Epoch 00003 | Step 00020 | Loss 0.5290 | Train Acc 0.8568 | Speed (samples/sec) 122658.1613 | GPU 1478.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

[2021-06-09 07:28:33,386] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:33,387] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=90941.3177032752
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44970703125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

avg iteration(step) data from cpu to GPU time:10.08442665 ms
avg iteration GPU training time:15.35616709 ms
avg iteration (step) total cpu time:106.45483158 ms
Epoch Time(s): 5.1945
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5185 | Train Acc 0.8669 | Speed (samples/sec) 123405.5685 | GPU 1478.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

[2021-06-09 07:28:36,104] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:36,105] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=91470.72795153191
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4437403678894043  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:37,154] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:37,154] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=92000.99437516808
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00004 | Step 00020 | Loss 0.5197 | Train Acc 0.8626 | Speed (samples/sec) 126484.2843 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:38,877] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:38,877] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=92471.36292588858
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:40,019] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:40,019] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=93183.74139945183
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:9.87213749 ms
avg iteration GPU training time:15.11167887 ms
avg iteration (step) total cpu time:127.65165612 ms
Epoch Time(s): 5.7647
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.5333 | Train Acc 0.8568 | Speed (samples/sec) 128260.6927 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:42,836] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:42,836] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=93058.64951442361
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:44,067] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:44,067] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=93279.818924336
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00005 | Step 00020 | Loss 0.5207 | Train Acc 0.8588 | Speed (samples/sec) 126549.3688 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:45,409] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:45,409] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=92945.38785142018
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.47900390625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17566573 ms
avg iteration GPU training time:16.42634664 ms
avg iteration (step) total cpu time:117.19114692 ms
Epoch Time(s): 5.4364
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.5242 | Train Acc 0.8602 | Speed (samples/sec) 125913.9436 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:47,841] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:47,842] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=93116.7949079049
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:49,142] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:49,142] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=93394.45579481212
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00006 | Step 00020 | Loss 0.5100 | Train Acc 0.8608 | Speed (samples/sec) 127778.0315 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:50,462] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:50,462] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=93823.43984220854
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44580078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:9.07770895 ms
avg iteration GPU training time:15.08107019 ms
avg iteration (step) total cpu time:120.61866124 ms
Epoch Time(s): 5.5786
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.5274 | Train Acc 0.8580 | Speed (samples/sec) 128993.7744 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:53,525] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:53,526] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=93769.58019499235
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:56,060] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:56,060] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=93630.52035508859
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00007 | Step 00020 | Loss 0.4950 | Train Acc 0.8616 | Speed (samples/sec) 129106.8506 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:28:57,275] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:28:57,275] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=93682.95485733365
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44970703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.93096060 ms
avg iteration GPU training time:16.89807408 ms
avg iteration (step) total cpu time:176.19442057 ms
Epoch Time(s): 7.2059
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.4909 | Train Acc 0.8639 | Speed (samples/sec) 128487.8707 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:00,220] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:00,220] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=93400.80289690572
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:01,747] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:01,747] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=93495.53219268846
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00008 | Step 00020 | Loss 0.5165 | Train Acc 0.8573 | Speed (samples/sec) 127283.3516 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:02,719] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:02,719] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=93701.60890723774
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.32762547 ms
avg iteration GPU training time:15.62384591 ms
avg iteration (step) total cpu time:111.19737449 ms
Epoch Time(s): 5.3714
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.5010 | Train Acc 0.8697 | Speed (samples/sec) 126471.1041 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:05,474] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:05,475] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=93613.97635268976
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:06,596] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:06,597] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=93647.11815121488
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00009 | Step 00020 | Loss 0.5155 | Train Acc 0.8628 | Speed (samples/sec) 126907.6824 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:08,331] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:08,332] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=93672.22858406886
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44970703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:09,299] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:09,299] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=93983.21938783133
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.91698366 ms
avg iteration GPU training time:15.80227806 ms
avg iteration (step) total cpu time:121.97362935 ms
Epoch Time(s): 5.7123
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.5053 | Train Acc 0.8645 | Speed (samples/sec) 127636.6446 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:12,123] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:12,123] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=94025.64074407922
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:13,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:13,106] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=94188.26623312112
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00010 | Step 00020 | Loss 0.4884 | Train Acc 0.8709 | Speed (samples/sec) 128355.7728 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:14,365] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:14,365] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=94248.28537278759
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.24673896 ms
avg iteration GPU training time:15.42776419 ms
avg iteration (step) total cpu time:105.77336947 ms
Epoch Time(s): 5.1485
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.4728 | Train Acc 0.8709 | Speed (samples/sec) 127877.7499 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:16,815] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:16,815] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=94305.5350427432
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:18,331] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:18,332] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=94421.06596089654
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00011 | Step 00020 | Loss 0.4864 | Train Acc 0.8708 | Speed (samples/sec) 127957.7855 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:19,503] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:19,503] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=94547.30027955849
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44580078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.30333985 ms
avg iteration GPU training time:15.39774700 ms
avg iteration (step) total cpu time:120.64250310 ms
Epoch Time(s): 5.4778
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.4615 | Train Acc 0.8738 | Speed (samples/sec) 127986.7609 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:22,317] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:22,317] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=94528.18669724508
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:23,333] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:23,333] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=94645.67276040284
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00012 | Step 00020 | Loss 0.4936 | Train Acc 0.8637 | Speed (samples/sec) 128723.1780 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:24,686] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:24,686] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=94793.59132505087
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.63854467 ms
avg iteration GPU training time:15.45785713 ms
avg iteration (step) total cpu time:107.40016125 ms
Epoch Time(s): 5.2056
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.4734 | Train Acc 0.8714 | Speed (samples/sec) 129045.6105 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:27,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:27,106] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=94790.18332138406
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:28,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:28,705] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=94950.04696297128
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00013 | Step 00020 | Loss 0.5042 | Train Acc 0.8623 | Speed (samples/sec) 129835.3240 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:30,163] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:30,163] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=94761.0124442922
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

avg iteration(step) data from cpu to GPU time:10.26264885 ms
avg iteration GPU training time:16.32660269 ms
avg iteration (step) total cpu time:130.03840270 ms
Epoch Time(s): 5.8654
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.4865 | Train Acc 0.8685 | Speed (samples/sec) 130078.3435 | GPU 1478.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:32,993] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:32,994] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=94729.9275842979
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:34,243] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:34,243] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=94846.8591639337
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

Epoch 00014 | Step 00020 | Loss 0.5073 | Train Acc 0.8642 | Speed (samples/sec) 129941.6602 | GPU 1478.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

[2021-06-09 07:29:35,582] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:35,582] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=94921.27292577017
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4439191818237305  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44580078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:36,518] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:36,518] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=95048.03919145532
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:10.66672715 ms
avg iteration GPU training time:15.43725632 ms
avg iteration (step) total cpu time:116.99606754 ms
Epoch Time(s): 5.4983
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.4826 | Train Acc 0.8663 | Speed (samples/sec) 129310.1676 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:39,964] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:39,964] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=94964.34845166688
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:41,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:41,174] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=94958.51774829805
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00015 | Step 00020 | Loss 0.4893 | Train Acc 0.8772 | Speed (samples/sec) 129075.3228 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:42,661] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:42,661] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=94942.42434639554
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:12.07364383 ms
avg iteration GPU training time:16.18423822 ms
avg iteration (step) total cpu time:124.58047160 ms
Epoch Time(s): 6.1835
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.4910 | Train Acc 0.8689 | Speed (samples/sec) 129096.8444 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:45,822] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:45,823] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=94872.68904282509
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:47,390] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:47,390] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=94944.07766628446
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00016 | Step 00020 | Loss 0.4880 | Train Acc 0.8685 | Speed (samples/sec) 129319.2818 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:48,603] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:48,603] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=95012.38062200711
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44970703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:10.62478103 ms
avg iteration GPU training time:15.77731080 ms
avg iteration (step) total cpu time:147.35820558 ms
Epoch Time(s): 6.3448
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.5078 | Train Acc 0.8685 | Speed (samples/sec) 128690.4499 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:51,549] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:51,549] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=95004.07914432237
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:52,647] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:52,647] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=94969.28359368716
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00017 | Step 00020 | Loss 0.5045 | Train Acc 0.8592 | Speed (samples/sec) 127853.8775 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:54,521] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:54,522] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=94943.76334485655
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44580078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:10.11881136 ms
avg iteration GPU training time:16.14342877 ms
avg iteration (step) total cpu time:137.57914967 ms
Epoch Time(s): 6.0130
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.4736 | Train Acc 0.8681 | Speed (samples/sec) 127427.8384 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:56,993] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:56,993] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=94868.60352148465
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:58,440] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:58,441] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=94945.06111822977
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00018 | Step 00020 | Loss 0.4852 | Train Acc 0.8716 | Speed (samples/sec) 128259.6945 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:29:59,457] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:29:59,457] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=95067.792678976
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:9.54578031 ms
avg iteration GPU training time:15.05289011 ms
avg iteration (step) total cpu time:110.52753307 ms
Epoch Time(s): 5.3323
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.4810 | Train Acc 0.8705 | Speed (samples/sec) 128639.7054 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:02,199] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:02,199] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=95150.96521183796
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:03,237] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:03,237] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=95238.62242165541
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00019 | Step 00020 | Loss 0.4664 | Train Acc 0.8740 | Speed (samples/sec) 129217.0318 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:04,752] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:04,752] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=95279.72453764353
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:05,972] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:05,972] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=95391.29937578505
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:9.45122849 ms
avg iteration GPU training time:15.33336788 ms
avg iteration (step) total cpu time:122.38973158 ms
Epoch Time(s): 5.6061
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.4754 | Train Acc 0.8697 | Speed (samples/sec) 129614.8954 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:08,861] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:08,861] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=95286.62913676609
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:09,952] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:09,953] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=95274.6257203775
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00020 | Step 00020 | Loss 0.4841 | Train Acc 0.8703 | Speed (samples/sec) 130080.8458 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:11,201] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:11,202] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=95390.17293598971
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75558281 ms
avg iteration GPU training time:15.30834611 ms
avg iteration (step) total cpu time:107.35721058 ms
Epoch Time(s): 5.2415
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.4968 | Train Acc 0.8709 | Speed (samples/sec) 130486.0212 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:13,657] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:13,658] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=95435.76295278326
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:14,982] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:14,982] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=95447.33235582172
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00021 | Step 00020 | Loss 0.5002 | Train Acc 0.8681 | Speed (samples/sec) 130851.7394 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:16,118] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:16,118] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=95510.03846490708
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:9.79188857 ms
avg iteration GPU training time:15.60875359 ms
avg iteration (step) total cpu time:117.43367160 ms
Epoch Time(s): 5.4707
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.5072 | Train Acc 0.8658 | Speed (samples/sec) 131061.8008 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:19,190] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:19,190] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=95491.92999179207
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:21,376] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:21,377] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=95439.87534429597
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00022 | Step 00020 | Loss 0.4975 | Train Acc 0.8658 | Speed (samples/sec) 130312.3780 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:22,456] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:22,456] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=95460.08563183538
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:12.47200710 ms
avg iteration GPU training time:16.17259619 ms
avg iteration (step) total cpu time:155.50355558 ms
Epoch Time(s): 6.6642
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.5135 | Train Acc 0.8591 | Speed (samples/sec) 130061.1943 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:25,366] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:25,366] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=95475.22701687877
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:26,823] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:26,823] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=95526.63376261573
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00023 | Step 00020 | Loss 0.4757 | Train Acc 0.8693 | Speed (samples/sec) 129968.3328 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:27,923] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:27,923] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=95509.15431548371
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:10.48128949 ms
avg iteration GPU training time:16.05361889 ms
avg iteration (step) total cpu time:132.32118995 ms
Epoch Time(s): 5.9532
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.4886 | Train Acc 0.8700 | Speed (samples/sec) 129456.1992 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:31,120] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:31,120] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=95486.71264424149
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:32,230] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:32,230] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=95502.84844071872
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00024 | Step 00020 | Loss 0.4665 | Train Acc 0.8737 | Speed (samples/sec) 129688.3064 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:33,991] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:33,991] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=95546.11938874364
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:35,112] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:35,112] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=95635.99869622476
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:11.30634423 ms
avg iteration GPU training time:15.26228248 ms
avg iteration (step) total cpu time:128.55961588 ms
Epoch Time(s): 5.7706
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.4699 | Train Acc 0.8733 | Speed (samples/sec) 129747.1557 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:37,916] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:37,916] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=95670.7492111745
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:38,932] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:38,932] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=95743.64570908406
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00025 | Step 00020 | Loss 0.4692 | Train Acc 0.8733 | Speed (samples/sec) 130129.6255 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:40,568] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:40,568] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=95778.7676321019
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:10.05581273 ms
avg iteration GPU training time:15.07611020 ms
avg iteration (step) total cpu time:118.96766557 ms
Epoch Time(s): 5.5546
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.5010 | Train Acc 0.8658 | Speed (samples/sec) 130318.3802 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:43,008] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:43,008] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=95839.93685322918
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:44,543] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:44,543] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=95885.2662442769
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00026 | Step 00020 | Loss 0.4812 | Train Acc 0.8781 | Speed (samples/sec) 130075.9303 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:45,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:45,679] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=95941.75574786475
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

avg iteration(step) data from cpu to GPU time:10.94441006 ms
avg iteration GPU training time:15.39590878 ms
avg iteration (step) total cpu time:119.14383924 ms
Epoch Time(s): 5.4743
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.5200 | Train Acc 0.8657 | Speed (samples/sec) 130126.9930 | GPU 1479.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:49,478] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:49,478] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=95935.75022690602
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

[2021-06-09 07:30:50,633] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:50,634] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=95953.94792794024
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

Epoch 00027 | Step 00020 | Loss 0.4897 | Train Acc 0.8713 | Speed (samples/sec) 130302.3023 | GPU 1479.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4449925422668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:30:51,994] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:51,994] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=95960.92536774301
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:11.13601303 ms
avg iteration GPU training time:15.63085030 ms
avg iteration (step) total cpu time:136.84451139 ms
Epoch Time(s): 6.3598
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.4731 | Train Acc 0.8748 | Speed (samples/sec) 130202.1951 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:30:54,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:54,449] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=95990.51860164259
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:30:56,204] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:56,204] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=95993.10701771393
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00028 | Step 00020 | Loss 0.4987 | Train Acc 0.8676 | Speed (samples/sec) 130316.9405 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:30:57,397] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:30:57,397] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=96037.44311140507
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.81016055 ms
avg iteration GPU training time:15.38495403 ms
avg iteration (step) total cpu time:126.54886422 ms
Epoch Time(s): 5.8090
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.4814 | Train Acc 0.8692 | Speed (samples/sec) 130484.9928 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:00,090] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:00,091] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=96074.58024202225
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:01,125] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:01,126] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=96109.70741010013
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00029 | Step 00020 | Loss 0.4878 | Train Acc 0.8708 | Speed (samples/sec) 130745.9895 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:02,453] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:02,453] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=96167.36225674281
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:03,670] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:03,670] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=96240.96614246297
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86183700 ms
avg iteration GPU training time:15.14464481 ms
avg iteration (step) total cpu time:115.31783916 ms
Epoch Time(s): 5.3982
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.4837 | Train Acc 0.8693 | Speed (samples/sec) 130993.9555 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:06,411] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:06,411] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=96245.75884454444
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:07,406] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:07,407] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=96282.13515352056
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00030 | Step 00020 | Loss 0.4849 | Train Acc 0.8658 | Speed (samples/sec) 131040.9776 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:09,046] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:09,046] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=96338.49779940388
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.58588918 ms
avg iteration GPU training time:15.29897948 ms
avg iteration (step) total cpu time:118.19952506 ms
Epoch Time(s): 5.4343
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.4999 | Train Acc 0.8703 | Speed (samples/sec) 130808.5934 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:11,566] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:11,566] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=96310.13650393304
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:12,962] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:12,962] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=96332.8455920984
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00031 | Step 00020 | Loss 0.4617 | Train Acc 0.8767 | Speed (samples/sec) 130974.6110 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:13,936] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:13,936] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=96381.53658032973
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.44803678 ms
avg iteration GPU training time:15.78822270 ms
avg iteration (step) total cpu time:107.86067998 ms
Epoch Time(s): 5.2365
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.4733 | Train Acc 0.8719 | Speed (samples/sec) 131155.8124 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:16,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:16,687] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=96389.05284543395
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:17,695] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:17,695] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=96417.37074656821
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00032 | Step 00020 | Loss 0.4916 | Train Acc 0.8689 | Speed (samples/sec) 131343.2333 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:19,188] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:19,188] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=96411.68776306525
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17402195 ms
avg iteration GPU training time:15.61931847 ms
avg iteration (step) total cpu time:120.95393958 ms
Epoch Time(s): 5.5486
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.4869 | Train Acc 0.8657 | Speed (samples/sec) 131038.1068 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:21,818] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:21,818] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=96448.91804475304
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:23,290] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:23,291] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=96447.33933150275
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00033 | Step 00020 | Loss 0.4831 | Train Acc 0.8663 | Speed (samples/sec) 131318.0030 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:24,316] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:24,316] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=96487.99446616558
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.78173989 ms
avg iteration GPU training time:15.32284567 ms
avg iteration (step) total cpu time:108.89496627 ms
Epoch Time(s): 5.2540
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.4537 | Train Acc 0.8802 | Speed (samples/sec) 131555.1998 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:26,993] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:26,993] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=96533.03226203323
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:28,075] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:28,075] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=96554.06339925599
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00034 | Step 00020 | Loss 0.4618 | Train Acc 0.8732 | Speed (samples/sec) 131888.7687 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:29,469] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:29,469] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=96587.16023034991
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:30,771] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:30,771] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=96631.61880806867
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.34672947 ms
avg iteration GPU training time:15.18048000 ms
avg iteration (step) total cpu time:121.58745307 ms
Epoch Time(s): 5.6222
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.4958 | Train Acc 0.8701 | Speed (samples/sec) 132078.3900 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:33,720] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:33,721] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=96631.39293486353
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:34,943] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:34,943] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=96687.16236207295
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00035 | Step 00020 | Loss 0.4648 | Train Acc 0.8725 | Speed (samples/sec) 132444.9233 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:36,285] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:36,285] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=96725.69992930174
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17891555 ms
avg iteration GPU training time:15.27965991 ms
avg iteration (step) total cpu time:115.96390053 ms
Epoch Time(s): 5.5591
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4832 | Train Acc 0.8677 | Speed (samples/sec) 132666.5610 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:38,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:38,791] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=96750.57443738401
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:40,157] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:40,158] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=96782.02395505103
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00036 | Step 00020 | Loss 0.4783 | Train Acc 0.8725 | Speed (samples/sec) 132927.1494 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:41,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:41,129] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=96823.30667143947
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61610310 ms
avg iteration GPU training time:14.99817135 ms
avg iteration (step) total cpu time:105.28749890 ms
Epoch Time(s): 5.2043
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.5072 | Train Acc 0.8634 | Speed (samples/sec) 132959.2097 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:43,833] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:43,833] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=96859.4574760886
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:44,856] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:44,856] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=96847.19197963912
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00037 | Step 00020 | Loss 0.5066 | Train Acc 0.8665 | Speed (samples/sec) 132748.0348 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:46,483] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:46,483] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=96877.79796908256
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17446749 ms
avg iteration GPU training time:15.56333747 ms
avg iteration (step) total cpu time:118.95434062 ms
Epoch Time(s): 5.4348
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4662 | Train Acc 0.8740 | Speed (samples/sec) 132559.9928 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:48,956] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:48,956] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=96879.20506744798
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:50,330] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:50,330] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=96885.6615689103
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00038 | Step 00020 | Loss 0.4619 | Train Acc 0.8785 | Speed (samples/sec) 132874.5094 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:51,313] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:51,314] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=96919.30723253137
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.19751936 ms
avg iteration GPU training time:15.29108740 ms
avg iteration (step) total cpu time:108.77632212 ms
Epoch Time(s): 5.3221
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.4912 | Train Acc 0.8669 | Speed (samples/sec) 133029.3106 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:54,126] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:54,126] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=96944.43417527225
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:55,173] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:55,173] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=96949.47570808968
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00039 | Step 00020 | Loss 0.4779 | Train Acc 0.8761 | Speed (samples/sec) 133022.9816 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:56,667] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:56,667] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=96933.82664778999
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:31:57,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:31:57,880] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=96950.18464409099
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.08583113 ms
avg iteration GPU training time:15.82303768 ms
avg iteration (step) total cpu time:121.41460843 ms
Epoch Time(s): 5.5553
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4766 | Train Acc 0.8746 | Speed (samples/sec) 132836.6784 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:00,698] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:00,698] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=96859.75654448596
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:01,728] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:01,728] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=96869.76380581663
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00040 | Step 00020 | Loss 0.4979 | Train Acc 0.8682 | Speed (samples/sec) 132916.5600 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:02,970] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:02,970] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=96895.24098033409
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.07289242 ms
avg iteration GPU training time:15.41915738 ms
avg iteration (step) total cpu time:104.90033362 ms
Epoch Time(s): 5.1322
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4709 | Train Acc 0.8725 | Speed (samples/sec) 133017.0141 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:05,405] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:05,405] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=96916.0401036339
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:06,751] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:06,752] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=96940.38462147598
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00041 | Step 00020 | Loss 0.5022 | Train Acc 0.8642 | Speed (samples/sec) 133154.1975 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:08,013] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:08,014] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=96952.52938336162
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70751953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.27418557 ms
avg iteration GPU training time:15.42841954 ms
avg iteration (step) total cpu time:120.23493096 ms
Epoch Time(s): 5.5382
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4540 | Train Acc 0.8796 | Speed (samples/sec) 133147.8716 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:11,812] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:11,812] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=96973.82579520924
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:13,097] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:13,097] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=96876.1996197791
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00042 | Step 00020 | Loss 0.4403 | Train Acc 0.8780 | Speed (samples/sec) 133201.2413 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:14,492] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:14,492] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=96894.52508350805
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.55559346 ms
avg iteration GPU training time:16.20347744 ms
avg iteration (step) total cpu time:142.13863126 ms
Epoch Time(s): 6.4160
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4664 | Train Acc 0.8748 | Speed (samples/sec) 133215.6124 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:16,782] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:16,782] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=96931.24119195815
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:18,168] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:18,168] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=96937.02986732172
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00043 | Step 00020 | Loss 0.4765 | Train Acc 0.8685 | Speed (samples/sec) 133079.7593 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:19,274] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:19,274] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=96922.19041005308
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.80888648 ms
avg iteration GPU training time:16.02590451 ms
avg iteration (step) total cpu time:134.17984821 ms
Epoch Time(s): 5.8202
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4598 | Train Acc 0.8738 | Speed (samples/sec) 132609.8920 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:22,606] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:22,606] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=96876.43999532808
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:23,757] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:23,757] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=96892.26648109473
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00044 | Step 00020 | Loss 0.4653 | Train Acc 0.8783 | Speed (samples/sec) 132716.5530 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:25,501] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:25,501] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=96924.936494213
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:26,507] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:26,508] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=96939.42527869198
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.77958994 ms
avg iteration GPU training time:15.38795980 ms
avg iteration (step) total cpu time:123.98460176 ms
Epoch Time(s): 5.7578
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4653 | Train Acc 0.8700 | Speed (samples/sec) 132754.9308 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:29,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:29,364] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=96938.50620141151
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:30,373] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:30,374] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=96940.17724469402
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00045 | Step 00020 | Loss 0.4841 | Train Acc 0.8709 | Speed (samples/sec) 132753.2606 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:32,085] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:32,085] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=96948.99864393171
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.61981164 ms
avg iteration GPU training time:15.58962720 ms
avg iteration (step) total cpu time:122.24826106 ms
Epoch Time(s): 5.6045
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4806 | Train Acc 0.8701 | Speed (samples/sec) 132506.3322 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:34,500] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:34,500] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=96935.84086862314
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:36,131] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:36,131] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=96938.82202713071
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00046 | Step 00020 | Loss 0.4877 | Train Acc 0.8743 | Speed (samples/sec) 132525.6975 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:37,443] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:37,444] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=96935.66240967902
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.39665296 ms
avg iteration GPU training time:15.77702748 ms
avg iteration (step) total cpu time:130.49532749 ms
Epoch Time(s): 5.7776
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4891 | Train Acc 0.8751 | Speed (samples/sec) 132444.4560 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:40,279] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:40,279] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=96899.5677137403
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:41,358] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:41,358] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=96930.67574587079
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00047 | Step 00020 | Loss 0.5001 | Train Acc 0.8697 | Speed (samples/sec) 132662.8774 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:42,886] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:42,886] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=96966.52393439952
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.35961843 ms
avg iteration GPU training time:15.05243372 ms
avg iteration (step) total cpu time:124.82929230 ms
Epoch Time(s): 5.6910
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4872 | Train Acc 0.8706 | Speed (samples/sec) 132820.4252 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:45,473] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:45,473] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=97002.97441082798
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:46,887] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:46,887] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=97029.62335534164
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00048 | Step 00020 | Loss 0.4648 | Train Acc 0.8714 | Speed (samples/sec) 132951.8503 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:48,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:48,155] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=97022.01854358912
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.15604620 ms
avg iteration GPU training time:15.50401659 ms
avg iteration (step) total cpu time:125.95151972 ms
Epoch Time(s): 5.6701
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4523 | Train Acc 0.8791 | Speed (samples/sec) 132929.1804 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:51,075] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:51,076] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=97029.03393044775
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:52,141] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:52,141] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=97020.64186020057
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00049 | Step 00020 | Loss 0.4901 | Train Acc 0.8701 | Speed (samples/sec) 132958.9686 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:53,885] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:53,885] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=96964.661304589
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:54,864] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:54,864] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=96949.43330934158
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.72497423 ms
avg iteration GPU training time:16.58505369 ms
avg iteration (step) total cpu time:122.55222709 ms
Epoch Time(s): 5.6165
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4794 | Train Acc 0.8716 | Speed (samples/sec) 133125.1169 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:57,724] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:57,724] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=96959.91447843437
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:32:58,856] [INFO] [logging.py:60:log_dist] [Rank 0] step=1620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:32:58,856] [INFO] [timer.py:160:stop] 0/1620, SamplesPerSec=96982.53429923579
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

Epoch 00050 | Step 00020 | Loss 0.5042 | Train Acc 0.8682 | Speed (samples/sec) 133276.5859 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

[2021-06-09 07:33:00,243] [INFO] [logging.py:60:log_dist] [Rank 0] step=1630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:00,243] [INFO] [timer.py:160:stop] 0/1630, SamplesPerSec=96996.63722262357
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452977180480957  GigaBytes

avg iteration(step) data from cpu to GPU time:9.46884136 ms
avg iteration GPU training time:15.19885399 ms
avg iteration (step) total cpu time:121.13185282 ms
Epoch Time(s): 5.6092
Eval Acc 0.8807
Test Acc: 0.6962
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.5070 | Train Acc 0.8695 | Speed (samples/sec) 133171.4947 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:38,268] [INFO] [logging.py:60:log_dist] [Rank 0] step=1640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:38,268] [INFO] [timer.py:160:stop] 0/1640, SamplesPerSec=97022.79324678976
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:39,741] [INFO] [logging.py:60:log_dist] [Rank 0] step=1650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:39,741] [INFO] [timer.py:160:stop] 0/1650, SamplesPerSec=97045.53003277068
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00051 | Step 00020 | Loss 0.4777 | Train Acc 0.8714 | Speed (samples/sec) 133304.4409 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:40,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=1660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:40,679] [INFO] [timer.py:160:stop] 0/1660, SamplesPerSec=97026.22590457834
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.34858903 ms
avg iteration GPU training time:15.62859973 ms
avg iteration (step) total cpu time:108.75216237 ms
Epoch Time(s): 5.2177
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.5033 | Train Acc 0.8650 | Speed (samples/sec) 133187.7703 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:43,439] [INFO] [logging.py:60:log_dist] [Rank 0] step=1670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:43,440] [INFO] [timer.py:160:stop] 0/1670, SamplesPerSec=97014.0373737265
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:44,559] [INFO] [logging.py:60:log_dist] [Rank 0] step=1680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:44,559] [INFO] [timer.py:160:stop] 0/1680, SamplesPerSec=97028.48899128447
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00052 | Step 00020 | Loss 0.5007 | Train Acc 0.8703 | Speed (samples/sec) 133133.8028 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:46,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=1690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:46,032] [INFO] [timer.py:160:stop] 0/1690, SamplesPerSec=97015.323063439
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.38932735 ms
avg iteration GPU training time:15.71718283 ms
avg iteration (step) total cpu time:124.51056198 ms
Epoch Time(s): 5.6764
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4774 | Train Acc 0.8693 | Speed (samples/sec) 132768.7887 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:48,826] [INFO] [logging.py:60:log_dist] [Rank 0] step=1700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:48,826] [INFO] [timer.py:160:stop] 0/1700, SamplesPerSec=97021.19573494775
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:51,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=1710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:51,036] [INFO] [timer.py:160:stop] 0/1710, SamplesPerSec=97019.11709120516
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00053 | Step 00020 | Loss 0.5089 | Train Acc 0.8677 | Speed (samples/sec) 132464.1878 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:52,744] [INFO] [logging.py:60:log_dist] [Rank 0] step=1720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:52,744] [INFO] [timer.py:160:stop] 0/1720, SamplesPerSec=96997.53794537569
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.93968467 ms
avg iteration GPU training time:15.75188163 ms
avg iteration (step) total cpu time:179.67340681 ms
Epoch Time(s): 7.1882
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4658 | Train Acc 0.8711 | Speed (samples/sec) 132262.0747 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:55,966] [INFO] [logging.py:60:log_dist] [Rank 0] step=1730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:55,967] [INFO] [timer.py:160:stop] 0/1730, SamplesPerSec=97019.9230015114
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:57,612] [INFO] [logging.py:60:log_dist] [Rank 0] step=1740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:57,612] [INFO] [timer.py:160:stop] 0/1740, SamplesPerSec=96989.55230124024
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00054 | Step 00020 | Loss 0.4835 | Train Acc 0.8695 | Speed (samples/sec) 132004.9876 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:58,652] [INFO] [logging.py:60:log_dist] [Rank 0] step=1750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:58,653] [INFO] [timer.py:160:stop] 0/1750, SamplesPerSec=97002.61957739854
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:33:59,664] [INFO] [logging.py:60:log_dist] [Rank 0] step=1760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:33:59,665] [INFO] [timer.py:160:stop] 0/1760, SamplesPerSec=97046.53610377938
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.83090613 ms
avg iteration GPU training time:15.68224720 ms
avg iteration (step) total cpu time:120.25318322 ms
Epoch Time(s): 5.6889
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4688 | Train Acc 0.8759 | Speed (samples/sec) 132044.4094 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:02,663] [INFO] [logging.py:60:log_dist] [Rank 0] step=1770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:02,663] [INFO] [timer.py:160:stop] 0/1770, SamplesPerSec=97060.65398320001
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:03,755] [INFO] [logging.py:60:log_dist] [Rank 0] step=1780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:03,755] [INFO] [timer.py:160:stop] 0/1780, SamplesPerSec=97048.83495421064
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00055 | Step 00020 | Loss 0.4592 | Train Acc 0.8770 | Speed (samples/sec) 131634.7546 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:05,668] [INFO] [logging.py:60:log_dist] [Rank 0] step=1790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:05,669] [INFO] [timer.py:160:stop] 0/1790, SamplesPerSec=97051.95330206958
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.74635377 ms
avg iteration GPU training time:15.98178373 ms
avg iteration (step) total cpu time:144.93136936 ms
Epoch Time(s): 6.1748
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4629 | Train Acc 0.8759 | Speed (samples/sec) 131164.3541 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:08,263] [INFO] [logging.py:60:log_dist] [Rank 0] step=1800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:08,263] [INFO] [timer.py:160:stop] 0/1800, SamplesPerSec=97060.28769921736
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:09,921] [INFO] [logging.py:60:log_dist] [Rank 0] step=1810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:09,922] [INFO] [timer.py:160:stop] 0/1810, SamplesPerSec=97048.39528933054
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00056 | Step 00020 | Loss 0.4954 | Train Acc 0.8676 | Speed (samples/sec) 131274.2587 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:10,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=1820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:10,884] [INFO] [timer.py:160:stop] 0/1820, SamplesPerSec=97072.73425101544
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.58019205 ms
avg iteration GPU training time:15.34970548 ms
avg iteration (step) total cpu time:117.04978236 ms
Epoch Time(s): 5.5236
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.4751 | Train Acc 0.8692 | Speed (samples/sec) 131431.2637 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:13,655] [INFO] [logging.py:60:log_dist] [Rank 0] step=1830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:13,656] [INFO] [timer.py:160:stop] 0/1830, SamplesPerSec=97075.38222585629
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:14,781] [INFO] [logging.py:60:log_dist] [Rank 0] step=1840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:14,781] [INFO] [timer.py:160:stop] 0/1840, SamplesPerSec=97074.19247935791
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00057 | Step 00020 | Loss 0.4684 | Train Acc 0.8753 | Speed (samples/sec) 131450.6701 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:16,265] [INFO] [logging.py:60:log_dist] [Rank 0] step=1850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:16,266] [INFO] [timer.py:160:stop] 0/1850, SamplesPerSec=97076.70995972013
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.99541214 ms
avg iteration GPU training time:15.89440597 ms
avg iteration (step) total cpu time:121.06680870 ms
Epoch Time(s): 5.5696
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.4710 | Train Acc 0.8785 | Speed (samples/sec) 131450.4820 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:18,813] [INFO] [logging.py:60:log_dist] [Rank 0] step=1860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:18,813] [INFO] [timer.py:160:stop] 0/1860, SamplesPerSec=97075.65482783606
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:20,317] [INFO] [logging.py:60:log_dist] [Rank 0] step=1870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:20,317] [INFO] [timer.py:160:stop] 0/1870, SamplesPerSec=97079.09185842119
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00058 | Step 00020 | Loss 0.4973 | Train Acc 0.8709 | Speed (samples/sec) 131608.9992 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:21,603] [INFO] [logging.py:60:log_dist] [Rank 0] step=1880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:21,603] [INFO] [timer.py:160:stop] 0/1880, SamplesPerSec=97094.05963570843
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.33787378 ms
avg iteration GPU training time:15.25361178 ms
avg iteration (step) total cpu time:125.19966231 ms
Epoch Time(s): 5.6544
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4597 | Train Acc 0.8733 | Speed (samples/sec) 131597.1993 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:24,529] [INFO] [logging.py:60:log_dist] [Rank 0] step=1890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:24,529] [INFO] [timer.py:160:stop] 0/1890, SamplesPerSec=97108.58839062125
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:25,586] [INFO] [logging.py:60:log_dist] [Rank 0] step=1900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:25,586] [INFO] [timer.py:160:stop] 0/1900, SamplesPerSec=97125.86356282955
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00059 | Step 00020 | Loss 0.5035 | Train Acc 0.8697 | Speed (samples/sec) 131651.4189 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:26,954] [INFO] [logging.py:60:log_dist] [Rank 0] step=1910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:26,955] [INFO] [timer.py:160:stop] 0/1910, SamplesPerSec=97138.48376885758
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:27,974] [INFO] [logging.py:60:log_dist] [Rank 0] step=1920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:27,974] [INFO] [timer.py:160:stop] 0/1920, SamplesPerSec=97171.94509806139
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61984354 ms
avg iteration GPU training time:15.16789108 ms
avg iteration (step) total cpu time:109.90402434 ms
Epoch Time(s): 5.3916
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.4554 | Train Acc 0.8796 | Speed (samples/sec) 131663.6192 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:30,895] [INFO] [logging.py:60:log_dist] [Rank 0] step=1930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:30,895] [INFO] [timer.py:160:stop] 0/1930, SamplesPerSec=97180.76404424096
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:31,952] [INFO] [logging.py:60:log_dist] [Rank 0] step=1940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:31,952] [INFO] [timer.py:160:stop] 0/1940, SamplesPerSec=97197.16136919982
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00060 | Step 00020 | Loss 0.4760 | Train Acc 0.8701 | Speed (samples/sec) 131834.4759 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:33,612] [INFO] [logging.py:60:log_dist] [Rank 0] step=1950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:33,612] [INFO] [timer.py:160:stop] 0/1950, SamplesPerSec=97190.53797991271
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.23025068 ms
avg iteration GPU training time:15.37979730 ms
avg iteration (step) total cpu time:121.58823013 ms
Epoch Time(s): 5.7157
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4544 | Train Acc 0.8749 | Speed (samples/sec) 131923.0824 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:36,192] [INFO] [logging.py:60:log_dist] [Rank 0] step=1960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:36,192] [INFO] [timer.py:160:stop] 0/1960, SamplesPerSec=97201.92416188303
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:37,760] [INFO] [logging.py:60:log_dist] [Rank 0] step=1970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:37,760] [INFO] [timer.py:160:stop] 0/1970, SamplesPerSec=97225.34916038915
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00061 | Step 00020 | Loss 0.5123 | Train Acc 0.8652 | Speed (samples/sec) 131981.1530 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:38,839] [INFO] [logging.py:60:log_dist] [Rank 0] step=1980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:38,839] [INFO] [timer.py:160:stop] 0/1980, SamplesPerSec=97164.90588636626
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.99320770 ms
avg iteration GPU training time:15.91425542 ms
avg iteration (step) total cpu time:117.10046839 ms
Epoch Time(s): 5.6032
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.4966 | Train Acc 0.8689 | Speed (samples/sec) 132087.6713 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:41,691] [INFO] [logging.py:60:log_dist] [Rank 0] step=1990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:41,691] [INFO] [timer.py:160:stop] 0/1990, SamplesPerSec=97186.60459113978
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:42,711] [INFO] [logging.py:60:log_dist] [Rank 0] step=2000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:42,711] [INFO] [timer.py:160:stop] 0/2000, SamplesPerSec=97186.89038374272
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00062 | Step 00020 | Loss 0.4883 | Train Acc 0.8693 | Speed (samples/sec) 132134.0427 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:44,333] [INFO] [logging.py:60:log_dist] [Rank 0] step=2010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:44,333] [INFO] [timer.py:160:stop] 0/2010, SamplesPerSec=97187.06791178699
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65582579 ms
avg iteration GPU training time:15.79433247 ms
avg iteration (step) total cpu time:121.05533812 ms
Epoch Time(s): 5.6676
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.4831 | Train Acc 0.8716 | Speed (samples/sec) 132041.9922 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:47,548] [INFO] [logging.py:60:log_dist] [Rank 0] step=2020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:47,548] [INFO] [timer.py:160:stop] 0/2020, SamplesPerSec=97162.00712563016
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:49,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=2030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:49,837] [INFO] [timer.py:160:stop] 0/2030, SamplesPerSec=97153.85574986308
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00063 | Step 00020 | Loss 0.4836 | Train Acc 0.8721 | Speed (samples/sec) 131807.0448 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:51,119] [INFO] [logging.py:60:log_dist] [Rank 0] step=2040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:51,119] [INFO] [timer.py:160:stop] 0/2040, SamplesPerSec=97120.43332692706
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:11.78867077 ms
avg iteration GPU training time:16.07692920 ms
avg iteration (step) total cpu time:164.84091900 ms
Epoch Time(s): 7.1159
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.4954 | Train Acc 0.8727 | Speed (samples/sec) 131749.0135 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:54,324] [INFO] [logging.py:60:log_dist] [Rank 0] step=2050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:54,325] [INFO] [timer.py:160:stop] 0/2050, SamplesPerSec=97128.69843515166
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:55,669] [INFO] [logging.py:60:log_dist] [Rank 0] step=2060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:55,669] [INFO] [timer.py:160:stop] 0/2060, SamplesPerSec=97095.94894030507
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00064 | Step 00020 | Loss 0.4790 | Train Acc 0.8698 | Speed (samples/sec) 131280.4792 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:56,832] [INFO] [logging.py:60:log_dist] [Rank 0] step=2070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:56,832] [INFO] [timer.py:160:stop] 0/2070, SamplesPerSec=97096.12485242181
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:34:58,083] [INFO] [logging.py:60:log_dist] [Rank 0] step=2080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:34:58,083] [INFO] [timer.py:160:stop] 0/2080, SamplesPerSec=97122.25774289451
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86755675 ms
avg iteration GPU training time:15.47258794 ms
avg iteration (step) total cpu time:131.30605662 ms
Epoch Time(s): 6.0416
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.4698 | Train Acc 0.8737 | Speed (samples/sec) 131079.0508 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:01,196] [INFO] [logging.py:60:log_dist] [Rank 0] step=2090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:01,196] [INFO] [timer.py:160:stop] 0/2090, SamplesPerSec=97125.93951255002
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:02,367] [INFO] [logging.py:60:log_dist] [Rank 0] step=2100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:02,367] [INFO] [timer.py:160:stop] 0/2100, SamplesPerSec=97098.74962141014
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00065 | Step 00020 | Loss 0.5050 | Train Acc 0.8677 | Speed (samples/sec) 130801.6931 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:04,369] [INFO] [logging.py:60:log_dist] [Rank 0] step=2110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:04,369] [INFO] [timer.py:160:stop] 0/2110, SamplesPerSec=97066.22077920985
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.62627079 ms
avg iteration GPU training time:16.32029272 ms
avg iteration (step) total cpu time:146.17974670 ms
Epoch Time(s): 6.3054
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.4907 | Train Acc 0.8705 | Speed (samples/sec) 130734.8820 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:06,972] [INFO] [logging.py:60:log_dist] [Rank 0] step=2120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:06,972] [INFO] [timer.py:160:stop] 0/2120, SamplesPerSec=97059.5756885182
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:08,549] [INFO] [logging.py:60:log_dist] [Rank 0] step=2130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:08,549] [INFO] [timer.py:160:stop] 0/2130, SamplesPerSec=97021.01617175112
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00066 | Step 00020 | Loss 0.5006 | Train Acc 0.8673 | Speed (samples/sec) 130887.4006 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:09,513] [INFO] [logging.py:60:log_dist] [Rank 0] step=2140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:09,514] [INFO] [timer.py:160:stop] 0/2140, SamplesPerSec=97008.28516562463
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.64496010 ms
avg iteration GPU training time:16.23515387 ms
avg iteration (step) total cpu time:113.00657414 ms
Epoch Time(s): 5.4866
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.4556 | Train Acc 0.8767 | Speed (samples/sec) 130962.8463 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:12,357] [INFO] [logging.py:60:log_dist] [Rank 0] step=2150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:12,358] [INFO] [timer.py:160:stop] 0/2150, SamplesPerSec=97031.3765225935
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:13,380] [INFO] [logging.py:60:log_dist] [Rank 0] step=2160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:13,380] [INFO] [timer.py:160:stop] 0/2160, SamplesPerSec=97053.55983258961
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00067 | Step 00020 | Loss 0.5091 | Train Acc 0.8689 | Speed (samples/sec) 131093.7852 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:15,045] [INFO] [logging.py:60:log_dist] [Rank 0] step=2170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:15,045] [INFO] [timer.py:160:stop] 0/2170, SamplesPerSec=97052.29455472787
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.32832121 ms
avg iteration GPU training time:24.09559479 ms
avg iteration (step) total cpu time:121.91986155 ms
Epoch Time(s): 5.7311
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.4887 | Train Acc 0.8743 | Speed (samples/sec) 130928.4901 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:17,503] [INFO] [logging.py:60:log_dist] [Rank 0] step=2180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:17,503] [INFO] [timer.py:160:stop] 0/2180, SamplesPerSec=97078.71413425983
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:18,973] [INFO] [logging.py:60:log_dist] [Rank 0] step=2190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:18,974] [INFO] [timer.py:160:stop] 0/2190, SamplesPerSec=97101.49459719079
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00068 | Step 00020 | Loss 0.4762 | Train Acc 0.8711 | Speed (samples/sec) 131064.3997 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:20,233] [INFO] [logging.py:60:log_dist] [Rank 0] step=2200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:20,233] [INFO] [timer.py:160:stop] 0/2200, SamplesPerSec=97111.30620828441
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.58484033 ms
avg iteration GPU training time:15.63368419 ms
avg iteration (step) total cpu time:120.64375701 ms
Epoch Time(s): 5.5638
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.4818 | Train Acc 0.8714 | Speed (samples/sec) 131159.5892 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:23,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=2210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:23,032] [INFO] [timer.py:160:stop] 0/2210, SamplesPerSec=97078.8283909398
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:24,082] [INFO] [logging.py:60:log_dist] [Rank 0] step=2220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:24,082] [INFO] [timer.py:160:stop] 0/2220, SamplesPerSec=97092.49966296337
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00069 | Step 00020 | Loss 0.4721 | Train Acc 0.8769 | Speed (samples/sec) 131270.0045 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:25,424] [INFO] [logging.py:60:log_dist] [Rank 0] step=2230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:25,424] [INFO] [timer.py:160:stop] 0/2230, SamplesPerSec=97112.48352128745
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:26,336] [INFO] [logging.py:60:log_dist] [Rank 0] step=2240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:26,336] [INFO] [timer.py:160:stop] 0/2240, SamplesPerSec=97128.57082970916
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.81374098 ms
avg iteration GPU training time:15.18323188 ms
avg iteration (step) total cpu time:104.57556336 ms
Epoch Time(s): 5.1352
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.5017 | Train Acc 0.8652 | Speed (samples/sec) 131347.6370 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:29,290] [INFO] [logging.py:60:log_dist] [Rank 0] step=2250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:29,290] [INFO] [timer.py:160:stop] 0/2250, SamplesPerSec=97107.64131059621
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:30,297] [INFO] [logging.py:60:log_dist] [Rank 0] step=2260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:30,297] [INFO] [timer.py:160:stop] 0/2260, SamplesPerSec=97107.19574316341
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00070 | Step 00020 | Loss 0.4908 | Train Acc 0.8693 | Speed (samples/sec) 131425.6975 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:32,111] [INFO] [logging.py:60:log_dist] [Rank 0] step=2270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:32,111] [INFO] [timer.py:160:stop] 0/2270, SamplesPerSec=97109.68904442506
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.86117932 ms
avg iteration GPU training time:15.63030042 ms
avg iteration (step) total cpu time:125.23892191 ms
Epoch Time(s): 5.8769
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.4661 | Train Acc 0.8770 | Speed (samples/sec) 131471.9619 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:34,670] [INFO] [logging.py:60:log_dist] [Rank 0] step=2280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:34,670] [INFO] [timer.py:160:stop] 0/2280, SamplesPerSec=97093.80384065544
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:36,088] [INFO] [logging.py:60:log_dist] [Rank 0] step=2290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:36,088] [INFO] [timer.py:160:stop] 0/2290, SamplesPerSec=97093.17323057921
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00071 | Step 00020 | Loss 0.4730 | Train Acc 0.8735 | Speed (samples/sec) 131545.3076 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:37,052] [INFO] [logging.py:60:log_dist] [Rank 0] step=2300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:37,052] [INFO] [timer.py:160:stop] 0/2300, SamplesPerSec=97105.39685381076
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.68988802 ms
avg iteration GPU training time:15.84325928 ms
avg iteration (step) total cpu time:107.85426917 ms
Epoch Time(s): 5.2919
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.4945 | Train Acc 0.8708 | Speed (samples/sec) 131637.4991 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:39,833] [INFO] [logging.py:60:log_dist] [Rank 0] step=2310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:39,833] [INFO] [timer.py:160:stop] 0/2310, SamplesPerSec=97130.20223246118
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:40,854] [INFO] [logging.py:60:log_dist] [Rank 0] step=2320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:40,854] [INFO] [timer.py:160:stop] 0/2320, SamplesPerSec=97152.96344819352
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00072 | Step 00020 | Loss 0.4807 | Train Acc 0.8706 | Speed (samples/sec) 131721.0015 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:42,490] [INFO] [logging.py:60:log_dist] [Rank 0] step=2330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:42,490] [INFO] [timer.py:160:stop] 0/2330, SamplesPerSec=97156.23374193827
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70751953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86437571 ms
avg iteration GPU training time:15.18564154 ms
avg iteration (step) total cpu time:121.39380420 ms
Epoch Time(s): 5.6075
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.4699 | Train Acc 0.8746 | Speed (samples/sec) 131718.2102 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:45,527] [INFO] [logging.py:60:log_dist] [Rank 0] step=2340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:45,527] [INFO] [timer.py:160:stop] 0/2340, SamplesPerSec=97161.24051635976
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:47,525] [INFO] [logging.py:60:log_dist] [Rank 0] step=2350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:47,525] [INFO] [timer.py:160:stop] 0/2350, SamplesPerSec=97175.51863793517
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00073 | Step 00020 | Loss 0.4689 | Train Acc 0.8764 | Speed (samples/sec) 131688.8435 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:48,535] [INFO] [logging.py:60:log_dist] [Rank 0] step=2360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:48,535] [INFO] [timer.py:160:stop] 0/2360, SamplesPerSec=97127.89785564314
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:12.21193953 ms
avg iteration GPU training time:16.20710037 ms
avg iteration (step) total cpu time:141.14445227 ms
Epoch Time(s): 6.2848
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.4658 | Train Acc 0.8719 | Speed (samples/sec) 131633.7556 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:51,468] [INFO] [logging.py:60:log_dist] [Rank 0] step=2370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:51,469] [INFO] [timer.py:160:stop] 0/2370, SamplesPerSec=97125.6586051735
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:52,793] [INFO] [logging.py:60:log_dist] [Rank 0] step=2380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:52,793] [INFO] [timer.py:160:stop] 0/2380, SamplesPerSec=97131.64872408306
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00074 | Step 00020 | Loss 0.4904 | Train Acc 0.8695 | Speed (samples/sec) 131725.6006 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:54,723] [INFO] [logging.py:60:log_dist] [Rank 0] step=2390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:54,724] [INFO] [timer.py:160:stop] 0/2390, SamplesPerSec=97109.9815882695
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:56,034] [INFO] [logging.py:60:log_dist] [Rank 0] step=2400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:56,034] [INFO] [timer.py:160:stop] 0/2400, SamplesPerSec=97122.32896578347
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.56804747 ms
avg iteration GPU training time:15.90704713 ms
avg iteration (step) total cpu time:145.06435394 ms
Epoch Time(s): 6.6763
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.4748 | Train Acc 0.8705 | Speed (samples/sec) 131780.5777 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:35:58,789] [INFO] [logging.py:60:log_dist] [Rank 0] step=2410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:35:58,790] [INFO] [timer.py:160:stop] 0/2410, SamplesPerSec=97129.87133535848
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:00,180] [INFO] [logging.py:60:log_dist] [Rank 0] step=2420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:00,180] [INFO] [timer.py:160:stop] 0/2420, SamplesPerSec=97122.77140522019
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00075 | Step 00020 | Loss 0.4651 | Train Acc 0.8778 | Speed (samples/sec) 131704.8244 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:01,781] [INFO] [logging.py:60:log_dist] [Rank 0] step=2430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:01,781] [INFO] [timer.py:160:stop] 0/2430, SamplesPerSec=97133.00138523206
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.28671749 ms
avg iteration GPU training time:15.60061748 ms
avg iteration (step) total cpu time:133.43103727 ms
Epoch Time(s): 5.8134
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.4763 | Train Acc 0.8652 | Speed (samples/sec) 131604.6907 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:04,384] [INFO] [logging.py:60:log_dist] [Rank 0] step=2440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:04,384] [INFO] [timer.py:160:stop] 0/2440, SamplesPerSec=97156.94382084647
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:05,762] [INFO] [logging.py:60:log_dist] [Rank 0] step=2450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:05,763] [INFO] [timer.py:160:stop] 0/2450, SamplesPerSec=97179.28217490755
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00076 | Step 00020 | Loss 0.4852 | Train Acc 0.8732 | Speed (samples/sec) 131775.5851 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:06,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=2460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:06,705] [INFO] [timer.py:160:stop] 0/2460, SamplesPerSec=97204.15920992002
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75964453 ms
avg iteration GPU training time:14.78424892 ms
avg iteration (step) total cpu time:105.48036187 ms
Epoch Time(s): 5.2307
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.4792 | Train Acc 0.8692 | Speed (samples/sec) 131889.2163 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:09,428] [INFO] [logging.py:60:log_dist] [Rank 0] step=2470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:09,429] [INFO] [timer.py:160:stop] 0/2470, SamplesPerSec=97213.47799757551
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:10,443] [INFO] [logging.py:60:log_dist] [Rank 0] step=2480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:10,443] [INFO] [timer.py:160:stop] 0/2480, SamplesPerSec=97202.42098199358
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00077 | Step 00020 | Loss 0.5011 | Train Acc 0.8673 | Speed (samples/sec) 131960.7749 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:11,964] [INFO] [logging.py:60:log_dist] [Rank 0] step=2490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:11,964] [INFO] [timer.py:160:stop] 0/2490, SamplesPerSec=97206.22143463799
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.63844619 ms
avg iteration GPU training time:15.75563614 ms
avg iteration (step) total cpu time:118.62868733 ms
Epoch Time(s): 5.4770
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.4926 | Train Acc 0.8708 | Speed (samples/sec) 131994.9128 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:14,464] [INFO] [logging.py:60:log_dist] [Rank 0] step=2500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:14,464] [INFO] [timer.py:160:stop] 0/2500, SamplesPerSec=97221.52510894512
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:15,885] [INFO] [logging.py:60:log_dist] [Rank 0] step=2510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:15,885] [INFO] [timer.py:160:stop] 0/2510, SamplesPerSec=97229.30219268955
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00078 | Step 00020 | Loss 0.4670 | Train Acc 0.8796 | Speed (samples/sec) 131998.1865 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:17,082] [INFO] [logging.py:60:log_dist] [Rank 0] step=2520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:17,082] [INFO] [timer.py:160:stop] 0/2520, SamplesPerSec=97190.96944252744
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.42025248 ms
avg iteration GPU training time:16.01012498 ms
avg iteration (step) total cpu time:115.63498886 ms
Epoch Time(s): 5.3528
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.4762 | Train Acc 0.8668 | Speed (samples/sec) 132097.9490 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:19,744] [INFO] [logging.py:60:log_dist] [Rank 0] step=2530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:19,745] [INFO] [timer.py:160:stop] 0/2530, SamplesPerSec=97201.56321872686
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:20,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=2540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:20,790] [INFO] [timer.py:160:stop] 0/2540, SamplesPerSec=97222.91934798595
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00079 | Step 00020 | Loss 0.4610 | Train Acc 0.8753 | Speed (samples/sec) 132184.6739 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:22,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=2550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:22,129] [INFO] [timer.py:160:stop] 0/2550, SamplesPerSec=97234.66966267889
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:23,386] [INFO] [logging.py:60:log_dist] [Rank 0] step=2560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:23,386] [INFO] [timer.py:160:stop] 0/2560, SamplesPerSec=97259.7169205242
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.58672239 ms
avg iteration GPU training time:15.02845037 ms
avg iteration (step) total cpu time:117.32064353 ms
Epoch Time(s): 5.4298
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.4624 | Train Acc 0.8695 | Speed (samples/sec) 132153.4304 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:26,200] [INFO] [logging.py:60:log_dist] [Rank 0] step=2570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:26,200] [INFO] [timer.py:160:stop] 0/2570, SamplesPerSec=97275.0947502106
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:27,407] [INFO] [logging.py:60:log_dist] [Rank 0] step=2580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:27,408] [INFO] [timer.py:160:stop] 0/2580, SamplesPerSec=97287.29143411337
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00080 | Step 00020 | Loss 0.4716 | Train Acc 0.8730 | Speed (samples/sec) 132298.9226 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:28,955] [INFO] [logging.py:60:log_dist] [Rank 0] step=2590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:28,955] [INFO] [timer.py:160:stop] 0/2590, SamplesPerSec=97297.73108897258
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.32494573 ms
avg iteration GPU training time:15.15948324 ms
avg iteration (step) total cpu time:123.09643957 ms
Epoch Time(s): 5.6224
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.4778 | Train Acc 0.8733 | Speed (samples/sec) 132350.6125 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:31,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=2600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:31,434] [INFO] [timer.py:160:stop] 0/2600, SamplesPerSec=97303.92756405647
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:32,864] [INFO] [logging.py:60:log_dist] [Rank 0] step=2610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:32,864] [INFO] [timer.py:160:stop] 0/2610, SamplesPerSec=97321.93426887467
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00081 | Step 00020 | Loss 0.4993 | Train Acc 0.8695 | Speed (samples/sec) 132517.9799 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:33,845] [INFO] [logging.py:60:log_dist] [Rank 0] step=2620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:33,845] [INFO] [timer.py:160:stop] 0/2620, SamplesPerSec=97342.42805706065
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:8.92798457 ms
avg iteration GPU training time:14.84307794 ms
avg iteration (step) total cpu time:110.62922301 ms
Epoch Time(s): 5.3565
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.4957 | Train Acc 0.8650 | Speed (samples/sec) 132584.1516 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:36,682] [INFO] [logging.py:60:log_dist] [Rank 0] step=2630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:36,683] [INFO] [timer.py:160:stop] 0/2630, SamplesPerSec=97348.70104593846
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:37,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=2640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:37,687] [INFO] [timer.py:160:stop] 0/2640, SamplesPerSec=97350.41088646324
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00082 | Step 00020 | Loss 0.4916 | Train Acc 0.8713 | Speed (samples/sec) 132628.4525 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:39,313] [INFO] [logging.py:60:log_dist] [Rank 0] step=2650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:39,313] [INFO] [timer.py:160:stop] 0/2650, SamplesPerSec=97342.97647900812
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.97169065 ms
avg iteration GPU training time:15.82770365 ms
avg iteration (step) total cpu time:120.97523831 ms
Epoch Time(s): 5.5622
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.4775 | Train Acc 0.8716 | Speed (samples/sec) 132578.4806 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:41,826] [INFO] [logging.py:60:log_dist] [Rank 0] step=2660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:41,826] [INFO] [timer.py:160:stop] 0/2660, SamplesPerSec=97325.92457646375
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:43,353] [INFO] [logging.py:60:log_dist] [Rank 0] step=2670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:43,353] [INFO] [timer.py:160:stop] 0/2670, SamplesPerSec=97328.92662846128
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00083 | Step 00020 | Loss 0.4732 | Train Acc 0.8717 | Speed (samples/sec) 132671.6155 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:44,549] [INFO] [logging.py:60:log_dist] [Rank 0] step=2680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:44,549] [INFO] [timer.py:160:stop] 0/2680, SamplesPerSec=97241.24036683865
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.72421803 ms
avg iteration GPU training time:17.15983991 ms
avg iteration (step) total cpu time:116.85705185 ms
Epoch Time(s): 5.5520
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.4726 | Train Acc 0.8732 | Speed (samples/sec) 132730.9863 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:47,304] [INFO] [logging.py:60:log_dist] [Rank 0] step=2690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:47,305] [INFO] [timer.py:160:stop] 0/2690, SamplesPerSec=97233.21157079925
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:48,357] [INFO] [logging.py:60:log_dist] [Rank 0] step=2700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:48,357] [INFO] [timer.py:160:stop] 0/2700, SamplesPerSec=97240.01163235694
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00084 | Step 00020 | Loss 0.4977 | Train Acc 0.8676 | Speed (samples/sec) 132781.5026 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:49,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=2710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:49,707] [INFO] [timer.py:160:stop] 0/2710, SamplesPerSec=97249.1631646539
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:50,977] [INFO] [logging.py:60:log_dist] [Rank 0] step=2720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:50,977] [INFO] [timer.py:160:stop] 0/2720, SamplesPerSec=97270.07931388241
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.96487575 ms
avg iteration GPU training time:15.27954967 ms
avg iteration (step) total cpu time:118.27949241 ms
Epoch Time(s): 5.4818
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.4872 | Train Acc 0.8705 | Speed (samples/sec) 132679.6196 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:53,802] [INFO] [logging.py:60:log_dist] [Rank 0] step=2730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:53,802] [INFO] [timer.py:160:stop] 0/2730, SamplesPerSec=97275.99853336942
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:55,042] [INFO] [logging.py:60:log_dist] [Rank 0] step=2740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:55,042] [INFO] [timer.py:160:stop] 0/2740, SamplesPerSec=97297.85131055994
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00085 | Step 00020 | Loss 0.4682 | Train Acc 0.8764 | Speed (samples/sec) 132782.2013 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:56,496] [INFO] [logging.py:60:log_dist] [Rank 0] step=2750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:56,496] [INFO] [timer.py:160:stop] 0/2750, SamplesPerSec=97301.96108835787
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.98210368 ms
avg iteration GPU training time:15.11243626 ms
avg iteration (step) total cpu time:122.13319319 ms
Epoch Time(s): 5.5866
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.4663 | Train Acc 0.8796 | Speed (samples/sec) 132832.7801 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:36:59,758] [INFO] [logging.py:60:log_dist] [Rank 0] step=2760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:36:59,758] [INFO] [timer.py:160:stop] 0/2760, SamplesPerSec=97290.43378151425
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:00,924] [INFO] [logging.py:60:log_dist] [Rank 0] step=2770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:00,924] [INFO] [timer.py:160:stop] 0/2770, SamplesPerSec=97292.82345829041
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00086 | Step 00020 | Loss 0.4773 | Train Acc 0.8746 | Speed (samples/sec) 132728.2002 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:02,209] [INFO] [logging.py:60:log_dist] [Rank 0] step=2780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:02,209] [INFO] [timer.py:160:stop] 0/2780, SamplesPerSec=97306.39274174588
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.47725038 ms
avg iteration GPU training time:15.48256719 ms
avg iteration (step) total cpu time:133.06785513 ms
Epoch Time(s): 6.0732
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.4540 | Train Acc 0.8729 | Speed (samples/sec) 132648.9151 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:05,347] [INFO] [logging.py:60:log_dist] [Rank 0] step=2790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:05,347] [INFO] [timer.py:160:stop] 0/2790, SamplesPerSec=97298.03261333429
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:06,963] [INFO] [logging.py:60:log_dist] [Rank 0] step=2800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:06,963] [INFO] [timer.py:160:stop] 0/2800, SamplesPerSec=97282.43501597676
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00087 | Step 00020 | Loss 0.4984 | Train Acc 0.8738 | Speed (samples/sec) 132670.4517 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:08,951] [INFO] [logging.py:60:log_dist] [Rank 0] step=2810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:08,951] [INFO] [timer.py:160:stop] 0/2810, SamplesPerSec=97281.27827089185
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.75127946 ms
avg iteration GPU training time:16.17993485 ms
avg iteration (step) total cpu time:153.58167224 ms
Epoch Time(s): 6.8546
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.4705 | Train Acc 0.8730 | Speed (samples/sec) 132714.1556 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:11,518] [INFO] [logging.py:60:log_dist] [Rank 0] step=2820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:11,518] [INFO] [timer.py:160:stop] 0/2820, SamplesPerSec=97245.32424515755
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:13,185] [INFO] [logging.py:60:log_dist] [Rank 0] step=2830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:13,185] [INFO] [timer.py:160:stop] 0/2830, SamplesPerSec=97251.00553857633
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00088 | Step 00020 | Loss 0.4688 | Train Acc 0.8761 | Speed (samples/sec) 132538.3683 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:14,202] [INFO] [logging.py:60:log_dist] [Rank 0] step=2840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:14,202] [INFO] [timer.py:160:stop] 0/2840, SamplesPerSec=97262.34159126884
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.50139381 ms
avg iteration GPU training time:15.40806396 ms
avg iteration (step) total cpu time:119.28338475 ms
Epoch Time(s): 5.6100
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.5143 | Train Acc 0.8592 | Speed (samples/sec) 132457.7538 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:16,930] [INFO] [logging.py:60:log_dist] [Rank 0] step=2850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:16,930] [INFO] [timer.py:160:stop] 0/2850, SamplesPerSec=97259.5995988412
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:17,979] [INFO] [logging.py:60:log_dist] [Rank 0] step=2860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:17,979] [INFO] [timer.py:160:stop] 0/2860, SamplesPerSec=97267.50274576369
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00089 | Step 00020 | Loss 0.4703 | Train Acc 0.8788 | Speed (samples/sec) 132588.3694 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:19,338] [INFO] [logging.py:60:log_dist] [Rank 0] step=2870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:19,339] [INFO] [timer.py:160:stop] 0/2870, SamplesPerSec=97267.11995289406
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:20,618] [INFO] [logging.py:60:log_dist] [Rank 0] step=2880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:20,618] [INFO] [timer.py:160:stop] 0/2880, SamplesPerSec=97288.43574998397
-----------------------------------------after batch engine step
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.45001487 ms
avg iteration GPU training time:15.28488647 ms
avg iteration (step) total cpu time:119.14220563 ms
Epoch Time(s): 5.5152
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4956 | Train Acc 0.8637 | Speed (samples/sec) 132583.9311 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:23,329] [INFO] [logging.py:60:log_dist] [Rank 0] step=2890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:23,329] [INFO] [timer.py:160:stop] 0/2890, SamplesPerSec=97285.93421614007
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:24,566] [INFO] [logging.py:60:log_dist] [Rank 0] step=2900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:24,566] [INFO] [timer.py:160:stop] 0/2900, SamplesPerSec=97284.79189550917
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00090 | Step 00020 | Loss 0.4923 | Train Acc 0.8738 | Speed (samples/sec) 132482.6326 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:25,952] [INFO] [logging.py:60:log_dist] [Rank 0] step=2910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:25,953] [INFO] [timer.py:160:stop] 0/2910, SamplesPerSec=97289.3107331534
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:11.10930953 ms
avg iteration GPU training time:15.62322260 ms
avg iteration (step) total cpu time:118.77412266 ms
Epoch Time(s): 5.4310
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4851 | Train Acc 0.8647 | Speed (samples/sec) 132396.2664 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:28,426] [INFO] [logging.py:60:log_dist] [Rank 0] step=2920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:28,427] [INFO] [timer.py:160:stop] 0/2920, SamplesPerSec=97292.52904662729
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:29,762] [INFO] [logging.py:60:log_dist] [Rank 0] step=2930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:29,763] [INFO] [timer.py:160:stop] 0/2930, SamplesPerSec=97284.56273391894
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00091 | Step 00020 | Loss 0.5105 | Train Acc 0.8629 | Speed (samples/sec) 132415.5606 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:30,819] [INFO] [logging.py:60:log_dist] [Rank 0] step=2940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:30,819] [INFO] [timer.py:160:stop] 0/2940, SamplesPerSec=97287.48516717386
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.23231413 ms
avg iteration GPU training time:15.81424120 ms
avg iteration (step) total cpu time:105.30166273 ms
Epoch Time(s): 5.1731
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4513 | Train Acc 0.8743 | Speed (samples/sec) 132362.2262 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:33,513] [INFO] [logging.py:60:log_dist] [Rank 0] step=2950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:33,514] [INFO] [timer.py:160:stop] 0/2950, SamplesPerSec=97284.4372147659
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:34,536] [INFO] [logging.py:60:log_dist] [Rank 0] step=2960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:34,536] [INFO] [timer.py:160:stop] 0/2960, SamplesPerSec=97285.56791924196
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00092 | Step 00020 | Loss 0.4949 | Train Acc 0.8661 | Speed (samples/sec) 132410.2764 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:36,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=2970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:36,130] [INFO] [timer.py:160:stop] 0/2970, SamplesPerSec=97280.20055774726
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.03140027 ms
avg iteration GPU training time:15.63616477 ms
avg iteration (step) total cpu time:124.27397128 ms
Epoch Time(s): 5.6308
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4469 | Train Acc 0.8820 | Speed (samples/sec) 132232.5662 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:38,741] [INFO] [logging.py:60:log_dist] [Rank 0] step=2980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:38,741] [INFO] [timer.py:160:stop] 0/2980, SamplesPerSec=97254.35793047305
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:40,177] [INFO] [logging.py:60:log_dist] [Rank 0] step=2990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:40,177] [INFO] [timer.py:160:stop] 0/2990, SamplesPerSec=97239.596799305
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00093 | Step 00020 | Loss 0.4615 | Train Acc 0.8737 | Speed (samples/sec) 132285.6515 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:41,205] [INFO] [logging.py:60:log_dist] [Rank 0] step=3000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:41,205] [INFO] [timer.py:160:stop] 0/3000, SamplesPerSec=97259.04715903716
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.73282381 ms
avg iteration GPU training time:15.55708567 ms
avg iteration (step) total cpu time:107.14924777 ms
Epoch Time(s): 5.2208
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.4903 | Train Acc 0.8633 | Speed (samples/sec) 132348.8562 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:43,881] [INFO] [logging.py:60:log_dist] [Rank 0] step=3010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:43,881] [INFO] [timer.py:160:stop] 0/3010, SamplesPerSec=97271.30486635836
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:44,906] [INFO] [logging.py:60:log_dist] [Rank 0] step=3020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:44,906] [INFO] [timer.py:160:stop] 0/3020, SamplesPerSec=97280.55220243869
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00094 | Step 00020 | Loss 0.4687 | Train Acc 0.8740 | Speed (samples/sec) 132418.2972 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:46,238] [INFO] [logging.py:60:log_dist] [Rank 0] step=3030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:46,238] [INFO] [timer.py:160:stop] 0/3030, SamplesPerSec=97284.87974030591
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:47,524] [INFO] [logging.py:60:log_dist] [Rank 0] step=3040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:47,524] [INFO] [timer.py:160:stop] 0/3040, SamplesPerSec=97295.61139369577
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.24584534 ms
avg iteration GPU training time:15.41464530 ms
avg iteration (step) total cpu time:118.60529582 ms
Epoch Time(s): 5.5124
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4698 | Train Acc 0.8730 | Speed (samples/sec) 132312.7770 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:50,332] [INFO] [logging.py:60:log_dist] [Rank 0] step=3050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:50,332] [INFO] [timer.py:160:stop] 0/3050, SamplesPerSec=97301.61805623319
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:51,605] [INFO] [logging.py:60:log_dist] [Rank 0] step=3060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:51,605] [INFO] [timer.py:160:stop] 0/3060, SamplesPerSec=97310.43830885786
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00095 | Step 00020 | Loss 0.4844 | Train Acc 0.8695 | Speed (samples/sec) 132344.0676 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:53,089] [INFO] [logging.py:60:log_dist] [Rank 0] step=3070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:53,089] [INFO] [timer.py:160:stop] 0/3070, SamplesPerSec=97322.18552835239
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.07766054 ms
avg iteration GPU training time:15.20877873 ms
avg iteration (step) total cpu time:122.60363720 ms
Epoch Time(s): 5.5811
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.4703 | Train Acc 0.8721 | Speed (samples/sec) 132380.0748 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:55,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=3080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:55,554] [INFO] [timer.py:160:stop] 0/3080, SamplesPerSec=97324.67099219497
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:56,909] [INFO] [logging.py:60:log_dist] [Rank 0] step=3090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:56,910] [INFO] [timer.py:160:stop] 0/3090, SamplesPerSec=97338.65782898388
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00096 | Step 00020 | Loss 0.4659 | Train Acc 0.8748 | Speed (samples/sec) 132453.8842 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:37:57,860] [INFO] [logging.py:60:log_dist] [Rank 0] step=3100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:37:57,860] [INFO] [timer.py:160:stop] 0/3100, SamplesPerSec=97355.454559908
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.00868273 ms
avg iteration GPU training time:15.09626788 ms
avg iteration (step) total cpu time:104.22436396 ms
Epoch Time(s): 5.1155
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.4562 | Train Acc 0.8802 | Speed (samples/sec) 132491.0185 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:00,607] [INFO] [logging.py:60:log_dist] [Rank 0] step=3110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:00,607] [INFO] [timer.py:160:stop] 0/3110, SamplesPerSec=97362.22875686141
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:01,605] [INFO] [logging.py:60:log_dist] [Rank 0] step=3120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:01,606] [INFO] [timer.py:160:stop] 0/3120, SamplesPerSec=97374.05996546433
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00097 | Step 00020 | Loss 0.4965 | Train Acc 0.8706 | Speed (samples/sec) 132567.4004 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:03,260] [INFO] [logging.py:60:log_dist] [Rank 0] step=3130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:03,260] [INFO] [timer.py:160:stop] 0/3130, SamplesPerSec=97377.8500241895
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.78413391 ms
avg iteration GPU training time:15.12909985 ms
avg iteration (step) total cpu time:120.59880186 ms
Epoch Time(s): 5.5554
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.4809 | Train Acc 0.8705 | Speed (samples/sec) 132575.1056 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:05,728] [INFO] [logging.py:60:log_dist] [Rank 0] step=3140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:05,728] [INFO] [timer.py:160:stop] 0/3140, SamplesPerSec=97398.11537259363
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:07,219] [INFO] [logging.py:60:log_dist] [Rank 0] step=3150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:07,220] [INFO] [timer.py:160:stop] 0/3150, SamplesPerSec=97387.22920781425
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00098 | Step 00020 | Loss 0.4810 | Train Acc 0.8717 | Speed (samples/sec) 132663.6119 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:08,222] [INFO] [logging.py:60:log_dist] [Rank 0] step=3160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:08,223] [INFO] [timer.py:160:stop] 0/3160, SamplesPerSec=97400.4416557256
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.69064773 ms
avg iteration GPU training time:15.38896472 ms
avg iteration (step) total cpu time:108.15120626 ms
Epoch Time(s): 5.2465
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.4767 | Train Acc 0.8717 | Speed (samples/sec) 132738.9407 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:10,849] [INFO] [logging.py:60:log_dist] [Rank 0] step=3170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:10,849] [INFO] [timer.py:160:stop] 0/3170, SamplesPerSec=97409.34090287055
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:11,921] [INFO] [logging.py:60:log_dist] [Rank 0] step=3180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:11,922] [INFO] [timer.py:160:stop] 0/3180, SamplesPerSec=97406.77409311353
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00099 | Step 00020 | Loss 0.4555 | Train Acc 0.8751 | Speed (samples/sec) 132717.9970 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:13,295] [INFO] [logging.py:60:log_dist] [Rank 0] step=3190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:13,295] [INFO] [timer.py:160:stop] 0/3190, SamplesPerSec=97404.80723934935
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:14,674] [INFO] [logging.py:60:log_dist] [Rank 0] step=3200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:14,674] [INFO] [timer.py:160:stop] 0/3200, SamplesPerSec=97419.15267708487
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:10.15815224 ms
avg iteration GPU training time:15.60605992 ms
avg iteration (step) total cpu time:124.17486862 ms
Epoch Time(s): 5.6136
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.4731 | Train Acc 0.8753 | Speed (samples/sec) 132687.1186 | GPU 1635.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:17,497] [INFO] [logging.py:60:log_dist] [Rank 0] step=3210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:17,497] [INFO] [timer.py:160:stop] 0/3210, SamplesPerSec=97384.88273654318
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:18,714] [INFO] [logging.py:60:log_dist] [Rank 0] step=3220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:18,714] [INFO] [timer.py:160:stop] 0/3220, SamplesPerSec=97397.6010472961
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

Epoch 00100 | Step 00020 | Loss 0.4684 | Train Acc 0.8769 | Speed (samples/sec) 132639.1466 | GPU 1635.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

[2021-06-09 07:38:20,233] [INFO] [logging.py:60:log_dist] [Rank 0] step=3230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-09 07:38:20,234] [INFO] [timer.py:160:stop] 0/3230, SamplesPerSec=97408.9197566322
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5974030494689941  GigaBytes

avg iteration(step) data from cpu to GPU time:9.71467732 ms
avg iteration GPU training time:15.76778182 ms
avg iteration (step) total cpu time:122.85218415 ms
Epoch Time(s): 5.6067
Eval Acc 0.8759
Test Acc: 0.7062
Avg epoch time(time.time()): 5675.772599875927 ms
total avg iteration(step) data from cpu to GPU time:10.15473432 ms
total avg iteration GPU training time:15.72146562 ms
total avg iteration (step) total cpu time:122.86633863 ms
