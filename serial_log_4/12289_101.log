[2021-06-12 05:18:52,958] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-12 05:18:56,639] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_serial.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-12 05:18:57,504] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-12 05:18:57,504] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-12 05:18:57,504] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-12 05:18:57,504] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-12 05:18:57,504] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623475142.8891318
before load_ogb step Time(s): 0.0018
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20395.015625, 'VmHWM': 1165.3125, 'VmRSS': 1165.3125}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6348
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2832
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0011
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0000
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0780
-------------------------------------------------end of load ogb****************** step Time(s): 0.0022
finish constructing ogbn-products
load ogb-products time total: 1.999495267868042
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0004
after inductive else step Time(s): 0.0000
after label step Time(s): 3.8145
after train_g.create_formats_() step Time(s): 1.7878
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-12 05:19:10,522] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-12 05:19:10,522] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-12 05:19:10,527] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-12 05:19:12,906] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-12 05:19:12,908] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-12 05:19:12,908] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-12 05:19:12,908] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-12 05:19:12,908] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-12 05:19:12,908] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fb077bac8d0>
[2021-06-12 05:19:12,908] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:19:12,908] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-12 05:19:12,909] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-12 05:19:12,910] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-12 05:19:12,911] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68408203125GB

Max Memory Allocated 1.2871980667114258  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.73876953125GB

Max Memory Allocated 1.2871980667114258  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.03759765625GB

Max Memory Allocated 1.3841605186462402  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.03759765625GB

Max Memory Allocated 1.3841605186462402  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.18798828125GB

Max Memory Allocated 1.410003662109375  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6153 | Train Acc 0.0183 | Speed (samples/sec) nan | GPU 1443.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.18798828125GB

Max Memory Allocated 1.410003662109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.639153003692627  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.639153003692627  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.639153003692627  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.639153003692627  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639153003692627  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639153003692627  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.640030860900879  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.640030860900879  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.640030860900879  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51611328125GB

Max Memory Allocated 1.640030860900879  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.640030860900879  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.640030860900879  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6410527229309082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6410527229309082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6410527229309082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6410527229309082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6410527229309082  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6410527229309082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51611328125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6419219970703125  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6419219970703125  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51611328125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6419219970703125  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6419219970703125  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6419219970703125  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

avg iteration(step) data from cpu to GPU time:17.21960692 ms
avg iteration GPU training time:21.51670681 ms
avg iteration (step) total cpu time:163.29795664 ms
Epoch Time(s): 5.9777
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

Epoch 00001 | Step 00000 | Loss 4.2037 | Train Acc 0.0833 | Speed (samples/sec) 187308.2466 | GPU 1681.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422224044799805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422224044799805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:15.34900093 ms
avg iteration GPU training time:21.56797669 ms
avg iteration (step) total cpu time:178.60752886 ms
Epoch Time(s): 5.2315
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00002 | Step 00000 | Loss 4.1725 | Train Acc 0.0833 | Speed (samples/sec) 182653.5215 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:15.69857727 ms
avg iteration GPU training time:21.66795072 ms
avg iteration (step) total cpu time:197.60008292 ms
Epoch Time(s): 5.2619
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00003 | Step 00000 | Loss 3.9028 | Train Acc 0.1127 | Speed (samples/sec) 180312.5552 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:15.38230983 ms
avg iteration GPU training time:21.00982128 ms
avg iteration (step) total cpu time:177.52062191 ms
Epoch Time(s): 5.1621
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00004 | Step 00000 | Loss 3.4540 | Train Acc 0.1760 | Speed (samples/sec) 174253.0660 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:15.66244351 ms
avg iteration GPU training time:20.73060382 ms
avg iteration (step) total cpu time:163.90581564 ms
Epoch Time(s): 4.9637
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00005 | Step 00000 | Loss 3.0695 | Train Acc 0.2550 | Speed (samples/sec) 177674.1633 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:16.47684938 ms
avg iteration GPU training time:21.64638294 ms
avg iteration (step) total cpu time:193.75109673 ms
Epoch Time(s): 5.2701
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00006 | Step 00000 | Loss 2.6395 | Train Acc 0.3460 | Speed (samples/sec) 180711.8543 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:15.75878967 ms
avg iteration GPU training time:20.82217338 ms
avg iteration (step) total cpu time:190.50569968 ms
Epoch Time(s): 5.2208
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00007 | Step 00000 | Loss 2.2878 | Train Acc 0.4206 | Speed (samples/sec) 180893.9675 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:15.82873899 ms
avg iteration GPU training time:21.08914653 ms
avg iteration (step) total cpu time:158.93502669 ms
Epoch Time(s): 4.8807
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00008 | Step 00000 | Loss 2.0314 | Train Acc 0.4707 | Speed (samples/sec) 183130.4838 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:17.04638863 ms
avg iteration GPU training time:21.43965357 ms
avg iteration (step) total cpu time:195.10299509 ms
Epoch Time(s): 5.2071
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00009 | Step 00000 | Loss 1.7876 | Train Acc 0.5155 | Speed (samples/sec) 181143.8864 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

[2021-06-12 05:20:06,247] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-12 05:20:06,248] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=4858.866097684048
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:15.24625163 ms
avg iteration GPU training time:21.57438798 ms
avg iteration (step) total cpu time:225.55125843 ms
Epoch Time(s): 6.1596
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00010 | Step 00000 | Loss 1.6416 | Train Acc 0.5483 | Speed (samples/sec) 181337.8261 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31561314 ms
avg iteration GPU training time:20.86058790 ms
avg iteration (step) total cpu time:217.22709049 ms
Epoch Time(s): 5.4338
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00011 | Step 00000 | Loss 1.5082 | Train Acc 0.5792 | Speed (samples/sec) 182597.4506 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:16.89042048 ms
avg iteration GPU training time:21.32703105 ms
avg iteration (step) total cpu time:202.06499100 ms
Epoch Time(s): 5.2778
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

Epoch 00012 | Step 00000 | Loss 1.3875 | Train Acc 0.6166 | Speed (samples/sec) 183267.1109 | GPU 1681.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

avg iteration(step) data from cpu to GPU time:17.15204057 ms
avg iteration GPU training time:22.34683349 ms
avg iteration (step) total cpu time:175.45559190 ms
Epoch Time(s): 5.3424
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.642439365386963  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00013 | Step 00000 | Loss 1.2874 | Train Acc 0.6591 | Speed (samples/sec) 183877.3183 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31720994 ms
avg iteration GPU training time:21.13838230 ms
avg iteration (step) total cpu time:181.58277598 ms
Epoch Time(s): 5.1238
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00014 | Step 00000 | Loss 1.2053 | Train Acc 0.6873 | Speed (samples/sec) 184019.1426 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:17.60315332 ms
avg iteration GPU training time:21.02788648 ms
avg iteration (step) total cpu time:202.16285099 ms
Epoch Time(s): 5.3032
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00015 | Step 00000 | Loss 1.1618 | Train Acc 0.7045 | Speed (samples/sec) 184542.9652 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:14.70619332 ms
avg iteration GPU training time:20.32714462 ms
avg iteration (step) total cpu time:166.90098156 ms
Epoch Time(s): 5.0487
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00016 | Step 00000 | Loss 1.1073 | Train Acc 0.7256 | Speed (samples/sec) 185761.9733 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.35715771 ms
avg iteration GPU training time:20.82232128 ms
avg iteration (step) total cpu time:163.87826746 ms
Epoch Time(s): 4.9037
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00017 | Step 00000 | Loss 1.0564 | Train Acc 0.7371 | Speed (samples/sec) 186504.8489 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.94722020 ms
avg iteration GPU training time:21.69021364 ms
avg iteration (step) total cpu time:187.05621633 ms
Epoch Time(s): 5.1755
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.9716 | Train Acc 0.7523 | Speed (samples/sec) 186528.0929 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:17.02777611 ms
avg iteration GPU training time:20.81306752 ms
avg iteration (step) total cpu time:174.06268553 ms
Epoch Time(s): 5.0577
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.9492 | Train Acc 0.7650 | Speed (samples/sec) 186962.4048 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

[2021-06-12 05:20:58,183] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:20:58,183] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=4961.026404802732
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:15.40692659 ms
avg iteration GPU training time:20.97371656 ms
avg iteration (step) total cpu time:194.73988360 ms
Epoch Time(s): 5.2678
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.9091 | Train Acc 0.7748 | Speed (samples/sec) 187602.4222 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.32898643 ms
avg iteration GPU training time:21.33218627 ms
avg iteration (step) total cpu time:194.71357085 ms
Epoch Time(s): 5.2078
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.9020 | Train Acc 0.7809 | Speed (samples/sec) 186369.6647 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:15.31323936 ms
avg iteration GPU training time:21.75673311 ms
avg iteration (step) total cpu time:162.82356869 ms
Epoch Time(s): 4.9410
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.8872 | Train Acc 0.7905 | Speed (samples/sec) 186545.7252 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:15.19058045 ms
avg iteration GPU training time:20.55171481 ms
avg iteration (step) total cpu time:208.06141333 ms
Epoch Time(s): 5.3994
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.8440 | Train Acc 0.7950 | Speed (samples/sec) 187264.1925 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:17.08546604 ms
avg iteration GPU training time:21.14556503 ms
avg iteration (step) total cpu time:189.77800283 ms
Epoch Time(s): 5.0955
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.8183 | Train Acc 0.8015 | Speed (samples/sec) 186306.1319 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:17.06678113 ms
avg iteration GPU training time:21.02658584 ms
avg iteration (step) total cpu time:192.58421118 ms
Epoch Time(s): 5.2389
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.8076 | Train Acc 0.8039 | Speed (samples/sec) 185528.7103 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.23029241 ms
avg iteration GPU training time:21.11841479 ms
avg iteration (step) total cpu time:217.35163168 ms
Epoch Time(s): 5.5377
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.7771 | Train Acc 0.8060 | Speed (samples/sec) 185092.7882 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:15.82845688 ms
avg iteration GPU training time:21.22175702 ms
avg iteration (step) total cpu time:218.45897761 ms
Epoch Time(s): 5.4712
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.7508 | Train Acc 0.8155 | Speed (samples/sec) 183989.4321 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44534978 ms
avg iteration GPU training time:22.03289015 ms
avg iteration (step) total cpu time:253.92811949 ms
Epoch Time(s): 6.1997
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.7443 | Train Acc 0.8142 | Speed (samples/sec) 182979.1697 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.40079429 ms
avg iteration GPU training time:21.06301100 ms
avg iteration (step) total cpu time:200.17834143 ms
Epoch Time(s): 5.2167
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.7224 | Train Acc 0.8216 | Speed (samples/sec) 182915.8217 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

[2021-06-12 05:21:52,118] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:21:52,119] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=4902.548852311527
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:17.45525534 ms
avg iteration GPU training time:21.51630835 ms
avg iteration (step) total cpu time:236.20039766 ms
Epoch Time(s): 5.6270
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.7262 | Train Acc 0.8198 | Speed (samples/sec) 182771.8396 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

avg iteration(step) data from cpu to GPU time:16.81574683 ms
avg iteration GPU training time:22.71824871 ms
avg iteration (step) total cpu time:162.92758421 ms
Epoch Time(s): 5.0979
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.7062 | Train Acc 0.8271 | Speed (samples/sec) 182988.0441 | GPU 1682.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6425690650939941  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6428327560424805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6428327560424805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6428327560424805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6428327560424805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6428327560424805  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6428327560424805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.75767560 ms
avg iteration GPU training time:20.74795654 ms
avg iteration (step) total cpu time:165.02027078 ms
Epoch Time(s): 4.8056
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.6840 | Train Acc 0.8318 | Speed (samples/sec) 182812.1850 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.97577329 ms
avg iteration GPU training time:21.16748203 ms
avg iteration (step) total cpu time:192.86212054 ms
Epoch Time(s): 5.1285
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.6783 | Train Acc 0.8289 | Speed (samples/sec) 182959.8040 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:18.10015999 ms
avg iteration GPU training time:20.51341109 ms
avg iteration (step) total cpu time:176.49167234 ms
Epoch Time(s): 4.9855
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.6518 | Train Acc 0.8344 | Speed (samples/sec) 182771.6914 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.63679114 ms
avg iteration GPU training time:20.21446401 ms
avg iteration (step) total cpu time:177.57190358 ms
Epoch Time(s): 5.0042
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.6750 | Train Acc 0.8286 | Speed (samples/sec) 183193.9396 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.66317680 ms
avg iteration GPU training time:21.00301361 ms
avg iteration (step) total cpu time:195.12510300 ms
Epoch Time(s): 5.3386
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.6487 | Train Acc 0.8338 | Speed (samples/sec) 183481.9934 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:18.76644672 ms
avg iteration GPU training time:20.86457894 ms
avg iteration (step) total cpu time:162.06702319 ms
Epoch Time(s): 4.9111
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.6701 | Train Acc 0.8287 | Speed (samples/sec) 183480.0573 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.15076923 ms
avg iteration GPU training time:20.81851925 ms
avg iteration (step) total cpu time:171.15209319 ms
Epoch Time(s): 5.0277
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.6378 | Train Acc 0.8391 | Speed (samples/sec) 183564.3613 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:17.20794166 ms
avg iteration GPU training time:21.06978052 ms
avg iteration (step) total cpu time:197.22565738 ms
Epoch Time(s): 5.2351
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.6505 | Train Acc 0.8361 | Speed (samples/sec) 183681.9483 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

[2021-06-12 05:22:42,698] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:22:42,698] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4971.369422157673
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.73269541 ms
avg iteration GPU training time:21.03720457 ms
avg iteration (step) total cpu time:175.75706135 ms
Epoch Time(s): 5.0448
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.6325 | Train Acc 0.8405 | Speed (samples/sec) 183530.2495 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430420875549316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

avg iteration(step) data from cpu to GPU time:15.00107930 ms
avg iteration GPU training time:20.14218469 ms
avg iteration (step) total cpu time:177.59734934 ms
Epoch Time(s): 5.0518
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.6268 | Train Acc 0.8427 | Speed (samples/sec) 184022.5274 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

avg iteration(step) data from cpu to GPU time:19.37739043 ms
avg iteration GPU training time:21.13342545 ms
avg iteration (step) total cpu time:317.01569124 ms
Epoch Time(s): 6.8026
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.6157 | Train Acc 0.8447 | Speed (samples/sec) 183147.5432 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12141106 ms
avg iteration GPU training time:23.08818921 ms
avg iteration (step) total cpu time:226.32470998 ms
Epoch Time(s): 5.6654
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.6212 | Train Acc 0.8443 | Speed (samples/sec) 182569.2963 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643049716949463  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:17.14456428 ms
avg iteration GPU training time:21.74109355 ms
avg iteration (step) total cpu time:243.74619397 ms
Epoch Time(s): 5.9320
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.5817 | Train Acc 0.8538 | Speed (samples/sec) 180178.6731 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:16.77241915 ms
avg iteration GPU training time:21.98693830 ms
avg iteration (step) total cpu time:233.83179578 ms
Epoch Time(s): 5.6603
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.6135 | Train Acc 0.8460 | Speed (samples/sec) 178988.2396 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:17.29002181 ms
avg iteration GPU training time:22.02290587 ms
avg iteration (step) total cpu time:183.34971775 ms
Epoch Time(s): 5.0883
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.5876 | Train Acc 0.8491 | Speed (samples/sec) 178281.6262 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:15.32084656 ms
avg iteration GPU training time:20.47586320 ms
avg iteration (step) total cpu time:169.02637482 ms
Epoch Time(s): 4.9881
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.6221 | Train Acc 0.8421 | Speed (samples/sec) 178754.9448 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:15.87331191 ms
avg iteration GPU training time:21.36737130 ms
avg iteration (step) total cpu time:186.11816926 ms
Epoch Time(s): 5.1700
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.5934 | Train Acc 0.8508 | Speed (samples/sec) 178854.7229 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:16.87701260 ms
avg iteration GPU training time:20.83108347 ms
avg iteration (step) total cpu time:166.17792303 ms
Epoch Time(s): 5.2160
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.5828 | Train Acc 0.8530 | Speed (samples/sec) 179125.2500 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

[2021-06-12 05:23:37,213] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:23:37,213] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=4976.608874932164
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:17.77101968 ms
avg iteration GPU training time:20.90582969 ms
avg iteration (step) total cpu time:166.64244912 ms
Epoch Time(s): 4.9395
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.5943 | Train Acc 0.8486 | Speed (samples/sec) 179309.2852 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.64396333694458  GigaBytes

avg iteration(step) data from cpu to GPU time:17.09331183 ms
avg iteration GPU training time:21.19131938 ms
avg iteration (step) total cpu time:185.55255370 ms
Epoch Time(s): 5.2072
Eval Acc 0.8566
Test Acc: 0.6824
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.5811 | Train Acc 0.8506 | Speed (samples/sec) 179634.0406 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.01394601 ms
avg iteration GPU training time:20.83673304 ms
avg iteration (step) total cpu time:187.23895333 ms
Epoch Time(s): 5.1652
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.5991 | Train Acc 0.8488 | Speed (samples/sec) 179861.1289 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:18.93645980 ms
avg iteration GPU training time:21.43575009 ms
avg iteration (step) total cpu time:165.45163501 ms
Epoch Time(s): 4.9236
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.5723 | Train Acc 0.8524 | Speed (samples/sec) 179892.1936 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:17.21575832 ms
avg iteration GPU training time:20.48738896 ms
avg iteration (step) total cpu time:176.75339092 ms
Epoch Time(s): 5.0348
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.5594 | Train Acc 0.8517 | Speed (samples/sec) 179664.5816 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.33632270 ms
avg iteration GPU training time:20.43191563 ms
avg iteration (step) total cpu time:201.11409101 ms
Epoch Time(s): 5.2928
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.5717 | Train Acc 0.8560 | Speed (samples/sec) 179762.5895 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.38156787 ms
avg iteration GPU training time:20.56977168 ms
avg iteration (step) total cpu time:174.83381792 ms
Epoch Time(s): 5.0749
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.5829 | Train Acc 0.8482 | Speed (samples/sec) 179930.8896 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.10246693 ms
avg iteration GPU training time:21.10967289 ms
avg iteration (step) total cpu time:165.36318172 ms
Epoch Time(s): 4.9183
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.5821 | Train Acc 0.8486 | Speed (samples/sec) 180002.3156 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.56143691 ms
avg iteration GPU training time:20.20113754 ms
avg iteration (step) total cpu time:188.49084594 ms
Epoch Time(s): 5.1831
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.5532 | Train Acc 0.8580 | Speed (samples/sec) 180013.0639 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.80567291 ms
avg iteration GPU training time:21.37840548 ms
avg iteration (step) total cpu time:178.18229849 ms
Epoch Time(s): 5.2063
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.5547 | Train Acc 0.8535 | Speed (samples/sec) 180079.0128 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

[2021-06-12 05:25:03,984] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:25:03,985] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=4980.418390990972
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06185601 ms
avg iteration GPU training time:20.64374404 ms
avg iteration (step) total cpu time:171.25199058 ms
Epoch Time(s): 4.9607
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.5522 | Train Acc 0.8577 | Speed (samples/sec) 179986.8736 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.57915644 ms
avg iteration GPU training time:20.84658311 ms
avg iteration (step) total cpu time:193.27037985 ms
Epoch Time(s): 5.1777
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.5504 | Train Acc 0.8585 | Speed (samples/sec) 179773.3407 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.81424592 ms
avg iteration GPU training time:22.06005825 ms
avg iteration (step) total cpu time:171.83767666 ms
Epoch Time(s): 4.9582
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.5821 | Train Acc 0.8516 | Speed (samples/sec) 179804.6410 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.41495835 ms
avg iteration GPU training time:21.15810308 ms
avg iteration (step) total cpu time:174.02479865 ms
Epoch Time(s): 4.9132
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.5498 | Train Acc 0.8582 | Speed (samples/sec) 179984.5189 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.44797377 ms
avg iteration GPU training time:20.37415851 ms
avg iteration (step) total cpu time:205.56109602 ms
Epoch Time(s): 5.3654
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.5514 | Train Acc 0.8601 | Speed (samples/sec) 180221.7742 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:19.46746757 ms
avg iteration GPU training time:20.87917692 ms
avg iteration (step) total cpu time:191.48310748 ms
Epoch Time(s): 5.1563
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.5508 | Train Acc 0.8569 | Speed (samples/sec) 180177.2725 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.62912299 ms
avg iteration GPU training time:20.72315355 ms
avg iteration (step) total cpu time:207.37713034 ms
Epoch Time(s): 5.3520
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.5596 | Train Acc 0.8585 | Speed (samples/sec) 180398.6213 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.73841763 ms
avg iteration GPU training time:21.24365685 ms
avg iteration (step) total cpu time:208.30624754 ms
Epoch Time(s): 5.3672
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.5470 | Train Acc 0.8616 | Speed (samples/sec) 180235.8513 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:19.26704884 ms
avg iteration GPU training time:20.88455842 ms
avg iteration (step) total cpu time:185.94334342 ms
Epoch Time(s): 5.1540
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.5460 | Train Acc 0.8612 | Speed (samples/sec) 180186.6080 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.24676072 ms
avg iteration GPU training time:20.82708359 ms
avg iteration (step) total cpu time:181.80977214 ms
Epoch Time(s): 5.0383
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.5526 | Train Acc 0.8574 | Speed (samples/sec) 180126.7961 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

[2021-06-12 05:25:55,819] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:25:55,819] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=5015.839088620089
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.76011354 ms
avg iteration GPU training time:21.20334816 ms
avg iteration (step) total cpu time:209.49196815 ms
Epoch Time(s): 5.3516
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.5545 | Train Acc 0.8526 | Speed (samples/sec) 180262.6871 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.47474896 ms
avg iteration GPU training time:20.29708255 ms
avg iteration (step) total cpu time:175.33941702 ms
Epoch Time(s): 5.0347
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.5557 | Train Acc 0.8537 | Speed (samples/sec) 180506.1498 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.48763934 ms
avg iteration GPU training time:20.51172621 ms
avg iteration (step) total cpu time:182.60507150 ms
Epoch Time(s): 5.0787
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.5343 | Train Acc 0.8593 | Speed (samples/sec) 180715.8129 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.80628664 ms
avg iteration GPU training time:20.45617762 ms
avg iteration (step) total cpu time:216.31089124 ms
Epoch Time(s): 5.7138
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.5373 | Train Acc 0.8550 | Speed (samples/sec) 180943.6838 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.18203050 ms
avg iteration GPU training time:21.37627619 ms
avg iteration (step) total cpu time:178.64014886 ms
Epoch Time(s): 5.0945
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.5283 | Train Acc 0.8606 | Speed (samples/sec) 181084.0421 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:14.74118406 ms
avg iteration GPU training time:20.67028080 ms
avg iteration (step) total cpu time:183.83864923 ms
Epoch Time(s): 5.0894
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.5323 | Train Acc 0.8569 | Speed (samples/sec) 181243.2430 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:17.05319006 ms
avg iteration GPU training time:21.32904434 ms
avg iteration (step) total cpu time:358.44945908 ms
Epoch Time(s): 7.4089
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.5239 | Train Acc 0.8609 | Speed (samples/sec) 180381.0208 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:18.84245248 ms
avg iteration GPU training time:21.04181845 ms
avg iteration (step) total cpu time:304.03549021 ms
Epoch Time(s): 6.9557
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.5346 | Train Acc 0.8598 | Speed (samples/sec) 179851.1285 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.50069540 ms
avg iteration GPU training time:21.03971499 ms
avg iteration (step) total cpu time:211.26781810 ms
Epoch Time(s): 5.2671
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.5389 | Train Acc 0.8589 | Speed (samples/sec) 179777.3666 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.69328872 ms
avg iteration GPU training time:20.76970777 ms
avg iteration (step) total cpu time:212.62660894 ms
Epoch Time(s): 5.2508
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.5440 | Train Acc 0.8611 | Speed (samples/sec) 179603.7963 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

[2021-06-12 05:26:51,862] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:26:51,862] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=5017.551158573719
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.11348655 ms
avg iteration GPU training time:20.50611201 ms
avg iteration (step) total cpu time:172.50329798 ms
Epoch Time(s): 5.1486
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.5295 | Train Acc 0.8595 | Speed (samples/sec) 179765.2668 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.66990532 ms
avg iteration GPU training time:20.47260510 ms
avg iteration (step) total cpu time:211.99009635 ms
Epoch Time(s): 5.4566
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.5286 | Train Acc 0.8602 | Speed (samples/sec) 179998.9907 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.26329908 ms
avg iteration GPU training time:20.81219500 ms
avg iteration (step) total cpu time:211.54069901 ms
Epoch Time(s): 5.4226
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.5324 | Train Acc 0.8620 | Speed (samples/sec) 180196.6533 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:18.36832575 ms
avg iteration GPU training time:21.27118822 ms
avg iteration (step) total cpu time:180.90241606 ms
Epoch Time(s): 5.0370
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.5344 | Train Acc 0.8572 | Speed (samples/sec) 180271.3025 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.38364809 ms
avg iteration GPU training time:20.57836238 ms
avg iteration (step) total cpu time:195.44995915 ms
Epoch Time(s): 6.0888
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.5285 | Train Acc 0.8580 | Speed (samples/sec) 180532.4151 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.67648272 ms
avg iteration GPU training time:21.61785299 ms
avg iteration (step) total cpu time:198.90312715 ms
Epoch Time(s): 5.3928
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.5178 | Train Acc 0.8649 | Speed (samples/sec) 180565.5863 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.31356534 ms
avg iteration GPU training time:23.31735264 ms
avg iteration (step) total cpu time:176.09158429 ms
Epoch Time(s): 5.1396
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.5184 | Train Acc 0.8619 | Speed (samples/sec) 180596.8364 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.62700497 ms
avg iteration GPU training time:21.44226907 ms
avg iteration (step) total cpu time:199.55667582 ms
Epoch Time(s): 5.2517
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.5161 | Train Acc 0.8635 | Speed (samples/sec) 180391.4753 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.54641151 ms
avg iteration GPU training time:20.33239850 ms
avg iteration (step) total cpu time:203.29265161 ms
Epoch Time(s): 5.3166
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.5279 | Train Acc 0.8636 | Speed (samples/sec) 180480.2233 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:18.29607842 ms
avg iteration GPU training time:20.32882604 ms
avg iteration (step) total cpu time:167.56970232 ms
Epoch Time(s): 5.0295
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.5446 | Train Acc 0.8578 | Speed (samples/sec) 180623.5595 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

[2021-06-12 05:27:45,060] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:27:45,060] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=5032.80413095487
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.19109240 ms
avg iteration GPU training time:20.38593760 ms
avg iteration (step) total cpu time:176.64720795 ms
Epoch Time(s): 5.0621
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.5335 | Train Acc 0.8603 | Speed (samples/sec) 180677.1100 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.91133933 ms
avg iteration GPU training time:20.76104129 ms
avg iteration (step) total cpu time:204.73100922 ms
Epoch Time(s): 5.4110
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.5453 | Train Acc 0.8597 | Speed (samples/sec) 180770.1488 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:17.06676674 ms
avg iteration GPU training time:20.67693953 ms
avg iteration (step) total cpu time:168.83598674 ms
Epoch Time(s): 5.2957
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.5128 | Train Acc 0.8644 | Speed (samples/sec) 180897.7930 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.56842778 ms
avg iteration GPU training time:20.55581942 ms
avg iteration (step) total cpu time:162.13228486 ms
Epoch Time(s): 5.0315
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.5010 | Train Acc 0.8675 | Speed (samples/sec) 181047.0672 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34242040 ms
avg iteration GPU training time:20.42161751 ms
avg iteration (step) total cpu time:180.01348322 ms
Epoch Time(s): 5.1598
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.5308 | Train Acc 0.8587 | Speed (samples/sec) 181117.7832 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:14.83280607 ms
avg iteration GPU training time:22.11638693 ms
avg iteration (step) total cpu time:188.85371902 ms
Epoch Time(s): 5.3080
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.5136 | Train Acc 0.8636 | Speed (samples/sec) 181331.7411 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.44550688 ms
avg iteration GPU training time:20.48505592 ms
avg iteration (step) total cpu time:178.68390950 ms
Epoch Time(s): 5.0629
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5277 | Train Acc 0.8600 | Speed (samples/sec) 181518.2656 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.96714471 ms
avg iteration GPU training time:20.85378890 ms
avg iteration (step) total cpu time:203.61573046 ms
Epoch Time(s): 5.3160
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5065 | Train Acc 0.8648 | Speed (samples/sec) 181540.5184 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:17.84704859 ms
avg iteration GPU training time:22.15511287 ms
avg iteration (step) total cpu time:162.50252724 ms
Epoch Time(s): 5.1675
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5218 | Train Acc 0.8637 | Speed (samples/sec) 181595.6853 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:14.89350414 ms
avg iteration GPU training time:20.88740071 ms
avg iteration (step) total cpu time:196.74054059 ms
Epoch Time(s): 5.6115
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5070 | Train Acc 0.8656 | Speed (samples/sec) 181860.0925 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

[2021-06-12 05:28:37,853] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 05:28:37,853] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=5030.78029227665
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34784014 ms
avg iteration GPU training time:20.94526256 ms
avg iteration (step) total cpu time:198.99134202 ms
Epoch Time(s): 5.4279
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5191 | Train Acc 0.8629 | Speed (samples/sec) 181933.1310 | GPU 2036.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9886670112609863  GigaBytes

avg iteration(step) data from cpu to GPU time:15.29891474 ms
avg iteration GPU training time:20.52886113 ms
avg iteration (step) total cpu time:169.25126856 ms
Epoch Time(s): 5.2481
Eval Acc 0.8709
Test Acc: 0.6941
Avg epoch time(time.time()): 5289.385033150514 ms
total avg iteration(step) data from cpu to GPU time:16.37347252 ms
total avg iteration GPU training time:21.07363003 ms
total avg iteration (step) total cpu time:192.92346107 ms
