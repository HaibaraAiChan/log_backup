[2021-06-11 22:11:03,424] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-11 22:11:07,115] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 24577 --deepspeed_config ds_config.json
[2021-06-11 22:11:07,989] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-11 22:11:07,989] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-11 22:11:07,989] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-11 22:11:07,989] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-11 22:11:07,990] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623449473.632408
before load_ogb step Time(s): 0.0066
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.17578125, 'VmSize': 20395.0, 'VmHWM': 1165.01171875, 'VmRSS': 1165.01171875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6457
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2826
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1191
-------------------------------------------------end of load ogb****************** step Time(s): 0.0022
finish constructing ogbn-products
load ogb-products time total: 2.051185369491577
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0521
after inductive else step Time(s): 0.0000
after label step Time(s): 3.6512
after train_g.create_formats_() step Time(s): 1.5133
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 24577
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-11 22:11:20,885] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-11 22:11:20,885] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-11 22:11:20,889] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-11 22:11:23,262] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-11 22:11:23,264] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-11 22:11:23,264] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-11 22:11:23,264] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-11 22:11:23,264] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-11 22:11:23,264] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f2148048940>
[2021-06-11 22:11:23,264] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:11:23,264] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-11 22:11:23,265] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-11 22:11:23,266] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-11 22:11:23,267] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.78564453125GB

Max Memory Allocated 1.39078950881958  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.85791015625GB

Max Memory Allocated 1.39078950881958  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.25048828125GB

Max Memory Allocated 1.534358024597168  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.25048828125GB

Max Memory Allocated 1.534358024597168  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45166015625GB

Max Memory Allocated 1.5628604888916016  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45166015625GB

Max Memory Allocated 1.5628604888916016  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6080 | Train Acc 0.0194 | Speed (samples/sec) nan | GPU 1600.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45166015625GB

Max Memory Allocated 1.5628604888916016  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.98291015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.85791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90283203125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.98291015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.85986328125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.98291015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.85791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.90478515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

avg iteration(step) data from cpu to GPU time:28.06392479 ms
avg iteration GPU training time:27.31336530 ms
avg iteration (step) total cpu time:94.44642067 ms
Epoch Time(s): 4.6871
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

Epoch 00001 | Step 00000 | Loss 2.0447 | Train Acc 0.4621 | Speed (samples/sec) 214559.8920 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

[2021-06-11 22:11:30,745] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-11 22:11:30,747] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=53220.84818544315
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

avg iteration(step) data from cpu to GPU time:26.62217585 ms
avg iteration GPU training time:27.29363251 ms
avg iteration (step) total cpu time:69.09775734 ms
Epoch Time(s): 4.5484
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

Epoch 00002 | Step 00000 | Loss 1.1322 | Train Acc 0.7182 | Speed (samples/sec) 244340.6632 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464851379394531  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

[2021-06-11 22:11:35,493] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:11:35,494] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=53816.416433731596
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

avg iteration(step) data from cpu to GPU time:30.85391935 ms
avg iteration GPU training time:26.13479487 ms
avg iteration (step) total cpu time:69.59358851 ms
Epoch Time(s): 4.8510
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.8224 | Train Acc 0.7962 | Speed (samples/sec) 251112.6609 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464865684509277  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:11:41,824] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:11:41,824] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=55123.123104329505
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:34.43001620 ms
avg iteration GPU training time:25.95153109 ms
avg iteration (step) total cpu time:74.25165176 ms
Epoch Time(s): 4.9327
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.7002 | Train Acc 0.8245 | Speed (samples/sec) 255045.0782 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:11:47,683] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:11:47,684] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=55519.1079984794
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:27.67011197 ms
avg iteration GPU training time:26.82902400 ms
avg iteration (step) total cpu time:369.47218577 ms
Epoch Time(s): 5.7091
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.6529 | Train Acc 0.8333 | Speed (samples/sec) 242059.9519 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:29.11105029 ms
avg iteration GPU training time:26.14191945 ms
avg iteration (step) total cpu time:205.53461711 ms
Epoch Time(s): 5.0864
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.6069 | Train Acc 0.8438 | Speed (samples/sec) 238234.4768 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:11:56,874] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:11:56,875] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=55470.57114192015
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:27.12664541 ms
avg iteration GPU training time:71.67637380 ms
avg iteration (step) total cpu time:323.98168246 ms
Epoch Time(s): 5.7045
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.6013 | Train Acc 0.8475 | Speed (samples/sec) 227693.7768 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:01,780] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:01,781] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=51221.89154005463
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:29.99428304 ms
avg iteration GPU training time:27.76767985 ms
avg iteration (step) total cpu time:73.22223981 ms
Epoch Time(s): 4.7082
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.5700 | Train Acc 0.8521 | Speed (samples/sec) 232160.5270 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:07,545] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:07,546] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=51588.60123445387
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:26.73223495 ms
avg iteration GPU training time:29.43413353 ms
avg iteration (step) total cpu time:71.67267799 ms
Epoch Time(s): 4.4936
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.5464 | Train Acc 0.8592 | Speed (samples/sec) 234996.1792 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:12,360] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:12,361] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=51813.394160722666
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:31.77767499 ms
avg iteration GPU training time:27.37974421 ms
avg iteration (step) total cpu time:108.21676254 ms
Epoch Time(s): 4.6844
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.5365 | Train Acc 0.8606 | Speed (samples/sec) 235647.1354 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:34.11563746 ms
avg iteration GPU training time:26.27672513 ms
avg iteration (step) total cpu time:77.31882731 ms
Epoch Time(s): 4.6582
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.5408 | Train Acc 0.8574 | Speed (samples/sec) 237357.6481 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:20,084] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:20,084] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=52262.7371324109
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:27.24478976 ms
avg iteration GPU training time:25.97735469 ms
avg iteration (step) total cpu time:69.65176264 ms
Epoch Time(s): 4.4457
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.5268 | Train Acc 0.8606 | Speed (samples/sec) 239895.9509 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:24,610] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:24,611] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=52671.010508271844
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:27.61738650 ms
avg iteration GPU training time:27.62766965 ms
avg iteration (step) total cpu time:73.29392433 ms
Epoch Time(s): 4.4770
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.5171 | Train Acc 0.8638 | Speed (samples/sec) 240913.1508 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:30,713] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:30,714] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=52829.037023859935
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:30.42155711 ms
avg iteration GPU training time:27.12958972 ms
avg iteration (step) total cpu time:167.00657209 ms
Epoch Time(s): 4.8703
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.5186 | Train Acc 0.8608 | Speed (samples/sec) 238170.9752 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:35,558] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:35,559] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=52942.7522362391
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:28.29395231 ms
avg iteration GPU training time:28.71769587 ms
avg iteration (step) total cpu time:71.35462761 ms
Epoch Time(s): 4.7440
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.5124 | Train Acc 0.8641 | Speed (samples/sec) 239598.7082 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:29.22267660 ms
avg iteration GPU training time:26.50155703 ms
avg iteration (step) total cpu time:71.64176305 ms
Epoch Time(s): 4.4844
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.5184 | Train Acc 0.8630 | Speed (samples/sec) 241077.0857 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:43,043] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:43,044] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=53191.02461232881
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:34.70730591 ms
avg iteration GPU training time:26.36314710 ms
avg iteration (step) total cpu time:77.68559456 ms
Epoch Time(s): 4.5464
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.5128 | Train Acc 0.8641 | Speed (samples/sec) 241242.1459 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:47,832] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:47,833] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=53052.960390155335
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:27.04721069 ms
avg iteration GPU training time:25.92108790 ms
avg iteration (step) total cpu time:67.67773628 ms
Epoch Time(s): 4.7781
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.4992 | Train Acc 0.8672 | Speed (samples/sec) 241999.5918 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

[2021-06-11 22:12:54,105] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:54,106] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=53248.24126235439
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

avg iteration(step) data from cpu to GPU time:28.39769618 ms
avg iteration GPU training time:28.12052282 ms
avg iteration (step) total cpu time:70.22285461 ms
Epoch Time(s): 4.8625
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.5079 | Train Acc 0.8641 | Speed (samples/sec) 243315.8971 | GPU 1890.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8464937210083008  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:12:59,240] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:12:59,240] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=53282.2318492281
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:27.64360555 ms
avg iteration GPU training time:26.66120529 ms
avg iteration (step) total cpu time:66.85471535 ms
Epoch Time(s): 5.0061
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.4992 | Train Acc 0.8650 | Speed (samples/sec) 244616.9594 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:32.91663933 ms
avg iteration GPU training time:25.85305595 ms
avg iteration (step) total cpu time:74.92224375 ms
Epoch Time(s): 4.7437
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.4889 | Train Acc 0.8678 | Speed (samples/sec) 245220.0568 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:07,146] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:07,147] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=53502.217429864824
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:27.83834648 ms
avg iteration GPU training time:25.45241610 ms
avg iteration (step) total cpu time:67.41905212 ms
Epoch Time(s): 4.6727
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.5061 | Train Acc 0.8663 | Speed (samples/sec) 246380.5770 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:11,846] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:11,846] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=53756.05099234777
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:32.36771139 ms
avg iteration GPU training time:24.88372294 ms
avg iteration (step) total cpu time:71.44403458 ms
Epoch Time(s): 4.7652
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.4959 | Train Acc 0.8659 | Speed (samples/sec) 247130.5323 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:18,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:18,032] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=53921.21543476991
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:29.34597270 ms
avg iteration GPU training time:32.31889089 ms
avg iteration (step) total cpu time:77.96859741 ms
Epoch Time(s): 4.7900
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.5010 | Train Acc 0.8656 | Speed (samples/sec) 246183.2716 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:22,824] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:22,825] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=53958.262390046206
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:28.34288025 ms
avg iteration GPU training time:25.52747726 ms
avg iteration (step) total cpu time:67.65166918 ms
Epoch Time(s): 4.5805
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.4837 | Train Acc 0.8711 | Speed (samples/sec) 247546.2120 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:26.86887487 ms
avg iteration GPU training time:25.32437325 ms
avg iteration (step) total cpu time:65.59459368 ms
Epoch Time(s): 4.4671
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.4973 | Train Acc 0.8691 | Speed (samples/sec) 248813.5499 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:30,325] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:30,326] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=54120.21052667276
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:26.97366397 ms
avg iteration GPU training time:25.69843165 ms
avg iteration (step) total cpu time:67.63021151 ms
Epoch Time(s): 4.5421
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.4953 | Train Acc 0.8687 | Speed (samples/sec) 249491.4336 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:35,217] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:35,218] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=54243.96136622238
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:27.24305089 ms
avg iteration GPU training time:25.59982936 ms
avg iteration (step) total cpu time:67.22807884 ms
Epoch Time(s): 4.8701
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.4859 | Train Acc 0.8698 | Speed (samples/sec) 250530.4918 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:41,069] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:41,070] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=54322.77877153017
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:27.88594055 ms
avg iteration GPU training time:27.74116262 ms
avg iteration (step) total cpu time:71.08473778 ms
Epoch Time(s): 4.4966
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.4891 | Train Acc 0.8700 | Speed (samples/sec) 250976.7224 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:45,603] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:45,605] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=54311.935134996325
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:27.36508814 ms
avg iteration GPU training time:28.34461848 ms
avg iteration (step) total cpu time:77.51480738 ms
Epoch Time(s): 4.3856
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.4776 | Train Acc 0.8710 | Speed (samples/sec) 250961.2798 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

avg iteration(step) data from cpu to GPU time:28.16202672 ms
avg iteration GPU training time:27.03319422 ms
avg iteration (step) total cpu time:184.61410205 ms
Epoch Time(s): 5.2783
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.4821 | Train Acc 0.8686 | Speed (samples/sec) 249194.9304 | GPU 1891.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

[2021-06-11 22:13:54,227] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:54,228] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=54287.76559592671
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8469481468200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:29.71658643 ms
avg iteration GPU training time:27.40302976 ms
avg iteration (step) total cpu time:70.95360756 ms
Epoch Time(s): 4.9286
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.4765 | Train Acc 0.8717 | Speed (samples/sec) 249337.5264 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:13:58,927] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:13:58,928] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=54274.646362883424
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:28.84306145 ms
avg iteration GPU training time:26.76742363 ms
avg iteration (step) total cpu time:68.61170133 ms
Epoch Time(s): 4.4761
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.4885 | Train Acc 0.8676 | Speed (samples/sec) 249851.9514 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:06,562] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:06,563] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=54371.821681368674
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:34.78447914 ms
avg iteration GPU training time:25.31266149 ms
avg iteration (step) total cpu time:528.93908819 ms
Epoch Time(s): 6.4936
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.4711 | Train Acc 0.8737 | Speed (samples/sec) 247730.3900 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:12,117] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:12,118] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=54358.3148676184
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:30.13444265 ms
avg iteration GPU training time:32.11032550 ms
avg iteration (step) total cpu time:283.55415662 ms
Epoch Time(s): 5.3860
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.4736 | Train Acc 0.8738 | Speed (samples/sec) 245904.9472 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:27.69174385 ms
avg iteration GPU training time:26.82926941 ms
avg iteration (step) total cpu time:127.11103757 ms
Epoch Time(s): 4.8557
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4943 | Train Acc 0.8695 | Speed (samples/sec) 244540.0774 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:19,887] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:19,888] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=54409.764105055074
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:30.46621895 ms
avg iteration GPU training time:27.51871999 ms
avg iteration (step) total cpu time:185.70709229 ms
Epoch Time(s): 4.7957
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.4951 | Train Acc 0.8687 | Speed (samples/sec) 242307.1391 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:25,199] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:25,200] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=54448.60574569039
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:34.59462357 ms
avg iteration GPU training time:26.71332296 ms
avg iteration (step) total cpu time:74.24060504 ms
Epoch Time(s): 4.8830
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4740 | Train Acc 0.8709 | Speed (samples/sec) 242813.0760 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:31,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:31,156] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=54516.4235439724
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:30.08433024 ms
avg iteration GPU training time:26.28786151 ms
avg iteration (step) total cpu time:87.97923724 ms
Epoch Time(s): 4.6044
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.4748 | Train Acc 0.8700 | Speed (samples/sec) 242947.8272 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:35,763] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:35,764] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=54543.444780256774
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:30.08716774 ms
avg iteration GPU training time:27.45981852 ms
avg iteration (step) total cpu time:71.78290685 ms
Epoch Time(s): 4.4786
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4718 | Train Acc 0.8748 | Speed (samples/sec) 243340.6907 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:31.64163272 ms
avg iteration GPU training time:27.44270897 ms
avg iteration (step) total cpu time:471.56826655 ms
Epoch Time(s): 6.3150
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4755 | Train Acc 0.8723 | Speed (samples/sec) 242686.9641 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:45,808] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:45,809] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=54581.4675650384
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:33.20102437 ms
avg iteration GPU training time:28.00172806 ms
avg iteration (step) total cpu time:292.14922587 ms
Epoch Time(s): 5.7383
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4759 | Train Acc 0.8722 | Speed (samples/sec) 239698.4268 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:51,300] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:51,301] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=54587.35717812208
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:27.66679382 ms
avg iteration GPU training time:26.96833038 ms
avg iteration (step) total cpu time:108.25705528 ms
Epoch Time(s): 4.9595
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4729 | Train Acc 0.8724 | Speed (samples/sec) 239490.9176 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:14:57,327] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:14:57,327] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=54654.291059683965
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:29.99727949 ms
avg iteration GPU training time:26.07538160 ms
avg iteration (step) total cpu time:70.26696205 ms
Epoch Time(s): 4.7235
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4738 | Train Acc 0.8731 | Speed (samples/sec) 240251.6100 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:15:02,404] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:15:02,405] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=54716.626196183075
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:22.93910408 ms
avg iteration GPU training time:26.47591464 ms
avg iteration (step) total cpu time:72.19902674 ms
Epoch Time(s): 4.9221
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4878 | Train Acc 0.8703 | Speed (samples/sec) 239560.8385 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:22.64084244 ms
avg iteration GPU training time:25.88044739 ms
avg iteration (step) total cpu time:82.16921488 ms
Epoch Time(s): 4.6248
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4602 | Train Acc 0.8738 | Speed (samples/sec) 240354.5923 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:15:10,223] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:15:10,223] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=54775.850942868594
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:22.34728559 ms
avg iteration GPU training time:27.41130702 ms
avg iteration (step) total cpu time:101.07040405 ms
Epoch Time(s): 4.7699
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4824 | Train Acc 0.8707 | Speed (samples/sec) 240604.0016 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:15:16,081] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:15:16,081] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=54711.4192726654
-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43798828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.30908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:27.47558403 ms
avg iteration GPU training time:27.00486374 ms
avg iteration (step) total cpu time:489.22284444 ms
Epoch Time(s): 6.3991
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39501953125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31298828125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4741 | Train Acc 0.8748 | Speed (samples/sec) 239516.4455 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.35791015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.39697265625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.43603515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.31103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.35595703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:15:23,981] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:15:23,982] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=54729.90449369795
-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:33.55083783 ms
avg iteration GPU training time:29.62902451 ms
avg iteration (step) total cpu time:77.82069842 ms
Epoch Time(s): 5.9077
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4778 | Train Acc 0.8702 | Speed (samples/sec) 239998.8942 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.89111328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.89111328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

[2021-06-11 22:15:28,818] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:15:28,819] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=54700.704900865225
-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:24.23948797 ms
avg iteration GPU training time:27.29464531 ms
avg iteration (step) total cpu time:65.18308322 ms
Epoch Time(s): 4.6685
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4780 | Train Acc 0.8706 | Speed (samples/sec) 240783.4862 | GPU 1892.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76611328125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.81103515625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.85009765625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76220703125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.84814453125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.88916015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.76416015625GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.80908203125GB

Max Memory Allocated 1.8484702110290527  GigaBytes

avg iteration(step) data from cpu to GPU time:25.83745130 ms
avg iteration GPU training time:28.28445880 ms
avg iteration (step) total cpu time:116.03347460 ms
Epoch Time(s): 4.6713
Eval Acc 0.8782
Test Acc: 0.7003
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4685 | Train Acc 0.8760 | Speed (samples/sec) 240681.9101 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:11,996] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:11,996] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=54677.02291682993
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.89325841 ms
avg iteration GPU training time:28.71593602 ms
avg iteration (step) total cpu time:96.06075287 ms
Epoch Time(s): 6.9792
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.4684 | Train Acc 0.8746 | Speed (samples/sec) 239264.3537 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:19,196] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:19,197] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=54634.598956012276
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.56913058 ms
avg iteration GPU training time:27.04372279 ms
avg iteration (step) total cpu time:70.13988495 ms
Epoch Time(s): 5.1667
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4678 | Train Acc 0.8711 | Speed (samples/sec) 239616.1164 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:25,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:25,383] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=54641.42447972872
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.77159500 ms
avg iteration GPU training time:27.50827726 ms
avg iteration (step) total cpu time:146.07318242 ms
Epoch Time(s): 4.9054
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4638 | Train Acc 0.8702 | Speed (samples/sec) 239385.3447 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:30,041] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:30,041] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=54625.554839877186
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:26.66310438 ms
avg iteration GPU training time:28.38623937 ms
avg iteration (step) total cpu time:70.15117009 ms
Epoch Time(s): 4.5023
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4606 | Train Acc 0.8764 | Speed (samples/sec) 239689.8535 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:32.12484296 ms
avg iteration GPU training time:28.84698613 ms
avg iteration (step) total cpu time:655.61834971 ms
Epoch Time(s): 6.7094
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4845 | Train Acc 0.8656 | Speed (samples/sec) 237483.3228 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:40,076] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:40,077] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=54545.845405537526
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:34.29120064 ms
avg iteration GPU training time:29.41400592 ms
avg iteration (step) total cpu time:78.67821058 ms
Epoch Time(s): 5.0149
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.4784 | Train Acc 0.8705 | Speed (samples/sec) 237518.6530 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:45,248] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:45,248] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=54511.4611555968
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:30.59969012 ms
avg iteration GPU training time:27.64157867 ms
avg iteration (step) total cpu time:218.46803029 ms
Epoch Time(s): 5.0082
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.4624 | Train Acc 0.8740 | Speed (samples/sec) 235855.1579 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:51,238] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:51,239] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=54465.72803416311
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:31.04840533 ms
avg iteration GPU training time:27.42127927 ms
avg iteration (step) total cpu time:224.06164805 ms
Epoch Time(s): 5.0666
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4774 | Train Acc 0.8719 | Speed (samples/sec) 235438.9534 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:16:57,176] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:16:57,177] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=54460.88802522026
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:34.87721570 ms
avg iteration GPU training time:27.49801636 ms
avg iteration (step) total cpu time:83.03117752 ms
Epoch Time(s): 5.3788
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.4630 | Train Acc 0.8734 | Speed (samples/sec) 234999.1408 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:27.55171140 ms
avg iteration GPU training time:27.01181857 ms
avg iteration (step) total cpu time:68.94556681 ms
Epoch Time(s): 4.7544
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4754 | Train Acc 0.8708 | Speed (samples/sec) 235507.7269 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:04,920] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:04,921] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=54452.50174939913
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.35937055 ms
avg iteration GPU training time:28.64777565 ms
avg iteration (step) total cpu time:73.67038727 ms
Epoch Time(s): 4.4497
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.4741 | Train Acc 0.8715 | Speed (samples/sec) 235783.0255 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:09,536] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:09,537] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=54440.90808650877
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:31.57742945 ms
avg iteration GPU training time:28.15051778 ms
avg iteration (step) total cpu time:167.48086611 ms
Epoch Time(s): 4.8247
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.4728 | Train Acc 0.8714 | Speed (samples/sec) 235215.6686 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:15,782] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:15,783] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=54346.012495268624
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:30.43989309 ms
avg iteration GPU training time:27.87462362 ms
avg iteration (step) total cpu time:93.72671445 ms
Epoch Time(s): 4.6788
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.4613 | Train Acc 0.8755 | Speed (samples/sec) 234738.1803 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:21,465] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:21,466] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=54359.652042097616
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:30.24423472 ms
avg iteration GPU training time:26.55602074 ms
avg iteration (step) total cpu time:70.78107198 ms
Epoch Time(s): 5.5426
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.4659 | Train Acc 0.8722 | Speed (samples/sec) 235142.5561 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.54745611 ms
avg iteration GPU training time:28.54438400 ms
avg iteration (step) total cpu time:74.22979673 ms
Epoch Time(s): 4.5241
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.4759 | Train Acc 0.8720 | Speed (samples/sec) 235342.9340 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:29,384] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:29,384] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=54355.5533796607
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.58205859 ms
avg iteration GPU training time:32.93038940 ms
avg iteration (step) total cpu time:87.09216118 ms
Epoch Time(s): 4.9998
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.4719 | Train Acc 0.8750 | Speed (samples/sec) 234806.2687 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:34,336] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:34,337] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=54272.940027434044
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.33724785 ms
avg iteration GPU training time:29.08695475 ms
avg iteration (step) total cpu time:75.81082980 ms
Epoch Time(s): 4.6624
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.4720 | Train Acc 0.8730 | Speed (samples/sec) 235045.0255 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:40,148] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:40,149] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=54273.68178660282
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.86726443 ms
avg iteration GPU training time:27.44337082 ms
avg iteration (step) total cpu time:71.53725624 ms
Epoch Time(s): 4.6547
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.4688 | Train Acc 0.8745 | Speed (samples/sec) 235460.8299 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:46,906] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:46,907] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=54244.80609546154
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:32.07120005 ms
avg iteration GPU training time:27.51469866 ms
avg iteration (step) total cpu time:557.51132965 ms
Epoch Time(s): 6.5955
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.4710 | Train Acc 0.8723 | Speed (samples/sec) 234642.2847 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.59064484 ms
avg iteration GPU training time:28.89857038 ms
avg iteration (step) total cpu time:73.49276543 ms
Epoch Time(s): 5.4408
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.4776 | Train Acc 0.8710 | Speed (samples/sec) 234652.5237 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:17:55,772] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:17:55,772] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=54207.182907130824
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:27.54978180 ms
avg iteration GPU training time:28.37671534 ms
avg iteration (step) total cpu time:97.48514493 ms
Epoch Time(s): 5.0404
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.4587 | Train Acc 0.8744 | Speed (samples/sec) 234497.6470 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:00,680] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:00,681] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=54207.188099663574
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.76216507 ms
avg iteration GPU training time:28.10330709 ms
avg iteration (step) total cpu time:73.83728027 ms
Epoch Time(s): 4.7435
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.4726 | Train Acc 0.8697 | Speed (samples/sec) 234743.9401 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:07,109] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:07,110] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=54201.54224997484
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.34813881 ms
avg iteration GPU training time:28.05450694 ms
avg iteration (step) total cpu time:73.20308685 ms
Epoch Time(s): 5.1668
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.4701 | Train Acc 0.8740 | Speed (samples/sec) 235019.1720 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:12,151] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:12,152] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=54165.2966895165
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.92904472 ms
avg iteration GPU training time:26.67403730 ms
avg iteration (step) total cpu time:71.71559334 ms
Epoch Time(s): 4.8978
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.4689 | Train Acc 0.8721 | Speed (samples/sec) 235385.3535 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.88937569 ms
avg iteration GPU training time:26.58319982 ms
avg iteration (step) total cpu time:69.34722265 ms
Epoch Time(s): 4.5491
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.4663 | Train Acc 0.8737 | Speed (samples/sec) 235757.9623 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:19,755] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:19,756] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=54158.62162391145
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:33.14808591 ms
avg iteration GPU training time:27.15172259 ms
avg iteration (step) total cpu time:157.88157781 ms
Epoch Time(s): 4.8298
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.4743 | Train Acc 0.8724 | Speed (samples/sec) 235352.9573 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:24,831] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:24,832] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=54142.71027215148
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.04792531 ms
avg iteration GPU training time:33.71624502 ms
avg iteration (step) total cpu time:98.21248055 ms
Epoch Time(s): 4.8773
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.4610 | Train Acc 0.8744 | Speed (samples/sec) 235241.0860 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:31,159] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:31,160] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=54090.93490090082
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.59056028 ms
avg iteration GPU training time:27.59371758 ms
avg iteration (step) total cpu time:126.36995316 ms
Epoch Time(s): 4.9113
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.4749 | Train Acc 0.8729 | Speed (samples/sec) 235153.0795 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:36,024] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:36,025] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=54112.67826572887
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.36268743 ms
avg iteration GPU training time:26.63217100 ms
avg iteration (step) total cpu time:69.89836693 ms
Epoch Time(s): 4.6958
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.4644 | Train Acc 0.8738 | Speed (samples/sec) 235457.9376 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:27.26399994 ms
avg iteration GPU training time:28.78671964 ms
avg iteration (step) total cpu time:464.21909332 ms
Epoch Time(s): 6.1926
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.4566 | Train Acc 0.8756 | Speed (samples/sec) 234793.7297 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:45,961] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:45,962] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=54101.70242406435
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.72293345 ms
avg iteration GPU training time:31.51723671 ms
avg iteration (step) total cpu time:227.03790665 ms
Epoch Time(s): 5.7775
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.4571 | Train Acc 0.8755 | Speed (samples/sec) 234214.1379 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:51,402] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:51,403] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=54094.518618234324
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:31.44429843 ms
avg iteration GPU training time:26.55790965 ms
avg iteration (step) total cpu time:109.81814067 ms
Epoch Time(s): 4.9424
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.4660 | Train Acc 0.8730 | Speed (samples/sec) 234292.4099 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:18:57,417] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:18:57,418] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=54127.12149112465
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:34.69659805 ms
avg iteration GPU training time:26.50665538 ms
avg iteration (step) total cpu time:93.46469243 ms
Epoch Time(s): 4.6295
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.4816 | Train Acc 0.8702 | Speed (samples/sec) 234102.1861 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:02,646] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:02,647] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=54153.39390236043
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:32.48866018 ms
avg iteration GPU training time:27.05188243 ms
avg iteration (step) total cpu time:73.15484683 ms
Epoch Time(s): 5.0643
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.4595 | Train Acc 0.8761 | Speed (samples/sec) 234307.6298 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.43960508 ms
avg iteration GPU training time:27.06725375 ms
avg iteration (step) total cpu time:69.85235214 ms
Epoch Time(s): 4.8309
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.4600 | Train Acc 0.8767 | Speed (samples/sec) 234628.6176 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:10,615] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:10,616] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=54156.83804126366
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:31.05122185 ms
avg iteration GPU training time:27.37439982 ms
avg iteration (step) total cpu time:72.55125046 ms
Epoch Time(s): 4.6539
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.4647 | Train Acc 0.8732 | Speed (samples/sec) 234864.2328 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:15,563] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:15,563] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=54144.21223941541
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:27.94115257 ms
avg iteration GPU training time:27.11487961 ms
avg iteration (step) total cpu time:71.45889600 ms
Epoch Time(s): 5.0127
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.4556 | Train Acc 0.8744 | Speed (samples/sec) 235148.2519 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:21,657] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:21,658] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=54161.0094573797
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:30.54954656 ms
avg iteration GPU training time:26.72147179 ms
avg iteration (step) total cpu time:70.24931908 ms
Epoch Time(s): 4.6473
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.4676 | Train Acc 0.8718 | Speed (samples/sec) 235376.5582 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:26,450] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:26,451] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=54180.33009030876
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:30.41011238 ms
avg iteration GPU training time:27.03810120 ms
avg iteration (step) total cpu time:74.47314262 ms
Epoch Time(s): 4.6533
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4624 | Train Acc 0.8755 | Speed (samples/sec) 235618.7811 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:30.42318980 ms
avg iteration GPU training time:27.00103505 ms
avg iteration (step) total cpu time:112.12984721 ms
Epoch Time(s): 4.7709
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4602 | Train Acc 0.8745 | Speed (samples/sec) 235542.4318 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:34,542] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:34,543] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=54192.47922424218
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.58827718 ms
avg iteration GPU training time:33.00594203 ms
avg iteration (step) total cpu time:77.30507851 ms
Epoch Time(s): 5.0613
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4604 | Train Acc 0.8755 | Speed (samples/sec) 235683.9882 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:39,618] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:39,619] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=54169.41891606831
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.15481631 ms
avg iteration GPU training time:27.66334915 ms
avg iteration (step) total cpu time:71.38331731 ms
Epoch Time(s): 4.7315
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4590 | Train Acc 0.8755 | Speed (samples/sec) 235989.5769 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:45,720] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:45,721] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=54200.019938566365
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:31.74256070 ms
avg iteration GPU training time:25.87045352 ms
avg iteration (step) total cpu time:72.05843925 ms
Epoch Time(s): 4.8795
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.4616 | Train Acc 0.8741 | Speed (samples/sec) 236269.5812 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:19:52,678] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:19:52,679] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=54190.25741522992
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:31.70571836 ms
avg iteration GPU training time:27.78444862 ms
avg iteration (step) total cpu time:564.11496798 ms
Epoch Time(s): 6.8599
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4590 | Train Acc 0.8764 | Speed (samples/sec) 235316.9836 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.19282023 ms
avg iteration GPU training time:28.65349325 ms
avg iteration (step) total cpu time:239.10776774 ms
Epoch Time(s): 5.5864
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.4641 | Train Acc 0.8730 | Speed (samples/sec) 234710.8424 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:20:01,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:20:01,790] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=54172.24397300432
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67626953125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:29.75734393 ms
avg iteration GPU training time:27.63926379 ms
avg iteration (step) total cpu time:171.62466049 ms
Epoch Time(s): 5.0902
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.4621 | Train Acc 0.8748 | Speed (samples/sec) 234243.9171 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:20:06,792] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:20:06,793] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=54153.94778985968
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:31.42447917 ms
avg iteration GPU training time:26.62378693 ms
avg iteration (step) total cpu time:71.04158401 ms
Epoch Time(s): 5.1637
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.4678 | Train Acc 0.8743 | Speed (samples/sec) 234470.8119 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:20:13,346] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:20:13,347] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=54169.08260087259
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:32.70880000 ms
avg iteration GPU training time:26.80689112 ms
avg iteration (step) total cpu time:77.75235176 ms
Epoch Time(s): 4.9209
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.4579 | Train Acc 0.8766 | Speed (samples/sec) 234680.7444 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

[2021-06-11 22:20:18,250] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:20:18,251] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=54189.92736800885
-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:28.60501353 ms
avg iteration GPU training time:27.00412814 ms
avg iteration (step) total cpu time:68.45601400 ms
Epoch Time(s): 4.7214
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.4691 | Train Acc 0.8726 | Speed (samples/sec) 235013.6931 | GPU 2354.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80517578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76416015625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.67822265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 5.72314453125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 5.76220703125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 5.80322265625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 5.68017578125GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 5.72509765625GB

Max Memory Allocated 2.29935359954834  GigaBytes

avg iteration(step) data from cpu to GPU time:32.29379209 ms
avg iteration GPU training time:27.13603210 ms
avg iteration (step) total cpu time:75.68836212 ms
Epoch Time(s): 4.6031
Eval Acc 0.8811
Test Acc: 0.7055
Avg epoch time(time.time()): 5001.118391752243 ms
total avg iteration(step) data from cpu to GPU time:29.58003650 ms
total avg iteration GPU training time:27.96844844 ms
total avg iteration (step) total cpu time:132.98558087 ms
